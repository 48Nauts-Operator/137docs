<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# Assignment Node Utilities

## Overview

This module provides utilities for extracting variable and attribute names from Python AST (Abstract Syntax Tree) assignment nodes. It's designed to parse different types of assignment statements and extract meaningful identifier names from them.

## Purpose

The primary purpose of this module is to:
- Extract variable names from assignment statements in Python code
- Handle both regular assignments (`=`) and annotated assignments (`:` with optional `=`)
- Support attribute access patterns (e.g., `self.attribute`, `object.property`)
- Provide specialized handling for instance attribute extraction

## Core Functions

### `get_name(node: ast.AST) -> str`

Extracts a single name from an AST node.

**Parameters:**
- `node`: An AST node (typically `ast.Name` or `ast.Attribute`)

**Returns:**
- A string representing the extracted name

**Supported Node Types:**
- `ast.Name`: Returns the identifier name (e.g., `variable`)
- `ast.Attribute`: Returns the full attribute path (e.g., `self.attribute`)

```python
# Example usage
import ast

code = "self.value = 10"
tree = ast.parse(code)
assign_node = tree.body[0]
name = get_name(assign_node.targets[0])  # Returns "self.value"
```

### `get_names(node: ast.AST) -> list[str]`

Extracts all names from an assignment node.

**Parameters:**
- `node`: An assignment AST node (`ast.Assign` or `ast.AnnAssign`)

**Returns:**
- A list of strings representing all extracted names

**Supported Assignment Types:**
- `ast.Assign`: Regular assignments (e.g., `a = b = 5`)
- `ast.AnnAssign`: Annotated assignments (e.g., `x: int = 10`)

```python
# Example usage
code = "a = b = c = 42"
tree = ast.parse(code)
names = get_names(tree.body[0])  # Returns ["a", "b", "c"]
```

### `get_instance_names(node: ast.AST) -> list[str]`

Extracts instance attribute names from assignment nodes, filtering for attributes that start with `self.`.

**Parameters:**
- `node`: An assignment AST node

**Returns:**
- A list of attribute names without the `self.` prefix

```python
# Example usage
code = "self.name = 'John'"
tree = ast.parse(code)
instance_names = get_instance_names(tree.body[0])  # Returns ["name"]
```

## Internal Implementation Details

### Helper Functions

- **`_get_attribute_name(node: ast.Attribute) -> str`**: Recursively builds attribute access strings
- **`_get_name_name(node: ast.Name) -> str`**: Extracts identifier from name nodes
- **`_get_assign_names(node: ast.Assign) -> list[str]`**: Handles multiple assignment targets
- **`_get_annassign_names(node: ast.AnnAssign) -> list[str]`**: Handles annotated assignments

### Mapping Dictionaries

The module uses dispatch dictionaries for clean separation of concerns:
- `_node_name_map`: Maps node types to single name extraction functions
- `_node_names_map`: Maps assignment node types to name list extraction functions

## Usage Examples

```python
import ast
from assignment_utils import get_names, get_instance_names

# Parse different assignment types
code_samples = [
    "x = 10",                    # Simple assignment
    "a = b = 5",                 # Multiple assignment
    "self.name = 'Alice'",       # Instance attribute
    "obj.prop = value",          # Object attribute
    "x: int = 42",               # Annotated assignment
]

for code in code_samples:
    tree = ast.parse(code)
    assignment = tree.body[0]
    names = get_names(assignment)
    print(f"Code: {code} -> Names: {names}")
```

## Notes and Limitations

- **Error Handling**: The module assumes well-formed AST nodes and may raise `KeyError` if unsupported node types are passed
- **Nested Attributes**: Supports nested attribute access (e.g., `self.obj.attr`)
- **Filtering**: `get_instance_names()` specifically looks for `self.` prefixed attributes
- **Type Safety**: Uses type hints for better code documentation and IDE support

## Suggestions for Improvement

- **Add Error Handling**: Consider adding try-catch blocks or type checking for unsupported node types
- **Extend Support**: Could be extended to support other assignment patterns like tuple unpacking
- **Documentation**: The docstring for `get_name()` mentions returning "A list of names" but actually returns a single string
- **Validation**: Consider adding input validation to ensure nodes are of expected types