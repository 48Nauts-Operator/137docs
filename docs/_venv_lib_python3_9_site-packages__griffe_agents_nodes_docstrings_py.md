<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# Docstring Extraction Utilities

This module provides utilities for extracting docstrings from Python Abstract Syntax Tree (AST) nodes. It's designed to parse and retrieve documentation strings from various Python code constructs.

## Purpose

The module serves as a helper utility for code analysis tools, documentation generators, or static analysis systems that need to extract docstrings from Python source code represented as AST nodes.

## Functions

### `get_docstring()`

```python
def get_docstring(
    node: ast.AST,
    *,
    strict: bool = False,
) -> tuple[str | None, int | None, int | None]:
```

Extracts a docstring from an AST node and returns both the content and location information.

#### Parameters

- **`node`** (`ast.AST`): The AST node to extract the docstring from
- **`strict`** (`bool`, optional): Controls extraction behavior
  - `False` (default): Searches within the node's body for docstrings (useful for functions, classes, modules)
  - `True`: Only extracts if the node itself is a docstring expression

#### Returns

A tuple containing three elements:
- **`str | None`**: The docstring content, or `None` if no docstring found
- **`int | None`**: Starting line number of the docstring, or `None` if not found
- **`int | None`**: Ending line number of the docstring, or `None` if not found

#### Behavior

The function handles two main scenarios:

1. **Direct Expression Nodes** (`ast.Expr`):
   - Extracts docstring directly from expression nodes
   
2. **Nodes with Body** (when `strict=False`):
   - Searches the first statement in the node's body
   - Useful for extracting docstrings from functions, classes, or modules

## Implementation Details

### AST Node Types Supported

- **`ast.Expr`**: Expression statements that may contain docstrings
- **Nodes with `body` attribute**: Functions, classes, modules, etc. (when `strict=False`)

### Docstring Validation

The function validates that:
- The node contains an `ast.Constant`
- The constant's value is a string type
- Proper line number information is available

## Usage Examples

```python
import ast

# Parse some Python code
code = '''
def example_function():
    """This is a docstring for the function."""
    pass
'''

tree = ast.parse(code)
func_node = tree.body[0]

# Extract docstring
docstring, start_line, end_line = get_docstring(func_node)
print(f"Docstring: {docstring}")
print(f"Lines: {start_line}-{end_line}")
```

## Notes and Suggestions

### Performance Considerations

- **TODO**: The code includes a note about possible optimization using a type map, suggesting room for performance improvements in high-volume scenarios

### Usage Recommendations

- Use `strict=False` (default) when extracting docstrings from function, class, or module definitions
- Use `strict=True` when you specifically want to check if a node itself is a docstring expression
- Always check for `None` return values before using the results

### Limitations

- Only works with Python 3.8+ style `ast.Constant` nodes (older Python versions used `ast.Str`)
- Requires proper AST parsing before use
- Line numbers depend on the original source code being parsed with location information