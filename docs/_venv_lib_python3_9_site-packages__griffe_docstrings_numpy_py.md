<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# Numpy Docstring Parser

This module provides functionality to parse NumPy-style docstrings into structured data. It is designed to extract and organize different sections of docstrings according to the NumPy documentation standard.

## Overview

The parser processes NumPy-style docstrings and converts them into structured `DocstringSection` objects. It supports various section types like parameters, returns, examples, and more, while handling proper indentation and formatting rules.

### Design Decisions

The implementation is based on the [NumPy docstring standard](https://numpydoc.readthedocs.io/en/latest/format.html) but excludes certain sections that were deemed non-Pythonic or better handled by user-chosen markup:

**Rejected sections:**
- **See Also**: Too subjective and specific to NumPy
- **Warnings**: Better handled as markup
- **Notes**: Better handled as markup  
- **References**: Better handled as markup

## Key Components

### Main Parser Function

#### `parse_numpy()`

```python
def parse_numpy(
    docstring: Docstring,
    *,
    ignore_init_summary: bool = False,
    trim_doctest_flags: bool = True,
    warn_unknown_params: bool = True,
    warnings: bool = True,
    **options: Any,
) -> list[DocstringSection]
```

The primary entry point for parsing NumPy-style docstrings.

**Parameters:**
- `docstring`: The docstring object to parse
- `ignore_init_summary`: Skip summary in `__init__` method docstrings
- `trim_doctest_flags`: Remove doctest flags from Python examples
- `warn_unknown_params`: Warn about documented parameters not in function signature
- `warnings`: Enable/disable warning logging

**Returns:** List of structured docstring sections

### Section Readers

The module includes specialized reader functions for each docstring section type:

#### Parameter Sections
- `_read_parameters_section()`: Parses function parameters
- `_read_other_parameters_section()`: Parses optional/keyword parameters

#### Return/Yield Sections  
- `_read_returns_section()`: Parses return value documentation
- `_read_yields_section()`: Parses generator yield documentation
- `_read_receives_section()`: Parses generator receive documentation

#### Exception Sections
- `_read_raises_section()`: Parses raised exceptions
- `_read_warns_section()`: Parses warning conditions

#### Content Sections
- `_read_examples_section()`: Parses code examples and doctests
- `_read_attributes_section()`: Parses class attributes
- `_read_functions_section()`: Parses function/method listings
- `_read_classes_section()`: Parses class listings
- `_read_modules_section()`: Parses module listings
- `_read_deprecated_section()`: Parses deprecation information

### Utility Functions

#### Block Reading
- `_read_block_items()`: Reads structured list items with proper indentation
- `_read_block()`: Reads continuous text blocks

#### Line Processing
- `_is_empty_line()`: Checks if line contains only whitespace
- `_is_dash_line()`: Identifies section separator lines (dashes)

## Regular Expressions

The module uses several regex patterns to parse docstring elements:

```python
_RE_PARAMETER: Pattern    # Matches parameter definitions
_RE_RETURNS: Pattern      # Matches return value definitions  
_RE_YIELDS: Pattern       # Matches yield definitions
_RE_RECEIVES: Pattern     # Matches receive definitions
_RE_DOCTEST_FLAGS: Pattern # Matches doctest directive flags
```

## Section Types Mapping

```python
_section_kind = {
    "deprecated": DocstringSectionKind.deprecated,
    "parameters": DocstringSectionKind.parameters,
    "other parameters": DocstringSectionKind.other_parameters,
    "returns": DocstringSectionKind.returns,
    "yields": DocstringSectionKind.yields,
    "receives": DocstringSectionKind.receives,
    "raises": DocstringSectionKind.raises,
    "warns": DocstringSectionKind.warns,
    "examples": DocstringSectionKind.examples,
    "attributes": DocstringSectionKind.attributes,
    "functions": DocstringSectionKind.functions,
    "methods": DocstringSectionKind.functions,  # Maps to functions
    "classes": DocstringSectionKind.classes,
    "modules": DocstringSectionKind.modules,
}
```

## Usage Notes

### Indentation Rules
- Continuation lines should use **4-space indentation**
- Other indentation levels will generate warnings but are still processed
- Empty lines within sections are preserved

### Type Annotation Handling
- The parser attempts to extract type information from docstrings
- Falls back to function signatures when docstring types are missing
- Supports complex type parsing including tuples, generators, and iterators

### Warning System
- Configurable warning system for malformed docstrings
- Warns about unknown parameters not in function signatures
- Provides suggestions for common mistakes (e.g., missing `*` or `**`)

### Code Examples
- Supports both regular code blocks and doctest examples
- Can automatically trim doctest flags for cleaner output
- Handles `<BLANKLINE>` markers in doctests

## Dependencies

This module relies on several internal components:
- `_griffe.docstrings.models`: Docstring data models
- `_griffe.docstrings.utils`: Utility functions for docstring processing
- `_griffe.enumerations`: Enumeration types
- `_griffe.expressions`: Expression handling

## Notes

- The parser is designed to be forgiving of formatting inconsistencies
- Malformed sections generate warnings but don't stop processing
- Code blocks are handled specially to avoid interpreting dash lines as section separators
- The module supports both named and unnamed admonition sections