<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# babel.localedata

Low-level locale data access module for the Babel internationalization library.

## Overview

This module provides low-level access to locale data stored as pickle files. The locale data contains information from the Common Locale Data Repository (CLDR) including languages, territories, currencies, date/time formats, and other localization data.

> **Note**: The `Locale` class provides a more convenient interface for accessing locale data. This module is primarily used internally by Babel.

## Module Constants

- `_cache`: Thread-safe cache for loaded locale data
- `_cache_lock`: Threading lock for cache operations
- `_dirname`: Path to the locale data directory containing `.dat` files
- `_windows_reserved_name_re`: Regular expression to detect Windows reserved filenames

## Functions

### `normalize_locale(name: str) -> str | None`

Normalizes a locale identifier by stripping spaces and applying proper casing.

**Parameters:**
- `name`: The locale identifier string to normalize

**Returns:**
- Normalized locale ID string or `None` if not recognized

**Example:**
```python
normalize_locale("en_us")  # Returns "en_US"
normalize_locale("  FR-fr  ")  # Returns "fr_FR"
```

### `resolve_locale_filename(name: os.PathLike[str] | str) -> str`

Resolves a locale identifier to a `.dat` file path on disk.

**Parameters:**
- `name`: Locale identifier or path

**Returns:**
- Full path to the locale data file

**Raises:**
- `ValueError`: If the name is a Windows reserved name

### `exists(name: str) -> bool`

Checks whether locale data is available for the given locale.

**Parameters:**
- `name`: The locale identifier string

**Returns:**
- `True` if locale data exists, `False` otherwise

### `locale_identifiers() -> list[str]`

Returns a cached list of all available locale identifiers.

**Features:**
- Results are cached using `@lru_cache`
- Call `locale_identifiers.cache_clear()` to clear the cache
- Excludes the 'root' locale from results

**Returns:**
- List of locale identifier strings

### `load(name: os.PathLike[str] | str, merge_inherited: bool = True) -> dict[str, Any]`

Loads locale data for the specified locale with inheritance support.

**Parameters:**
- `name`: Locale identifier string (or "root")
- `merge_inherited`: Whether to merge inherited data (default: `True`)

**Returns:**
- Dictionary containing locale data

**Features:**
- Results are cached for performance
- Supports locale inheritance hierarchy
- Handles parent locale exceptions
- Thread-safe loading

**Example:**
```python
data = load('en_US')
print(data['languages']['es'])  # "Spanish"
```

### `merge(dict1: MutableMapping[Any, Any], dict2: Mapping[Any, Any]) -> None`

Merges data from `dict2` into `dict1`, handling nested dictionaries and aliases.

**Parameters:**
- `dict1`: Target dictionary to merge into
- `dict2`: Source dictionary containing data to merge

**Features:**
- Creates copies of nested dictionaries
- Handles `Alias` objects specially
- Supports tuple values containing aliases

## Classes

### `Alias`

Represents an alias reference to other parts of the locale data.

#### Constructor
```python
Alias(keys: tuple[str, ...])
```

#### Methods

- `resolve(data: Mapping[str | int | None, Any])`: Resolves the alias recursively

**Example:**
```python
alias = Alias(('languages', 'en'))
resolved_value = alias.resolve(locale_data)
```

### `LocaleDataDict`

A dictionary wrapper that automatically resolves aliases to actual values.

#### Constructor
```python
LocaleDataDict(data: MutableMapping, base: Mapping | None = None)
```

#### Features

- Implements `collections.abc.MutableMapping`
- Automatically resolves `Alias` objects when accessed
- Handles nested dictionaries with alias support
- Merges partial dictionaries with aliases

**Example:**
```python
wrapper = LocaleDataDict(raw_data)
value = wrapper['languages']['en']  # Automatically resolves any aliases
```

## Internal Functions

### `_is_non_likely_script(name: str) -> bool`

Determines if a locale uses a non-likely script format (implements CLDR 45 `nonlikelyScript` behavior).

**Parameters:**
- `name`: Locale identifier

**Returns:**
- `True` if the locale has `lang_Script` format with non-likely script

## Usage Notes

- All locale data is cached after first load for performance
- The module is thread-safe using `threading.RLock`
- Locale inheritance follows CLDR parent locale rules
- Windows filename restrictions are handled automatically
- The 'root' locale serves as the base for inheritance

## Error Handling

- `IOError`: Raised when locale data files cannot be found
- `ValueError`: Raised for invalid Windows filenames
- Returns `None` or `False` for invalid locale identifiers