<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# Timezone Information Module

## Overview

This Python module provides utility functions for working with timezone information using either the `pytz` or `zoneinfo` libraries. It serves as a compatibility layer that can work with both timezone libraries, with `pytz` taking precedence when available.

## Purpose

The module handles timezone operations by:
- Attempting to import both `pytz` and `zoneinfo` libraries
- Providing functions to retrieve timezone information from timezone names or files
- Offering graceful error handling when timezones cannot be found
- Acting as a bridge between different timezone library implementations

## Dependencies

The module attempts to import two optional timezone libraries:

- **`pytz`** - Third-party timezone library (preferred when available)
- **`zoneinfo`** - Built-in Python 3.9+ timezone library (fallback option)

> **Note**: At least one of these libraries should be available for the module to function properly.

## Functions

### `_get_tzinfo(tzenv: str)`

Retrieves timezone information for a given timezone name.

**Parameters:**
- `tzenv` (str): Timezone name in the format "Continent/City" (e.g., "America/New_York")

**Returns:**
- `tzinfo` object if timezone is found
- `None` if timezone is not found or invalid

**Behavior:**
- Prioritizes `pytz` if available, otherwise uses `zoneinfo`
- Handles various exception types from both libraries
- Includes special handling for `zoneinfo` validation errors

```python
# Example usage
tz = _get_tzinfo("America/New_York")
if tz:
    print("Timezone found!")
else:
    print("Timezone not found")
```

### `_get_tzinfo_or_raise(tzenv: str)`

Similar to `_get_tzinfo()` but raises an exception if the timezone cannot be found.

**Parameters:**
- `tzenv` (str): Timezone name in "Continent/City" format

**Returns:**
- `tzinfo` object for the specified timezone

**Raises:**
- `LookupError`: When the specified timezone cannot be found

```python
# Example usage
try:
    tz = _get_tzinfo_or_raise("America/New_York")
except LookupError as e:
    print(f"Error: {e}")
```

### `_get_tzinfo_from_file(tzfilename: str)`

Loads timezone information from a timezone file.

**Parameters:**
- `tzfilename` (str): Path to the timezone file

**Returns:**
- `tzinfo` object created from the file contents

**Behavior:**
- Uses `pytz.tzfile.build_tzinfo()` if `pytz` is available
- Falls back to `zoneinfo.ZoneInfo.from_file()` otherwise
- Reads the file in binary mode

```python
# Example usage
tz = _get_tzinfo_from_file("/usr/share/zoneinfo/America/New_York")
```

## Important Notes

### Error Handling
- The module includes specific handling for `babel` library compatibility (see issue #1092)
- Different exception types are caught depending on which timezone library is being used
- The `_get_tzinfo()` function returns `None` for missing timezones, while `_get_tzinfo_or_raise()` raises `LookupError`

### Library Priority
- `pytz` is checked first and used if available
- `zoneinfo` is used as a fallback when `pytz` is not installed
- This ensures compatibility across different Python versions and installations

### Usage Recommendations
- Use `_get_tzinfo()` when you want to handle missing timezones gracefully
- Use `_get_tzinfo_or_raise()` when missing timezones should be treated as errors
- Ensure timezone names follow the "Continent/City" format for best compatibility
- Consider the file path validity when using `_get_tzinfo_from_file()`

## Compatibility

This module is designed to work with:
- Python 3.9+ (for `zoneinfo` support)
- Earlier Python versions with `pytz` installed
- Systems where either or both timezone libraries are available