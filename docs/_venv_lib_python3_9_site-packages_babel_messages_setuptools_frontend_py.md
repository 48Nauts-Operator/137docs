<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# Babel Setuptools Frontend

## Overview

This module provides Setuptools integration for Babel's internationalization (i18n) commands. It bridges Babel's message catalog functionality with Python's setuptools/distutils build system, allowing developers to integrate translation workflows directly into their `setup.py` scripts.

## Purpose

- **Integration**: Seamlessly integrate Babel's i18n commands with setuptools
- **Automation**: Enable automated translation workflows during package builds
- **Compatibility**: Support both modern setuptools and legacy distutils
- **Validation**: Provide validation for message extractor configurations

## Key Components

### Functions

#### `check_message_extractors(dist, name, value)`

Validates the `message_extractors` keyword argument passed to the `setup()` function.

**Parameters:**
- `dist`: The distutils/setuptools Distribution object
- `name`: The keyword argument name (must be "message_extractors")
- `value`: The value to validate

**Raises:**
- `DistutilsSetupError`: If the value is not a valid dictionary

```python
# Example usage in setup.py
setup(
    name="myproject",
    message_extractors={
        'myproject': [
            ('**.py', 'python', None),
            ('**.html', 'mako', None),
        ],
    }
)
```

### Command Classes

All command classes inherit from both Babel's frontend commands and setuptools' `Command` class, providing dual functionality.

#### `compile_catalog`

Compiles message catalogs from `.po` files to binary `.mo` files.

- **Inherits from**: `frontend.CompileCatalog`, `Command`
- **Version**: Added in Babel 0.9
- **Purpose**: Convert human-readable translation files to optimized binary format

#### `extract_messages` 

Extracts translatable messages from source code files.

- **Inherits from**: `frontend.ExtractMessages`, `Command`
- **Purpose**: Scan source files and generate `.pot` template files
- **Common use**: Initial step in translation workflow

#### `init_catalog`

Initializes new translation catalogs for specific locales.

- **Inherits from**: `frontend.InitCatalog`, `Command`
- **Purpose**: Create new `.po` files for target languages
- **Workflow**: Run after `extract_messages` to create locale-specific catalogs

#### `update_catalog`

Updates existing translation catalogs with new messages.

- **Inherits from**: `frontend.UpdateCatalog`, `Command`  
- **Version**: Added in Babel 0.9
- **Purpose**: Merge new messages from templates into existing translations
- **Workflow**: Maintains existing translations while adding new strings

### Command Registry

```python
COMMANDS = {
    "compile_catalog": compile_catalog,
    "extract_messages": extract_messages, 
    "init_catalog": init_catalog,
    "update_catalog": update_catalog,
}
```

This dictionary maps command names to their respective classes for easy registration.

## Usage Examples

### Automatic Registration (Setuptools)

With modern setuptools, commands are available automatically:

```bash
python setup.py extract_messages
python setup.py init_catalog -l es
python setup.py update_catalog
python setup.py compile_catalog
```

### Manual Registration (Distutils)

For legacy distutils projects, explicit registration is required:

```python
from babel.messages.setuptools_frontend import (
    compile_catalog, extract_messages, init_catalog, update_catalog
)

setup(
    name="myproject",
    cmdclass={
        'compile_catalog': compile_catalog,
        'extract_messages': extract_messages,
        'init_catalog': init_catalog,
        'update_catalog': update_catalog,
    }
)
```

## Compatibility Notes

- **Setuptools Priority**: Prefers setuptools over distutils when available
- **Error Handling**: Gracefully handles missing setuptools error classes (pre-v59)
- **Legacy Support**: Maintains compatibility with older distutils-based projects
- **Future Annotations**: Uses `from __future__ import annotations` for forward compatibility

## Typical Workflow

1. **Extract**: `python setup.py extract_messages` - Generate message template
2. **Initialize**: `python setup.py init_catalog -l <locale>` - Create language-specific catalogs  
3. **Translate**: Edit `.po` files with translations
4. **Update**: `python setup.py update_catalog` - Merge new messages (after code changes)
5. **Compile**: `python setup.py compile_catalog` - Generate binary catalogs for deployment

## Notes and Suggestions

- **Automation**: Consider integrating these commands into your CI/CD pipeline
- **Version Control**: Include `.pot` and `.po` files in version control, exclude `.mo` files
- **Configuration**: Use `setup.cfg` or `pyproject.toml` for command-specific configuration
- **Dependencies**: Ensure Babel is included in your build dependencies