<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# Babel Setuptools Frontend Documentation

## Overview

This module provides integration between Babel's internationalization (i18n) tools and Python's setuptools/distutils build system. It enables developers to manage message catalogs (translation files) directly through `setup.py` commands, streamlining the localization workflow in Python projects.

## Purpose

The primary purpose of this module is to:

- **Bridge Babel and Setuptools**: Integrate Babel's message catalog operations with Python's package build system
- **Simplify i18n Workflows**: Allow developers to extract, compile, initialize, and update translation catalogs using standard `setup.py` commands
- **Maintain Compatibility**: Support both modern setuptools and legacy distutils systems

## Key Components

### Functions

#### `check_message_extractors(dist, name, value)`

Validates the `message_extractors` parameter passed to the `setup()` function.

**Parameters:**
- `dist`: The distutils/setuptools Distribution object
- `name`: The parameter name (should always be "message_extractors")
- `value`: The parameter value to validate

**Raises:**
- `SetupError`: If the value is not a dictionary

**Usage:**
```python
# This function ensures message_extractors is properly formatted
message_extractors = {
    'myapp': [
        ('**.py', 'python', None),
        ('templates/**.html', 'jinja2', None),
    ]
}
```

### Command Classes

All command classes inherit from both Babel's frontend commands and setuptools/distutils Command base class, providing seamless integration.

#### `compile_catalog`

Compiles message catalogs from `.po` files to binary `.mo` files for runtime use.

**Inheritance:** `frontend.CompileCatalog` + `Command`

#### `extract_messages`

Extracts translatable strings from source code and templates to create message catalogs.

**Inheritance:** `frontend.ExtractMessages` + `Command`

#### `init_catalog`

Initializes new message catalogs for specific locales based on a POT template.

**Inheritance:** `frontend.InitCatalog` + `Command`

#### `update_catalog`

Updates existing message catalogs by merging new messages from updated POT files.

**Inheritance:** `frontend.UpdateCatalog` + `Command`

## Usage Examples

### Automatic Registration (Setuptools)

For projects using setuptools, these commands are available automatically:

```bash
python setup.py extract_messages
python setup.py init_catalog -l es
python setup.py update_catalog
python setup.py compile_catalog
```

### Manual Registration (Distutils)

For projects using plain distutils, commands must be registered explicitly:

```python
from babel.messages.setuptools_frontend import (
    compile_catalog, extract_messages, init_catalog, update_catalog
)

setup(
    name='myproject',
    # ... other setup parameters ...
    cmdclass={
        'compile_catalog': compile_catalog,
        'extract_messages': extract_messages,
        'init_catalog': init_catalog,
        'update_catalog': update_catalog,
    }
)
```

## Technical Notes

### Compatibility Handling

The module includes robust compatibility handling:

- **Setuptools Priority**: Prefers setuptools over distutils when available
- **Error Handling**: Gracefully falls back to generic Exception types for older setuptools versions
- **Legacy Support**: Maintains support for distutils-based projects

### Import Strategy

```python
# Handles setuptools availability gracefully
try:
    from setuptools import Command
    # Handle version differences in error types
except ImportError:
    from distutils.cmd import Command
```

## Available Commands Dictionary

The `COMMANDS` dictionary provides a convenient mapping of all available commands:

```python
COMMANDS = {
    "compile_catalog": compile_catalog,
    "extract_messages": extract_messages,
    "init_catalog": init_catalog,
    "update_catalog": update_catalog,
}
```

## Version Notes

- **compile_catalog**: Available since version 0.9
- **update_catalog**: Available since version 0.9
- **extract_messages** and **init_catalog**: Available in earlier versions

## Best Practices

1. **Use with setuptools**: For best compatibility and features, use with setuptools rather than plain distutils
2. **Validate extractors**: The `message_extractors` parameter must be a dictionary mapping paths to extraction methods
3. **Command sequence**: Typical workflow is: extract → init → update → compile
4. **Version compatibility**: Be aware that some error handling features require setuptools 59+ (November 2021)

## Dependencies

- **babel.messages.frontend**: Core Babel functionality
- **setuptools** (preferred) or **distutils**: Build system integration
- **Python 3.7+**: Due to `from __future__ import annotations`