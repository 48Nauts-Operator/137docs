<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# babel.support

## Overview

The `babel.support` module provides several classes and functions that help with integrating and using Babel in applications. This module contains utility classes for formatting dates/numbers, lazy evaluation, and translation support.

> **Note**: The code in this module is not used by Babel itself, but rather provides convenience utilities for applications using Babel.

## Classes

### Format

A wrapper class that provides various date and number formatting functions bound to a specific locale and time-zone.

#### Constructor

```python
def __init__(
    self,
    locale: Locale | str,
    tzinfo: _datetime.tzinfo | None = None,
    *,
    numbering_system: Literal["default"] | str = "latn",
) -> None
```

**Parameters:**
- `locale`: The locale identifier or `Locale` instance
- `tzinfo`: The time-zone info (a `tzinfo` instance or `None`)
- `numbering_system`: The numbering system used for formatting number symbols (defaults to "latn")

#### Key Methods

**Date/Time Formatting:**
- `date()` - Format dates according to locale patterns
- `datetime()` - Format date and time combinations
- `time()` - Format time values
- `timedelta()` - Format time deltas with granularity control

**Number Formatting:**
- `number()` - Format integers with locale-specific separators
- `decimal()` - Format decimal numbers
- `compact_decimal()` - Format numbers in compact form (e.g., "123M")
- `currency()` - Format currency values
- `compact_currency()` - Format currency in compact form
- `percent()` - Format percentages
- `scientific()` - Format numbers in scientific notation

#### Example Usage

```python
from babel.support import Format
from babel.util import UTC
from datetime import date

fmt = Format('en_US', UTC)
print(fmt.date(date(2007, 4, 1)))  # 'Apr 1, 2007'
print(fmt.decimal(1.2345))         # '1.234'
print(fmt.percent(0.34))           # '34%'
```

---

### LazyProxy

A proxy class that delegates to a specified function to evaluate the actual object lazily. This is useful for implementing lazy translation functions that delay evaluation until the string is actually used.

#### Constructor

```python
def __init__(
    self, 
    func: Callable[..., Any], 
    *args: Any, 
    enable_cache: bool = True, 
    **kwargs: Any
) -> None
```

**Parameters:**
- `func`: The function to call for evaluation
- `*args`: Positional arguments to pass to the function
- `enable_cache`: Whether to cache the result after first evaluation
- `**kwargs`: Keyword arguments to pass to the function

#### Features

- **Complete proxy implementation**: Supports most Python operations (arithmetic, comparison, iteration, etc.)
- **Lazy evaluation**: Function is only called when the value is actually needed
- **Caching support**: Optional caching of results to avoid repeated function calls
- **Copy support**: Implements `__copy__` and `__deepcopy__`

#### Example Usage

```python
from babel.support import LazyProxy

def greeting(name='world'):
    return f'Hello, {name}!'

lazy_greeting = LazyProxy(greeting, name='Joe')
print(lazy_greeting)  # 'Hello, Joe!'
print(f'({lazy_greeting})')  # '(Hello, Joe!)'
```

---

### NullTranslations

An extended version of `gettext.NullTranslations` that provides Babel's additional gettext methods. This class behaves like the standard `NullTranslations` but adds support for domain-specific and context-aware translations.

#### Key Methods

**Domain-specific translations:**
- `dgettext()` - Get text from specific domain
- `dngettext()` - Get plural text from specific domain
- `dpgettext()` - Get context-aware text from specific domain
- `dnpgettext()` - Get context-aware plural text from specific domain

**Context-aware translations:**
- `pgettext()` - Get text with context
- `npgettext()` - Get plural text with context
- `upgettext()` - Get Unicode text with context
- `unpgettext()` - Get Unicode plural text with context

#### Features

- **Context encoding**: Uses `\x04` separator for context+message encoding
- **Domain support**: Manages multiple translation domains
- **Fallback support**: Integrates with gettext's fallback mechanism
- **Backward compatibility**: Maintains compatibility with older Babel versions

---

### Translations

An extended translation catalog class that inherits from both `NullTranslations` and `gettext.GNUTranslations`.

#### Constructor

```python
def __init__(
    self, 
    fp: gettext._TranslationsReader | None = None, 
    domain: str | None = None
):
```

**Parameters:**
- `fp`: The file-like object to read translations from
- `domain`: The message domain (default: 'messages')

#### Key Methods

```python
@classmethod
def load(
    cls,
    dirname: str | os.PathLike[str] | None = None,
    locales: Iterable[str | Locale] | Locale | str | None = None,
    domain: str | None = None,
) -> NullTranslations
```

Load translations from MO files in a directory.

```python
def add(self, translations: Translations, merge: bool = True)
```

Add translations to the catalog, optionally merging with existing translations.

```python
def merge(self, translations: Translations)
```

Merge translations, with new translations overriding existing ones.

#### Example Usage

```python
from babel.support import Translations

# Load translations from directory
catalog = Translations.load('locale', ['en_US', 'en'], 'messages')

# Add additional translations
other_catalog = Translations.load('locale', ['en_US'], 'errors')
catalog.add(other_catalog)
```

## Utility Functions

### `_locales_to_names()`

Internal utility function that normalizes a `locales` argument to a list of locale names. Handles various input types including