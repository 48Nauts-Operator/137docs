<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# Unit Formatting Module Documentation

## Overview

This Python module provides comprehensive functionality for formatting and displaying measurement units according to locale-specific conventions. It leverages the Babel library to handle internationalization (i18n) and localization (l10n) of units, supporting various display formats and compound units across different languages and regions.

## Purpose

The module enables developers to:
- Format numeric values with appropriate measurement units
- Display unit names in different locales and lengths (short, long, narrow)
- Handle compound units (e.g., "kilometers per hour")
- Respect locale-specific pluralization rules
- Support different numbering systems

## Classes

### `UnknownUnitError`

```python
class UnknownUnitError(ValueError)
```

**Purpose**: Custom exception raised when an unknown measurement unit is encountered.

**Parameters**:
- `unit` (str): The unknown unit identifier
- `locale` (Locale): The locale being used

**Usage**: Automatically raised by formatting functions when invalid units are provided.

## Main Functions

### `get_unit_name()`

```python
def get_unit_name(
    measurement_unit: str,
    length: Literal['short', 'long', 'narrow'] = 'long',
    locale: Locale | str | None = None,
) -> str | None
```

**Purpose**: Retrieves the display name for a measurement unit in the specified locale.

**Parameters**:
- `measurement_unit`: Unit code (from CLDR Unit Validity XML)
- `length`: Display format - "short", "long", or "narrow"
- `locale`: Target locale (defaults to system numeric locale)

**Returns**: Unit display name or None

**Example**:
```python
get_unit_name("radian", locale="en")  # Returns: 'radians'
```

### `format_unit()`

```python
def format_unit(
    value: str | float | decimal.Decimal,
    measurement_unit: str,
    length: Literal['short', 'long', 'narrow'] = 'long',
    format: str | None = None,
    locale: Locale | str | None = None,
    *,
    numbering_system: Literal["default"] | str = "latn",
) -> str
```

**Purpose**: Formats a numeric value with its measurement unit according to locale conventions.

**Key Features**:
- Respects pluralization rules
- Supports custom number formatting
- Handles different numbering systems
- Locale-aware formatting

**Parameters**:
- `value`: The numeric value to format
- `measurement_unit`: Unit identifier
- `length`: Display format
- `format`: Optional number format pattern
- `locale`: Target locale
- `numbering_system`: Numbering system to use

**Examples**:
```python
format_unit(12, 'length-meter', locale='ro_RO')     # '12 metri'
format_unit(15.5, 'length-mile', locale='fi_FI')   # '15,5 mailia'
format_unit(1, 'length-meter', locale='ro_RO')     # '1 metru' (singular)
```

### `format_compound_unit()`

```python
def format_compound_unit(
    numerator_value: str | float | decimal.Decimal,
    numerator_unit: str | None = None,
    denominator_value: str | float | decimal.Decimal = 1,
    denominator_unit: str | None = None,
    length: Literal["short", "long", "narrow"] = "long",
    format: str | None = None,
    locale: Locale | str | None = None,
    *,
    numbering_system: Literal["default"] | str = "latn",
) -> str | None
```

**Purpose**: Formats compound units like "kilometers per hour" or ratios.

**Key Features**:
- Supports predefined compound units (e.g., speed, consumption)
- Falls back to generic "per" patterns
- Handles preformatted values
- Flexible numerator/denominator combinations

**Examples**:
```python
format_compound_unit(150, "kilometer", denominator_unit="hour", locale="sv")
# Returns: '150 kilometer per timme'

format_compound_unit(7, denominator_value=11, length="short", locale="pt")
# Returns: '7/11'
```

## Helper Functions

### `_find_unit_pattern()`

**Purpose**: Internal function that expands partial unit identifiers into fully qualified forms.

**Example**:
```python
_find_unit_pattern("radian", locale="en")  # Returns: 'angle-radian'
```

### `_find_compound_unit()`

**Purpose**: Internal function that locates predefined compound unit patterns.

**Example**:
```python
_find_compound_unit("kilometer", "hour", locale="en")  # Returns: 'speed-kilometer-per-hour'
```

## Important Notes

### Unit Identifiers
- Unit codes should follow the CLDR Unit Validity XML specification
- Reference: https://unicode.org/repos/cldr/tags/latest/common/validity/unit.xml
- Examples: `length-meter`, `temperature-celsius`, `speed-kilometer-per-hour`

### Locale Support
- Uses Babel's locale system
- Falls back to system numeric locale if none specified
- Supports comprehensive internationalization features

### Error Handling
- `UnknownUnitError` is raised for invalid units
- Functions gracefully handle missing patterns with fallbacks

## Usage Recommendations

1. **Always specify locales** explicitly for consistent results across different environments
2. **Use qualified unit names** (e.g., `length-meter` instead of `meter`) for reliability
3. **Handle UnknownUnitError** exceptions when working with dynamic unit data
4. **Test with different locales** to ensure proper pluralization and formatting
5. **Consider numbering systems** for non-Latin script locales

## Dependencies

- `babel.core.Locale`: Locale handling
- `babel.numbers`: Number formatting utilities
- `decimal`: Precise decimal arithmetic
- Standard typing modules for type hints

This module is particularly useful for applications requiring internationalized unit display, such as scientific software, measurement tools, or any application dealing with localized numeric data presentation.