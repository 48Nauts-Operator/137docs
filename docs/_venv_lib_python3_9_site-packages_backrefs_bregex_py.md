<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# bregex Module Documentation

## Overview

The `bregex` module extends the Python `regex` module to provide additional backslash escape sequences and enhanced pattern matching capabilities. It serves as a wrapper around the `regex` module, adding support for various backreferences that are not available in the standard library.

## Purpose

This module adds the following enhanced backslash sequences:

- **Search patterns:**
  - `\Q` and `\Q...\E` - Escape/quote characters 
  - `\R` - Generic line breaks

- **Replace patterns:**
  - `\c` and `\C...\E` - Uppercase character or characters
  - `\l` and `\L...\E` - Lowercase character or characters  
  - `\N{Black Club Suit}` - Unicode character by name
  - `\u0000` and `\U00000000` - Unicode characters

## Key Classes

### Bregex

The main compiled pattern class that wraps regex patterns with enhanced functionality.

```python
class Bregex(Generic[AnyStr]):
    """Enhanced regex pattern object with backref support."""
```

**Key Features:**
- Automatic compilation of replace templates
- Caching for improved performance
- Full compatibility with regex module methods
- Support for format-style replacements

**Important Methods:**
- `search()`, `match()`, `fullmatch()` - Pattern matching
- `sub()`, `subf()` - Substitution (regular and format-style)
- `subn()`, `subfn()` - Substitution with count
- `split()`, `splititer()` - String splitting
- `findall()`, `finditer()` - Finding matches
- `compile()` - Compile replacement templates

### ReplaceTemplate

A compiled replacement template that handles enhanced backslash sequences in replacement strings.

```python
from ._bregex_parse import ReplaceTemplate
```

## Core Functions

### Compilation Functions

#### `compile(pattern, flags=0, auto_compile=None, **kwargs)`
Compiles a pattern into a `Bregex` object with enhanced backref support.

```python
import bregex

# Compile with auto-compilation enabled
pattern = bregex.compile(r'\Q.+\E', bregex.IGNORECASE)
```

#### `compile_search(pattern, flags=0, **kwargs)`
Compiles only the search pattern with backref processing.

#### `compile_replace(pattern, repl, flags=0)`
Compiles a replacement template for use with substitution functions.

### Pattern Matching Functions

#### `search(pattern, string, flags=0)`
Searches for the first occurrence of pattern in string.

```python
match = bregex.search(r'\Q...\E', 'Find ... in text')
```

#### `match(pattern, string, flags=0)`
Matches pattern at the beginning of string.

#### `fullmatch(pattern, string, flags=0)`  
Matches pattern against the entire string.

### Substitution Functions

#### `sub(pattern, repl, string, count=0, flags=0)`
Performs substitution with enhanced backref support.

```python
result = bregex.sub(r'(\w+)', r'\C\1\E', 'hello world')  # -> 'HELLO WORLD'
```

#### `subf(pattern, repl, string, count=0, flags=0)`
Performs format-style substitution.

#### `subn(pattern, repl, string, count=0, flags=0)`
Like `sub()` but returns tuple of (result, count).

#### `subfn(pattern, repl, string, count=0, flags=0)`  
Like `subf()` but returns tuple of (result, count).

### Expansion Functions

#### `expand(match, repl)`
Expands a replacement template against a match object.

#### `expandf(match, repl)`
Expands a format-style replacement template.

### Utility Functions

#### `split(pattern, string, maxsplit=0, flags=0)`
Splits string by pattern occurrences.

#### `findall(pattern, string, flags=0)`
Returns all non-overlapping matches as a list.

#### `finditer(pattern, string, flags=0)`  
Returns an iterator of match objects.

#### `purge()`
Clears internal caches.

## Constants and Flags

The module exposes all regex flags:

```python
# Common flags
IGNORECASE = I
MULTILINE = M  
DOTALL = S
VERBOSE = X
DEBUG = D
# ... and many more
```

**Special Flags:**
- `FORMAT = 1` - Enables format-style replacements

## Caching

The module implements LRU caching for compiled patterns:

- **Cache size:** 500 entries (configurable via `_MAXCACHE`)
- **Cached functions:** `_cached_search_compile()`, `_cached_replace_compile()`
- **Cache management:** Use `purge()` to clear caches

## Usage Examples

### Basic Pattern Matching
```python
import bregex

# Quote literal characters
pattern = bregex.compile(r'\Q.+*?[]\E')  
text = 'Find .+*?[] literally'
match = pattern.search(text)
```

### Case Conversion in Replacements
```python
# Convert to uppercase
result = bregex.sub(r'(\w+)', r'\U\1\E', 'hello world')
# Result: 'HELLO WORLD'

# Convert first char to uppercase  
result = bregex.sub(r'(\w)(\w*)', r'\u\1\L\2\E', 'hello WORLD')
# Result: 'Hello world'
```

### Unicode Character Insertion
```python
# Insert Unicode by name
result = bregex.sub(r'(club)', r'\1 \N{Black Club Suit}', 'I like club')
# Result: 'I like club â™£'
```

### Format-Style Replacements
```python
# Using subf for format-style
result = bregex.subf(r'(?P<word>\w+)', r'\U{word}\E', 'hello')
# Result: 'HELLO