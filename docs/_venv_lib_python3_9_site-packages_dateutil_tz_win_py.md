<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# tzwin Module Documentation

## Overview

The `tzwin` module provides an interface to native Windows time zone data, including `datetime.tzinfo` implementations. This module reads time zone information directly from the Windows registry and system DLLs, making it Windows-specific.

> **Note**: This module can only be imported on Windows platforms. Attempting to import it on non-Windows systems will raise an `ImportError`.

## Purpose

- Access Windows time zone data from the registry
- Create timezone-aware datetime objects using Windows system time zones  
- Provide both named time zones and local system time zone support
- Extract localized time zone names from Windows system resources

## Classes

### `tzres`

A utility class for accessing `tzres.dll`, which contains timezone name resources.

**Key Methods:**
- `load_name(offset)` - Load a timezone name from a DLL offset
- `name_from_string(tzname_str)` - Parse registry timezone strings

**Example:**
```python
from dateutil.tzwin import tzres
tzr = tzres()
print(tzr.load_name(112))  # 'Eastern Standard Time'
print(tzr.name_from_string('@tzres.dll,-251'))  # 'Dateline Daylight Time'
```

### `tzwinbase`

Abstract base class for Windows timezone implementations. Provides common functionality for timezone comparisons and transitions.

**Key Methods:**
- `list()` - Static method returning all system-known time zones
- `display()` - Return the display name of the time zone
- `transitions(year)` - Get DST transition times for a given year

### `tzwin`

Concrete implementation for named Windows time zones from the registry.

**Constructor:**
```python
tzwin(name)
```

**Parameters:**
- `name` - The name of a Windows time zone key (e.g., "Eastern Standard Time")

**Example:**
```python
from dateutil.tzwin import tzwin
import datetime

# Create timezone object
eastern = tzwin('Eastern Standard Time')

# Use with datetime
dt = datetime.datetime(2023, 7, 4, 12, 0, tzinfo=eastern)
print(dt)  # 2023-07-04 12:00:00-04:00
```

### `tzwinlocal`

Represents the local system time zone by reading directly from the Windows registry.

**Constructor:**
```python
tzwinlocal()
```

**Example:**
```python
from dateutil.tzwin import tzwinlocal
import datetime

# Create local timezone object  
local_tz = tzwinlocal()

# Use with datetime
dt = datetime.datetime.now(local_tz)
print(dt)
```

## Utility Functions

### `picknthweekday(year, month, dayofweek, hour, minute, whichweek)`

Calculate the nth occurrence of a weekday in a given month/year.

**Parameters:**
- `year`, `month` - Target year and month
- `dayofweek` - Day of week (0=Sunday, Microsoft style)
- `hour`, `minute` - Time components
- `whichweek` - Which occurrence (5 means last instance)

### `valuestodict(key)`

Convert Windows registry key values to a Python dictionary, handling different data types and tzres string references.

## Constants

- `TZKEYNAMENT` - Registry path for Windows NT time zones
- `TZKEYNAME9X` - Registry path for Windows 9x time zones  
- `TZLOCALKEYNAME` - Registry path for local time zone information
- `ONEWEEK` - Timedelta representing one week

## Usage Notes

### Getting Available Time Zones
```python
from dateutil.tzwin import tzwin

# List all available time zones
zones = tzwin.list()
print(zones[:5])  # ['Dateline Standard Time', 'UTC-11', 'Aleutian Standard Time', ...]
```

### Handling DST Transitions
```python
eastern = tzwin('Eastern Standard Time')

# Get DST transitions for 2023
transitions = eastern.transitions(2023)
if transitions:
    dst_start, dst_end = transitions
    print(f"DST starts: {dst_start}")
    print(f"DST ends: {dst_end}")
```

## Important Considerations

- **Windows Only**: This module is platform-specific and will not work on Unix-like systems
- **Registry Access**: Requires read access to Windows registry
- **DST Handling**: Automatically handles daylight saving time transitions based on Windows rules
- **Performance**: Direct registry access may be slower than cached implementations

## Error Handling

The module includes proper error handling for:
- Non-Windows platforms (raises `ImportError`)
- Missing registry keys
- Malformed timezone strings
- Invalid time zone names

## Version Information

- **Added in**: dateutil 2.5.0 (for `tzres` class)
- **Original contributor**: Jeffrey Harris