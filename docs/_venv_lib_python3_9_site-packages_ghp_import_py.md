<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# ghp-import Documentation

## Overview

The `ghp-import` module is a utility for importing documentation directories to GitHub Pages branches. It provides a streamlined way to publish static content (like documentation sites) to a `gh-pages` branch or similar Git branch used for hosting static websites.

## Purpose

- **Primary Function**: Import static files from a source directory into a Git branch (typically `gh-pages`)
- **Use Case**: Automatically publish documentation or static websites to GitHub Pages
- **Key Feature**: Uses Git's fast-import mechanism for efficient bulk operations

## Important Classes and Functions

### Classes

#### `GhpError`
Custom exception class for handling errors specific to the ghp-import process.

```python
class GhpError(Exception):
    def __init__(self, message):
        self.message = message
```

#### `Git`
Wrapper class for Git operations with support for both shell and direct subprocess execution.

**Key Methods:**
- `check_repo()`: Validates that the current directory is a Git repository
- `try_rebase()`: Attempts to rebase the target branch with the remote
- `get_config()`: Retrieves Git configuration values
- `get_prev_commit()`: Gets the previous commit hash for a branch
- `call()`: Executes Git commands and returns the exit code

### Core Functions

#### `ghp_import(srcdir, **kwargs)`
Main function that orchestrates the import process.

**Parameters:**
- `srcdir`: Source directory containing files to import
- `**kwargs`: Configuration options (branch name, remote, etc.)

**Process:**
1. Validates the source directory
2. Checks Git repository status
3. Attempts to rebase the target branch
4. Imports files using Git fast-import
5. Optionally pushes changes to remote

#### `run_import(git, srcdir, **opts)`
Handles the actual file import using Git's fast-import feature.

**Features:**
- Walks through source directory recursively
- Preserves file permissions (executable vs regular files)
- Supports custom commit messages and branch prefixes
- Can add `.nojekyll` file automatically
- Supports custom CNAME files

#### Utility Functions

- `mk_when()`: Creates RFC2822 formatted timestamps for Git commits
- `start_commit()`: Initiates a Git fast-import commit
- `add_file()`: Adds individual files to the Git fast-import stream
- `add_nojekyll()`: Adds `.nojekyll` file to disable Jekyll processing
- `add_cname()`: Adds CNAME file for custom domains
- `gitpath()`: Converts OS-specific paths to Git-compatible paths

## Command Line Options

| Option | Description | Default |
|--------|-------------|---------|
| `-b, --branch` | Target branch name | `gh-pages` |
| `-r, --remote` | Remote repository name | `origin` |
| `-m, --message` | Commit message | `Update documentation` |
| `-p, --push` | Push after committing | `False` |
| `-f, --force` | Force push | `False` |
| `-n, --no-jekyll` | Add `.nojekyll` file | `False` |
| `-c, --cname` | Add CNAME file | `None` |
| `-x, --prefix` | File path prefix | `None` |
| `-o, --no-history` | Create commit without history | `False` |
| `-s, --shell` | Use shell for Git commands | `False` |
| `-l, --follow-links` | Follow symbolic links | `False` |

## Usage Examples

### Basic Usage
```bash
# Import current directory to gh-pages branch
ghp-import .

# Import specific directory
ghp-import docs/
```

### Advanced Usage
```bash
# Import and push with custom message
ghp-import docs/ -p -m "Update documentation v2.1"

# Import to custom branch with force push
ghp-import site/ -b custom-pages -f -p

# Import with Jekyll disabled and custom domain
ghp-import dist/ -n -c example.com -p
```

### Programmatic Usage
```python
from ghp_import import ghp_import

# Basic import
ghp_import('docs/')

# Advanced configuration
ghp_import('site/', 
          branch='custom-pages',
          push=True,
          force=True,
          nojekyll=True,
          cname='example.com')
```

## Notes and Recommendations

### ‚ö†Ô∏è Important Considerations

- **Destructive Operation**: The import process replaces all content in the target branch
- **Git Repository Required**: Must be run from within a Git repository
- **Backup Recommended**: Consider backing up your target branch before running

### üí° Best Practices

- Use `--no-jekyll` flag when importing non-Jekyll sites to GitHub Pages
- Set up proper Git user configuration before running
- Test with `--no-push` first to verify the import works correctly
- Use `--prefix` to organize files in subdirectories

### üîß Technical Notes

- Uses Git's fast-import for efficient bulk operations
- Supports both Python 2 and Python 3
- Handles binary files correctly
- Preserves file permissions where applicable
- Uses proper timezone handling for commit timestamps

### Environment Variables

The tool respects these Git environment variables:
- `GIT_COMMITTER_NAME`
- `GIT_COMMITTER_EMAIL` 
- `GIT_COMMITTER_DATE`

If not set, it falls back to Git's configured user settings.