<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# FreezableDefaultDict and Pair Classes

This Python module provides two utility classes for enhanced data handling: `FreezableDefaultDict` for controlled mutation of default dictionaries, and `Pair` for parsing key-value pairs.

## Overview

The module contains:
- A freezable variant of Python's `defaultdict` that can prevent new key creation after initialization
- A named tuple class for handling key-value pair data with parsing capabilities

## Classes

### FreezableDefaultDict

A specialized `defaultdict` that can be "frozen" to prevent the creation of new keys while still allowing access to existing ones.

#### Purpose
- Prevents accidental mutation of a dictionary after its initial construction
- Useful when iterating over dictionaries where new key creation could cause issues
- Maintains existing functionality while adding controlled immutability

#### Key Methods

- **`freeze()`**: Prevents new keys from being added to the dictionary
  ```python
  dd = FreezableDefaultDict(list)
  dd[0].append('item')
  dd.freeze()
  # New keys will not be created after this point
  ```

- **`__missing__(key)`**: Overridden to respect the frozen state
  - Before freezing: Creates new keys with default values (normal `defaultdict` behavior)
  - After freezing: Returns a new default value without adding it to the dictionary

#### Example Usage

```python
# Create a FreezableDefaultDict with list as default factory
dd = FreezableDefaultDict(list)

# Add items normally
dd[0].append('first_item')
dd[1].append('second_item')

# Freeze the dictionary
dd.freeze()

# Accessing existing keys still works
print(dd[0])  # ['first_item']

# Accessing new keys returns default value but doesn't add to dict
print(dd[999])  # [] (empty list)
print(len(dd))  # Still 2, not 3
```

### Pair

A `NamedTuple` representing a key-value pair with built-in parsing functionality.

#### Purpose
- Structured representation of name-value relationships
- Convenient parsing of string-based key-value data
- Type-safe alternative to plain tuples or dictionaries for paired data

#### Attributes
- **`name`** (`str`): The key/name portion of the pair
- **`value`** (`str`): The value portion of the pair

#### Key Methods

- **`parse(text)`** (class method): Parses a string containing a key-value pair separated by "="
  ```python
  pair = Pair.parse("username = john_doe")
  # Returns Pair(name='username', value='john_doe')
  ```

#### Example Usage

```python
# Parse a configuration-style string
config_line = "database_host = localhost"
pair = Pair.parse(config_line)

print(pair.name)   # 'database_host'
print(pair.value)  # 'localhost'

# Create directly
pair2 = Pair("port", "5432")
```

## Notes and Suggestions

### FreezableDefaultDict
- **Thread Safety**: Not inherently thread-safe. Consider additional synchronization in multi-threaded environments
- **Performance**: After freezing, there's a slight overhead due to the lambda function call
- **Use Cases**: Ideal for configuration objects, caching scenarios, or any case where you need to prevent accidental key creation

### Pair
- **Parsing Limitations**: The `parse` method splits only on the first "=" character, which is appropriate for most key-value formats
- **Validation**: Consider adding validation in the `parse` method if you need to ensure both name and value are present
- **Extension**: Could be extended to handle different separators or more complex parsing rules

### General Recommendations
- Both classes are lightweight and focused on specific use cases
- Consider type hints when using these classes in larger codebases
- The `FreezableDefaultDict` doctest serves as good documentation - ensure it passes when making modifications

## Dependencies

- `collections`: For `defaultdict` base class
- `typing`: For `NamedTuple` and type annotations