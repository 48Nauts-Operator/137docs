<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# Python Markdown Command Line Interface

## Overview

This file provides the command-line interface (CLI) for the Python Markdown library, which is a Python implementation of John Gruber's Markdown specification. It allows users to convert Markdown files to HTML directly from the command line.

## Purpose

The CLI module enables users to:
- Convert Markdown files to HTML from the command line
- Configure output formats (HTML or XHTML)
- Load and configure Markdown extensions
- Control logging levels and output destinations
- Handle various input/output encodings

## Key Components

### Dependencies and Imports

The module handles YAML configuration files with fallback support:

```python
try:
    from yaml import unsafe_load as yaml_load
except ImportError:
    try:
        from yaml import load as yaml_load
    except ImportError:
        from json import load as yaml_load
```

**Note**: The code uses `unsafe_load` from PyYAML, which can execute arbitrary Python code. This is acceptable for CLI usage but should be used with caution.

### Main Functions

#### `parse_options(args=None, values=None)`

Defines and parses command-line options using the `optparse` module.

**Available Options:**
- `-f, --file`: Specify output file (defaults to STDOUT)
- `-e, --encoding`: Set encoding for input/output files
- `-o, --output_format`: Choose between 'xhtml' (default) or 'html'
- `-n, --no_lazy_ol`: Control ordered list numbering behavior
- `-x, --extension`: Load Markdown extensions (can be used multiple times)
- `-c, --extension_configs`: Load extension configurations from JSON/YAML file
- `-q, --quiet`: Suppress all warnings
- `-v, --verbose`: Print all warnings
- `--noisy`: Print debug messages

**Returns:**
- `opts`: Dictionary containing parsed options
- `verbose`: Logging level setting

#### `run()`

Main entry point that:
1. Parses command-line options
2. Sets up logging configuration
3. Calls `markdown.markdownFromFile()` with parsed options

## Usage Examples

### Basic Usage

```bash
# Convert from file to stdout
python -m markdown input.md

# Convert with output file
python -m markdown -f output.html input.md

# Convert from stdin
cat input.md | python -m markdown
```

### Advanced Usage

```bash
# Use extensions
python -m markdown -x tables -x toc input.md

# With configuration file
python -m markdown -x tables -c config.yaml input.md

# Specify encoding and format
python -m markdown -e utf-8 -o html input.md

# Enable verbose logging
python -m markdown -v input.md
```

## Configuration Files

Extension configurations can be loaded from JSON or YAML files:

```yaml
# config.yaml example
tables:
  use_align_attribute: true
toc:
  title: "Table of Contents"
  baselevel: 2
```

## Logging

The module provides three logging levels:
- **Quiet** (`-q`): Suppress all warnings
- **Verbose** (`-v`): Show warnings
- **Noisy** (`--noisy`): Show debug messages

## Notes and Considerations

### Security Warning
- The use of `yaml.unsafe_load` allows execution of arbitrary Python code in YAML files
- Only use trusted configuration files
- Consider this acceptable risk for CLI usage where users control input

### Deprecation Notice
- Uses `optparse` module which is deprecated in favor of `argparse`
- Consider migrating to `argparse` for future versions

### Compatibility
- Supports fallback for older PyYAML versions
- Falls back to JSON parsing if YAML is unavailable
- Handles missing input files gracefully (uses STDIN)

## Integration

This module is designed to be run as:
```bash
python -m markdown [options] [input_file]
```

The `if __name__ == '__main__'` block enables direct execution of the module as a command-line tool.