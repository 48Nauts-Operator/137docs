<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# Python Markdown CLI Module

## Overview

This module provides a command-line interface (CLI) for the Python Markdown library, which is a Python implementation of John Gruber's Markdown specification. The module allows users to convert Markdown files to HTML directly from the command line.

## Purpose

- **Primary Function**: Enables command-line conversion of Markdown text to HTML
- **Flexibility**: Supports various output formats, extensions, and configuration options
- **Accessibility**: Makes the Python Markdown library usable without writing Python code

## Key Components

### Functions

#### `parse_options(args=None, values=None)`

Defines and parses command-line options using the `optparse` module.

**Parameters:**
- `args`: Command-line arguments (optional)
- `values`: Default values for options (optional)

**Returns:**
- Tuple containing parsed options dictionary and logging verbosity level

**Available Options:**
- `-f, --file`: Specify output file (defaults to STDOUT)
- `-e, --encoding`: Set encoding for input/output files
- `-o, --output_format`: Choose output format ('xhtml' or 'html')
- `-n, --no_lazy_ol`: Handle ordered list numbering strictly
- `-x, --extension`: Load Markdown extensions
- `-c, --extension_configs`: Load extension configurations from JSON/YAML file
- `-q, --quiet`: Suppress warnings
- `-v, --verbose`: Show all warnings
- `--noisy`: Show debug messages

#### `run()`

Main entry point for command-line execution. Handles:
- Option parsing
- Logging configuration
- Markdown file processing
- Error handling

### Configuration Loading

The module supports loading extension configurations from:
- **YAML files** (preferred, requires PyYAML)
- **JSON files** (fallback option)

```python
# Configuration loading hierarchy:
try:
    from yaml import unsafe_load as yaml_load  # PyYAML >=5.1
except ImportError:
    try:
        from yaml import load as yaml_load      # PyYAML <5.1
    except ImportError:
        from json import load as yaml_load     # JSON fallback
```

## Usage Examples

### Basic Usage

```bash
# Convert from file to STDOUT
python -m markdown input.md

# Convert with output file
python -m markdown -f output.html input.md

# Convert from STDIN
echo "# Hello World" | python -m markdown
```

### Advanced Usage

```bash
# Use extensions
python -m markdown -x tables -x codehilite input.md

# Specify encoding and output format
python -m markdown -e utf-8 -o html input.md

# Use configuration file
python -m markdown -c config.yaml -x tables input.md

# Verbose output
python -m markdown -v input.md
```

## Important Notes

### Security Considerations

⚠️ **Warning**: The module uses `yaml.unsafe_load()` for configuration files, which can execute arbitrary Python code. This is acceptable for CLI usage but should be noted for security awareness.

### Logging Configuration

The module provides three verbosity levels:
- **Quiet** (`-q`): Suppresses all warnings
- **Verbose** (`-v`): Shows warnings
- **Noisy** (`--noisy`): Shows debug messages

### Extension Configuration

When using extension configurations:
1. Extensions must be loaded with `-x/--extension`
2. Configuration file must be valid JSON or YAML
3. Configuration must result in a Python dictionary compatible with `markdown.Markdown` class

## Dependencies

- **Required**: `markdown` (the main library)
- **Optional**: `PyYAML` (for YAML configuration files)
- **Built-in**: `optparse`, `codecs`, `logging`, `json`

## Deprecation Notes

- Uses `optparse` instead of the newer `argparse` module
- Maintains backward compatibility with older PyYAML versions

## Module Entry Point

The module can be executed directly:

```bash
python -m markdown [options] [input_file]
```

This makes it convenient for users to convert Markdown files without writing Python scripts.