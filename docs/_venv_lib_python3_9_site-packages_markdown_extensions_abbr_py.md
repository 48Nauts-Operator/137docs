<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# Abbreviation Extension for Python-Markdown

## Overview

This extension adds abbreviation handling to Python-Markdown, allowing users to define abbreviations that will be automatically converted to HTML `<abbr>` elements with tooltips when rendered.

## Purpose

The Abbreviation Extension enables:
- **Automatic abbreviation detection**: Finds defined abbreviations in text and wraps them in `<abbr>` tags
- **Tooltip support**: Adds full definitions as `title` attributes for accessibility
- **Flexible definition**: Supports both inline definition syntax and programmatic glossary loading

## Main Components

### `AbbrExtension`

The main extension class that coordinates abbreviation processing.

#### Key Methods

- **`__init__(**kwargs)`**: Initializes the extension with configuration options
- **`reset()`**: Clears all abbreviations and reloads from glossary
- **`load_glossary(dictionary)`**: Adds abbreviations from a dictionary to the glossary
- **`extendMarkdown(md)`**: Registers processors with the Markdown instance

#### Configuration

```python
config = {
    'glossary': [
        {},
        'A dictionary where the key is the abbreviation and the value is the definition.'
    ]
}
```

### `AbbrTreeprocessor`

Processes the parsed document tree to replace abbreviation text with `<abbr>` elements.

#### Key Features

- **Regex-based matching**: Uses compiled regex for efficient abbreviation detection
- **Recursive processing**: Traverses the entire document tree
- **Smart ordering**: Processes longer abbreviations first to avoid conflicts

#### Important Methods

- **`create_element(title, text, tail)`**: Creates an `<abbr>` element with proper attributes
- **`iter_element(el, parent)`**: Recursively processes elements for abbreviation replacement
- **`run(root)`**: Main processing method that builds regex and processes the tree

### `AbbrBlockprocessor`

Parses abbreviation definitions from the markdown text.

#### Definition Syntax

```markdown
*[abbr]: Definition text
```

#### Key Features

- **Pattern matching**: Uses regex to find abbreviation definitions
- **Definition removal**: Removes definition lines from output while storing abbreviations
- **Special handling**: Supports removing abbreviations with empty quotes (`''` or `""`)

## Usage Examples

### Basic Usage

```python
from markdown import Markdown
from markdown.extensions.abbr import AbbrExtension

# Initialize with glossary
md = Markdown(extensions=[AbbrExtension(glossary={'HTML': 'HyperText Markup Language'})])

# Or use inline definitions
text = """
*[HTML]: HyperText Markup Language
*[CSS]: Cascading Style Sheets

HTML and CSS are web technologies.
"""

result = md.convert(text)
```

### Programmatic Glossary Loading

```python
ext = AbbrExtension()
ext.load_glossary({
    'API': 'Application Programming Interface',
    'URL': 'Uniform Resource Locator'
})
```

## Processing Order

The extension registers processors at specific priorities:

1. **AbbrBlockprocessor** (priority 16): Parses definitions from text
2. **AbbrTreeprocessor** (priority 7): Replaces abbreviations in the document tree

## Notes and Suggestions

### Best Practices

- **Define longer abbreviations first**: The processor automatically sorts by length to prevent conflicts
- **Use consistent definitions**: Redefining an abbreviation will overwrite the previous definition
- **Consider accessibility**: The `title` attribute provides important context for screen readers

### Performance Considerations

- The regex compilation happens only when abbreviations are defined
- Longer abbreviation lists may impact processing time
- Consider using the glossary feature for frequently used abbreviations across multiple documents

### Limitations

- **Case sensitive**: Abbreviation matching is case-sensitive
- **Word boundaries**: Only matches whole words (uses `\b` regex boundaries)
- **No nested processing**: Abbreviations within other markup may not be processed

### Deprecated Components

- **`AbbrPreprocessor`**: Renamed to `AbbrBlockprocessor`
- **`AbbrInlineProcessor`**: Will be removed; use `AbbrTreeprocessor` instead

## Integration

To use this extension:

```python
import markdown

md = markdown.Markdown(extensions=['abbr'])
# or
md = markdown.Markdown(extensions=[AbbrExtension()])
```

The extension integrates seamlessly with other Python-Markdown extensions and follows the standard extension architecture.