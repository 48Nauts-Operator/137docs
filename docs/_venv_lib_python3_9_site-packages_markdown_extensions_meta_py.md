<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# Meta Data Extension for Python-Markdown

## Overview

This extension adds metadata handling capabilities to Python-Markdown, allowing users to include structured metadata at the beginning of their Markdown documents. The metadata is parsed and stored separately from the document content, making it accessible programmatically.

## Purpose

The Meta Data extension enables:
- **Document metadata extraction**: Parse key-value pairs from the beginning of Markdown documents
- **YAML-style frontmatter support**: Handle metadata blocks delimited by `---`
- **Multi-line value support**: Allow metadata values to span multiple lines
- **Programmatic access**: Store parsed metadata in the Markdown instance for later use

## Key Components

### Classes

#### `MetaExtension`
The main extension class that integrates metadata processing into Python-Markdown.

**Key Methods:**
- `extendMarkdown(md)`: Registers the extension and adds the MetaPreprocessor
- `reset()`: Clears stored metadata (resets `md.Meta` to empty dict)

#### `MetaPreprocessor`
The core processor that handles metadata parsing from Markdown text.

**Key Methods:**
- `run(lines)`: Parses metadata from the beginning of the document and returns remaining lines

### Regular Expressions

The extension uses several regex patterns to identify metadata:

```python
META_RE = re.compile(r'^[ ]{0,3}(?P<key>[A-Za-z0-9_-]+):\s*(?P<value>.*)')
META_MORE_RE = re.compile(r'^[ ]{4,}(?P<value>.*)')
BEGIN_RE = re.compile(r'^-{3}(\s.*)?')
END_RE = re.compile(r'^(-{3}|\.{3})(\s.*)?')
```

- **`META_RE`**: Matches key-value pairs (e.g., `title: My Document`)
- **`META_MORE_RE`**: Matches continuation lines (indented with 4+ spaces)
- **`BEGIN_RE`**: Matches YAML frontmatter start delimiter (`---`)
- **`END_RE`**: Matches end delimiters (`---` or `...`)

## Metadata Format

### Basic Format
```markdown
title: My Document Title
author: John Doe
date: 2023-01-01
tags: markdown, documentation

# Document Content
Your markdown content here...
```

### YAML-style Frontmatter
```markdown
---
title: My Document Title
author: John Doe
description: This is a sample document
    with a multi-line description
tags: markdown, documentation
---

# Document Content
Your markdown content here...
```

## Usage Example

```python
import markdown

# Create Markdown instance with meta extension
md = markdown.Markdown(extensions=['meta'])

# Process markdown with metadata
html = md.convert("""
---
title: Sample Document
author: Jane Smith
tags: python, markdown
---

# Hello World
This is the content.
""")

# Access parsed metadata
print(md.Meta)
# Output: {
#     'title': ['Sample Document'],
#     'author': ['Jane Smith'],
#     'tags': ['python, markdown']
# }
```

## Important Notes

### Data Structure
- **All values are stored as lists**: Even single values are stored in list format for consistency
- **Keys are lowercase**: All metadata keys are converted to lowercase
- **Multi-line support**: Values can span multiple lines when properly indented

### Processing Order
- **High priority**: Registered with priority 27, ensuring it runs early in the preprocessing pipeline
- **Line consumption**: Removes metadata lines from the document before other processors run

### Limitations
- **Beginning only**: Metadata must appear at the very beginning of the document
- **Simple key-value pairs**: Does not support complex YAML structures like nested objects or arrays
- **No type conversion**: All values remain as strings

## Best Practices

1. **Always check for metadata existence** before accessing `md.Meta`
2. **Remember values are lists** when accessing metadata programmatically
3. **Use consistent key naming** (lowercase, underscores/hyphens only)
4. **Place metadata at document start** before any content or blank lines

## Integration

To use this extension:

```python
# Direct instantiation
md = markdown.Markdown(extensions=[MetaExtension()])

# Or using the factory function
md = markdown.Markdown(extensions=['meta'])
```

The extension automatically registers itself and makes metadata available via the `md.Meta` attribute after processing.