<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# Tables Extension for Python-Markdown

## Overview

This module provides table parsing functionality for Python-Markdown, allowing Markdown processors to convert pipe-separated table syntax into HTML table elements. The extension supports GitHub Flavored Markdown (GFM) table syntax with proper handling of code blocks, escaped characters, and column alignment.

## Purpose

- **Parse Markdown tables**: Converts pipe-separated table syntax to HTML `<table>` elements
- **Handle column alignment**: Supports left, right, and center alignment using colons in separator rows
- **Process code blocks safely**: Ignores pipe characters within code spans to prevent table parsing conflicts
- **Support bordered and borderless tables**: Handles tables with or without leading/trailing pipe characters

## Key Classes

### `TableProcessor`

The main processor class that handles table detection and parsing.

```python
class TableProcessor(BlockProcessor):
    """ Process Tables. """
```

#### Important Methods

- **`test(parent, block)`**: Validates if a block is a valid table by checking the header and separator rows
- **`run(parent, blocks)`**: Parses the table block and builds the HTML table structure
- **`_split_row(row)`**: Splits a table row into individual cells while respecting code blocks
- **`_build_row(row, parent, align)`**: Creates HTML table row elements with proper alignment

#### Key Features

- **Code-aware parsing**: Uses regex pattern `RE_CODE_PIPES` to identify and preserve pipe characters within code spans
- **Border detection**: Tracks whether tables have left/right border pipes using `PIPE_LEFT`, `PIPE_RIGHT`, and `PIPE_NONE` constants
- **Alignment support**: Parses separator row colons to determine column alignment (left, right, center, or none)

### `TableExtension`

The extension class that integrates the table processor with Python-Markdown.

```python
class TableExtension(Extension):
    """ Add tables to Markdown. """
```

#### Configuration Options

- **`use_align_attribute`**: Boolean flag to use HTML `align` attribute instead of CSS `style` attribute for column alignment

## Usage Example

```python
import markdown

# Basic usage
md = markdown.Markdown(extensions=['tables'])
html = md.convert("""
| Header 1 | Header 2 | Header 3 |
|----------|:---------|---------:|
| Cell 1   | Cell 2   | Cell 3   |
| Cell 4   | Cell 5   | Cell 6   |
""")
```

## Table Syntax Support

### Standard Table
```markdown
| Left | Center | Right |
|------|:------:|------:|
| L1   |   C1   |    R1 |
| L2   |   C2   |    R2 |
```

### Borderless Table
```markdown
Left | Center | Right
-----|:-----:|------:
L1   |  C1   |    R1
L2   |  C2   |    R2
```

## Technical Notes

### Regular Expressions

- **`RE_CODE_PIPES`**: Complex regex that identifies escaped backslashes, escaped backticks, code spans, escaped pipes, and table pipes
- **`RE_END_BORDER`**: Detects trailing pipe characters while handling escaped pipes

### Alignment Processing

The separator row parser recognizes:
- `:---` → Left alignment
- `:---:` → Center alignment  
- `---:` → Right alignment
- `---` → No alignment (default)

### Code Block Handling

The processor implements sophisticated logic to:
1. Identify backtick code spans and their boundaries
2. Pair opening and closing backticks by length
3. Exclude pipe characters within code regions from table parsing
4. Handle escaped backticks and pipes correctly

## Suggestions for Usage

### Best Practices

- **Consistent formatting**: Maintain consistent pipe placement for better readability
- **Code safety**: The extension handles code blocks automatically, but be aware of complex escaping scenarios
- **Alignment preference**: Choose between `align` attribute and CSS `style` based on your HTML requirements

### Potential Improvements

- Consider adding support for cell spanning (colspan/rowspan)
- Could benefit from more robust error handling for malformed tables
- Documentation could include more complex examples with nested formatting

## Integration

To use this extension:

```python
# Method 1: Direct import
from markdown.extensions.tables import TableExtension
md = markdown.Markdown(extensions=[TableExtension()])

# Method 2: String reference
md = markdown.Markdown(extensions=['tables'])

# Method 3: With configuration
md = markdown.Markdown(
    extensions=['tables'],
    extension_configs={
        'tables': {
            'use_align_attribute': True
        }
    }
)
```

The extension registers itself with priority 75 in the block processor chain and automatically adds the pipe character (`|`) to the Markdown escaped characters list.