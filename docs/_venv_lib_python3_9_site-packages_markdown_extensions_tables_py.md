<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# Tables Extension for Python-Markdown

## Overview

This extension adds table parsing functionality to Python-Markdown, allowing Markdown text to include HTML tables using pipe-delimited syntax. The extension processes table markup and converts it into proper HTML table elements with support for column alignment and various table formatting options.

## Purpose

- **Primary Function**: Parse pipe-delimited table syntax in Markdown and convert it to HTML tables
- **Key Features**:
  - Column alignment support (left, right, center)
  - Border detection for table boundaries
  - Code-aware parsing (ignores pipes within code blocks)
  - Configurable alignment attribute handling

## Main Classes

### `TableProcessor`

The core class responsible for processing table blocks.

```python
class TableProcessor(BlockProcessor):
    """ Process Tables. """
```

#### Key Attributes

- `border`: Tracks table border configuration (left/right pipes)
- `separator`: Stores the separator row data for alignment parsing
- `config`: Configuration dictionary for extension options

#### Important Methods

##### `test(parent, block)`
Validates whether a block of text represents a valid table structure.

- **Parameters**:
  - `parent`: Parent XML element
  - `block`: Text block to test
- **Returns**: `bool` - True if block is a valid table
- **Function**: Checks for valid header row and separator row format

##### `run(parent, blocks)`
Main processing method that builds the HTML table structure.

- **Parameters**:
  - `parent`: Parent XML element to attach table to
  - `blocks`: List of text blocks to process
- **Function**: Creates `<table>`, `<thead>`, and `<tbody>` elements

##### `_split_row(row)`
Splits a table row into individual cells, handling escaped characters.

```python
def _split_row(self, row: str) -> list[str]:
    """ split a row of text into list of cells. """
```

##### `_build_row(row, parent, align)`
Constructs table row elements with proper cell alignment.

- **Features**:
  - Handles both `<th>` (header) and `<td>` (data) cells
  - Applies alignment via `align` attribute or CSS `style`
  - Manages empty cells gracefully

### `TableExtension`

Main extension class that integrates table processing into Python-Markdown.

```python
class TableExtension(Extension):
    """ Add tables to Markdown. """
```

#### Configuration Options

```python
self.config = {
    'use_align_attribute': [False, 'True to use align attribute instead of style.'],
}
```

- **`use_align_attribute`**: 
  - `False` (default): Uses CSS `style="text-align: center;"` 
  - `True`: Uses HTML `align="center"` attribute

## Constants

```python
PIPE_NONE = 0
PIPE_LEFT = 1
PIPE_RIGHT = 2
```

These constants track table border configurations for proper parsing.

## Key Features

### Code-Aware Parsing

The extension includes sophisticated regex patterns to handle pipes within code blocks:

```python
RE_CODE_PIPES = re.compile(r'(?:(\\\\)|(\\`+)|(`+)|(\\\|)|(\|))')
```

This ensures that table delimiters inside code spans are ignored.

### Column Alignment

Supports three alignment types based on separator row syntax:
- **Left**: `:---`
- **Right**: `---:`
- **Center**: `:---:`

### Usage Example

```markdown
| Header 1 | Header 2 | Header 3 |
|:---------|:--------:|---------:|
| Left     | Center   | Right    |
| Data     | Data     | Data     |
```

## Installation and Setup

```python
def makeExtension(**kwargs):
    return TableExtension(**kwargs)
```

The extension can be loaded using:
```python
import markdown
md = markdown.Markdown(extensions=['tables'])
```

## Notes and Suggestions

### Performance Considerations
- The extension performs multiple regex operations per table row
- Large tables may benefit from caching mechanisms

### Compatibility
- Handles edge cases like empty tables and single-column tables
- Supports escaped pipe characters (`\|`)
- Compatible with other Markdown extensions

### Limitations
- Requires strict separator row format for table recognition
- Complex nested table structures are not supported
- Cell content is processed as plain text (inner Markdown not parsed)

### Best Practices
- Use consistent pipe alignment for better readability
- Test tables with various alignment combinations
- Consider using `use_align_attribute=True` for better HTML compliance in some contexts