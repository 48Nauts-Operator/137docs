<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# MkDocs Serve Module Documentation

## Overview

This module provides the development server functionality for MkDocs, a static site generator for documentation. The primary purpose is to serve documentation locally during development with automatic rebuilding and live reloading capabilities.

## Purpose

The module enables developers to:
- Serve documentation locally on a development server
- Automatically rebuild documentation when files change
- Provide live reload functionality for immediate preview of changes
- Handle different build types (clean/dirty builds)
- Watch additional files and directories for changes

## Main Function

### `serve()`

The core function that starts the MkDocs development server.

```python
def serve(
    config_file: str | None = None,
    livereload: bool = True,
    build_type: str | None = None,
    watch_theme: bool = False,
    watch: list[str] = [],
    *,
    open_in_browser: bool = False,
    **kwargs,
) -> None:
```

#### Parameters

- **`config_file`**: Path to the MkDocs configuration file (optional)
- **`livereload`**: Enable/disable live reload functionality (default: `True`)
- **`build_type`**: Type of build to perform (`'clean'` or `'dirty'`)
- **`watch_theme`**: Whether to watch theme files for changes (default: `False`)
- **`watch`**: List of additional files/directories to watch for changes
- **`open_in_browser`**: Automatically open the site in a browser (default: `False`)
- **`**kwargs`**: Additional configuration parameters

#### Key Features

- **Temporary Build Directory**: Creates a temporary directory for serving files
- **Live Reload Server**: Sets up a server that automatically refreshes pages when files change
- **Error Handling**: Serves custom 404 and 500 error pages when available
- **Plugin Integration**: Integrates with MkDocs plugin system for extensibility

## Key Components

### Configuration Management

```python
def get_config():
    config = load_config(
        config_file=config_file,
        site_dir=site_dir,
        **kwargs,
    )
    config.watch.extend(watch)
    return config
```

- Loads MkDocs configuration
- Sets up temporary site directory
- Extends watch list with additional paths

### Builder Function

```python
def builder(config: MkDocsConfig | None = None):
    log.info("Building documentation...")
    if config is None:
        config = get_config()
        config.site_url = serve_url
    build(config, serve_url=None if is_clean else serve_url, dirty=is_dirty)
```

- Handles the actual documentation building process
- Supports both clean and dirty builds
- Configures appropriate serve URLs

### File Watching

The function sets up watchers for:
- Documentation source files (`config.docs_dir`)
- Configuration file (`config.config_file_path`)
- Theme files (when `watch_theme=True`)
- Additional paths specified in `watch` parameter

### Error Handling

```python
def error_handler(code) -> bytes | None:
    if code in (404, 500):
        error_page = join(site_dir, f'{code}.html')
        if isfile(error_page):
            with open(error_page, 'rb') as f:
                return f.read()
    return None
```

- Serves custom error pages for 404 and 500 errors
- Falls back to default server error handling if custom pages aren't available

## Usage Notes

### Development Workflow

1. **Initial Build**: Performs an initial build of the documentation
2. **File Watching**: Sets up watchers for relevant files and directories
3. **Live Reload**: Serves content with automatic page refresh on changes
4. **Graceful Shutdown**: Handles cleanup when the server is stopped

### Resource Management

- Creates temporary directories for builds
- Properly cleans up temporary files on shutdown
- Handles plugin lifecycle events (`on_startup`, `on_serve`, `on_shutdown`)

## Important Considerations

- **Temporary Files**: The function creates temporary directories that are automatically cleaned up
- **Plugin Integration**: Integrates with the MkDocs plugin system for extensibility
- **Error Recovery**: Includes proper error handling and cleanup procedures
- **Development Only**: This server is intended for development use, not production deployment

## Dependencies

- `mkdocs.commands.build`: For building documentation
- `mkdocs.config`: For configuration management
- `mkdocs.livereload`: For live reload server functionality
- Standard library modules for file operations and URL parsing

## Best Practices

- Use the default settings for most development scenarios
- Enable `watch_theme=True` when developing custom themes
- Add additional watch paths only when necessary to avoid performance issues
- Always allow proper shutdown to ensure cleanup of temporary files