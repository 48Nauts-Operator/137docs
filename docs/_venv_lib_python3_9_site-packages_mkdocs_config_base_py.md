<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# MkDocs Base Configuration Module

This module provides the core configuration framework for MkDocs, including base classes for configuration options, configuration validation, and configuration loading utilities.

## Purpose

The module serves as the foundation for MkDocs configuration system, allowing:
- Type-safe configuration option definitions
- Validation of configuration values
- Loading configuration from YAML files
- Error and warning handling during configuration processing

## Key Classes

### `BaseConfigOption[T]`

A generic base class for defining configuration options with validation.

**Key Features:**
- Generic type support for type safety
- Default value management with immutable protection
- Three-phase validation process (pre, main, post)
- Warning collection system
- Descriptor protocol implementation for attribute access

**Important Methods:**
- `validate(value)` - Main validation entry point
- `pre_validation(config, key_name)` - Called before all validations
- `run_validation(value)` - Core validation logic (override in subclasses)  
- `post_validation(config, key_name)` - Called after all validations pass

```python
# Example usage in subclass
class MyConfigOption(BaseConfigOption[str]):
    def run_validation(self, value):
        if not isinstance(value, str):
            raise ValidationError("Must be a string")
        return value.strip()
```

### `Config`

The main configuration class that behaves like a dictionary with validation capabilities.

**Key Features:**
- Schema-based configuration using `BaseConfigOption` attributes
- Automatic schema detection from class attributes
- Three-phase validation process
- Support for loading from dictionaries and files
- Unrecognized configuration key detection

**Important Methods:**
- `set_defaults()` - Initialize with default values from schema
- `validate()` - Run full validation process, returns errors and warnings
- `load_dict(patch)` - Load configuration from dictionary
- `load_file(config_file)` - Load configuration from YAML file (deprecated)

```python
# Example configuration class
class MyConfig(Config):
    site_name = ConfigOptions.Type(str)
    site_url = ConfigOptions.OptionallyRequired(str)
```

### `LegacyConfig`

A backward-compatible configuration class for plugins that don't use class-based schemas.

**Purpose:** Maintains compatibility with older MkDocs plugins while providing the same validation framework.

### `ValidationError`

Exception raised during configuration validation when invalid values are encountered.

## Key Functions

### `load_config(config_file=None, **kwargs)`

The primary function for loading and validating MkDocs configuration.

**Parameters:**
- `config_file` - Path to config file, file object, or None for default
- `config_file_path` - Override path for config file location
- `**kwargs` - Configuration overrides

**Returns:** Validated `MkDocsConfig` instance

**Process:**
1. Opens configuration file (defaults to `mkdocs.yml`)
2. Loads YAML content into configuration object
3. Applies any keyword argument overrides
4. Validates all configuration options
5. Logs warnings and errors
6. Raises `Abort` exception if validation fails

### `get_schema(cls)`

Utility function to extract configuration schema from a class.

**Parameters:**
- `cls` - Class containing `BaseConfigOption` attributes

**Returns:** Tuple of (key, config_option) pairs

## Type Definitions

```python
PlainConfigSchemaItem = Tuple[str, BaseConfigOption]
PlainConfigSchema = Sequence[PlainConfigSchemaItem] 
ConfigErrors = List[Tuple[str, Exception]]
ConfigWarnings = List[Tuple[str, str]]
```

## Usage Examples

### Basic Configuration Class

```python
from mkdocs.config.base import Config
from mkdocs import config_options

class MyPluginConfig(Config):
    enabled = config_options.Type(bool, default=True)
    api_key = config_options.Type(str)
    timeout = config_options.Type(int, default=30)
```

### Loading Configuration

```python
# Load default mkdocs.yml
config = load_config()

# Load specific file
config = load_config('custom-mkdocs.yml')

# Load with overrides
config = load_config(site_name='My Site', strict=True)
```

## Important Notes

### Migration from Legacy API
- `Config.load_file()` is deprecated since MkDocs 1.5
- Use `MkDocsConfig.load_file()` instead for new code
- `user_configs` property is deprecated and will be removed

### Validation Process
The validation occurs in three phases:
1. **Pre-validation** - Setup and dependency resolution
2. **Main validation** - Core value validation  
3. **Post-validation** - Cross-option validation and finalization

### Error Handling
- Validation errors stop the process immediately
- Warnings are collected but don't prevent loading
- In strict mode, warnings also cause failure

### File Path Handling
- Supports both string paths and file-like objects
- Automatically handles encoding for file system paths
- Defaults to `mkdocs.yml` or `mkdocs.yaml` in current directory

This module forms the backbone of MkDocs' configuration system and should be extended rather than modified directly when creating new configuration options or validation logic.