<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# Page Module Documentation

This module contains the core `Page` class and related functionality for MkDocs page processing, including Markdown rendering, URL handling, and link validation.

## Overview

The `Page` class represents a single documentation page in MkDocs. It handles:
- Markdown content processing and HTML rendering
- URL generation and canonical URL handling
- Table of contents extraction
- Link validation and relative path resolution
- Edit URL generation for source repositories

## Classes

### `Page`

The main class representing a documentation page that extends `StructureItem`.

#### Key Properties

- **`markdown`** (`str | None`): The original Markdown content from the file
- **`content`** (`str | None`): The rendered HTML content (populated after `.render()`)
- **`toc`** (`TableOfContents`): Table of contents with anchor links
- **`meta`** (`MutableMapping[str, Any]`): Metadata from the page's front matter
- **`file`** (`File`): The source documentation file
- **`title`** (`str | None`): Page title (auto-determined from multiple sources)
- **`url`** (`str`): Relative URL of the page
- **`canonical_url`** (`str | None`): Full canonical URL including domain
- **`edit_url`** (`str | None`): URL to edit the source file in repository

#### Navigation Properties

- **`previous_page`** / **`next_page`**: Adjacent pages in navigation
- **`active`** (`bool`): Whether this is the currently viewed page
- **`is_homepage`** (`bool`): True for the site's homepage
- **`is_index`** (`bool`): True for index pages

#### Key Methods

##### `read_source(config: MkDocsConfig) -> None`

Reads and processes the source Markdown file:
- Loads file content through plugin hooks
- Extracts metadata and Markdown content
- Handles file reading errors

##### `render(config: MkDocsConfig, files: Files) -> None`

Converts Markdown to HTML with additional processing:
- Sets up Markdown extensions
- Processes relative links and anchors
- Extracts table of contents
- Identifies anchor IDs for validation

```python
# Example usage
page = Page(title="My Page", file=my_file, config=config)
page.read_source(config)
page.render(config, files)
print(page.content)  # Rendered HTML
```

##### `validate_anchor_links(*, files: Files, log_level: int) -> None`

Validates internal anchor links within the page:
- Checks if linked anchors exist in target pages
- Reports broken anchor links
- Provides helpful error messages

#### Title Resolution

The `title` property follows this priority order:
1. Title provided during initialization (from config)
2. `title` from page metadata
3. First H1 heading in rendered content
4. First H1 heading in Markdown (legacy fallback)
5. Filename converted to title format
6. "Home" for homepage

## Internal Processing Classes

### `_RelativePathTreeprocessor`

Handles relative link processing during Markdown rendering:

- **Purpose**: Converts relative links to proper URLs within the site
- **Features**:
  - Resolves relative file paths
  - Validates link targets exist
  - Generates helpful suggestions for broken links
  - Tracks anchor links for validation

### `_ExtractAnchorsTreeprocessor`

Extracts anchor IDs from rendered HTML:

- **Purpose**: Identifies all linkable anchors in a page
- **Captures**: `id` attributes and `name` attributes on `<a>` tags
- **Used for**: Link validation in other pages

### `_ExtractTitleTreeprocessor`

Extracts the page title from the first H1 element:

- **Purpose**: Provides fallback title extraction from rendered content
- **Priority**: Runs near the end of processing chain

### `_RawHTMLPreprocessor` & `_HTMLHandler`

Processes raw HTML blocks in Markdown:

- **Purpose**: Extracts anchor IDs from raw HTML before Markdown processing
- **Handles**: HTML blocks that Markdown doesn't process

## Usage Notes

### Important Considerations

- **Rendering Order**: Always call `read_source()` before `render()`
- **Link Validation**: Only works after all pages are rendered (anchor IDs must be extracted first)
- **URL Handling**: The class handles both relative and absolute URLs appropriately

### Configuration Dependencies

The Page class relies on several MkDocs configuration options:
- `site_url`: For canonical URL generation
- `repo_url` & `edit_uri`: For edit URL generation
- `use_directory_urls`: Affects link resolution
- `validation.links.*`: Controls link validation behavior

### Example Workflow

```python
# Typical page processing workflow
page = Page(title=None, file=source_file, config=config)

# Read and parse source
page.read_source(config) 
# Now page.markdown and page.meta are populated

# Render to HTML
page.render(config, files)
# Now page.content, page.toc, and link tracking are populated

# Validate links (after all pages rendered)
page.validate_anchor_links(files=files, log_level=logging.WARNING)
```

## Notes

- The module includes extensive link validation with helpful error messages
- URL handling properly supports both directory-style and file-style URLs
- The class integrates deeply with MkDocs' plugin system for extensibility
- Some methods are marked as deprecated (`_set_title`) and will be removed