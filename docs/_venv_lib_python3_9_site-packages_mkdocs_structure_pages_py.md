<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# Page Module Documentation

## Overview

The `page.py` module is a core component of MkDocs that handles the processing and rendering of individual documentation pages. It defines the `Page` class and several internal processors that handle Markdown parsing, link resolution, anchor extraction, and HTML processing.

## Purpose

This module is responsible for:
- Converting Markdown files into structured page objects
- Processing links and making them relative to the site structure
- Extracting metadata, titles, and table of contents from pages
- Validating internal links and anchors
- Rendering Markdown content to HTML

## Main Classes

### `Page`

The primary class representing a single documentation page in MkDocs.

```python
class Page(StructureItem):
    def __init__(self, title: str | None, file: File, config: MkDocsConfig) -> None:
        # Initialize page with title, file reference, and configuration
```

#### Key Properties

- **`markdown`**: The original Markdown content from the file
- **`content`**: The rendered HTML content (populated after rendering)
- **`toc`**: Table of contents as an iterable of anchor links
- **`meta`**: Metadata dictionary from the page's front matter
- **`file`**: Reference to the source documentation file
- **`url`**: Relative URL of the page within the site
- **`canonical_url`**: Full canonical URL including domain
- **`edit_url`**: URL to edit the source file in the repository

#### Navigation Properties

- **`previous_page`** / **`next_page`**: References to adjacent pages in navigation
- **`active`**: Boolean indicating if this is the currently viewed page
- **`is_homepage`**: Boolean indicating if this is the site's homepage
- **`is_index`**: Boolean indicating if this is an index page

#### Important Methods

##### `read_source(config: MkDocsConfig)`
Reads and parses the source Markdown file, extracting content and metadata.

##### `render(config: MkDocsConfig, files: Files)`
Converts Markdown to HTML using configured extensions and processors.

```python
def render(self, config: MkDocsConfig, files: Files) -> None:
    """Convert the Markdown source file to HTML as per the config."""
```

##### `validate_anchor_links(*, files: Files, log_level: int)`
Validates that all internal anchor links point to existing anchors in target pages.

## Internal Processors

### `_ExtractAnchorsTreeprocessor`

Extracts all anchor IDs from the rendered HTML for link validation purposes.

- Scans for `id` attributes on all elements
- Identifies `name` attributes on anchor tags
- Populates `present_anchor_ids` set

### `_RelativePathTreeprocessor`

Processes and validates all links in the document, converting relative paths to proper URLs.

**Key Features:**
- Converts relative links to proper site URLs
- Validates link targets exist in the file collection
- Provides suggestions for broken links
- Handles both internal and external links
- Supports anchor link validation

**Link Processing:**
- External links (with scheme/netloc) are left unchanged
- Absolute links are processed based on configuration
- Relative links are resolved against the file structure
- Self-links with anchors are tracked for validation

### `_RawHTMLPreprocessor`

Processes raw HTML content in Markdown to extract anchor IDs before Markdown processing.

### `_ExtractTitleTreeprocessor`

Extracts the page title from the first H1 element in the rendered content.

### `_HTMLHandler`

HTML parser that identifies anchor IDs in raw HTML content within Markdown.

## Configuration Integration

The module integrates with MkDocs configuration for:
- **Markdown extensions**: Applied during rendering
- **Site URL**: Used for canonical URL generation
- **Repository settings**: Used for edit URL generation
- **Validation settings**: Controls link validation behavior

## Usage Notes

### Title Resolution Priority

The page title is determined in this order:
1. Title provided during initialization (from navigation config)
2. `title` metadata from the page's front matter  
3. Content of the first H1 element in the rendered content
4. Filename converted to title format
5. "Home" for homepage

### Link Validation

The module provides comprehensive link validation:
- **Internal links**: Verified against the files collection
- **Anchor links**: Validated against target page anchors
- **Suggestions**: Provides "did you mean" suggestions for broken links
- **Configurable logging**: Warning levels can be adjusted

### Performance Considerations

- Link validation data is only collected when validation is enabled
- Anchor extraction occurs during the rendering process
- Large sites may benefit from adjusting validation log levels

## Example Usage

```python
# Create a page object
page = Page(title="My Page", file=my_file, config=site_config)

# Read source content
page.read_source(config)

# Render to HTML
page.render(config, files)

# Validate links (if validation is enabled)
if config.validation.anchors:
    page.validate_anchor_links(files=files, log_level=logging.WARNING)
```

## Dependencies

- **`markdown`**: Core Markdown processing
- **`mkdocs.utils`**: Utility functions for URL handling and metadata
- **`mkdocs.structure`**: Base classes and file handling
- Standard library modules for URL parsing and logging