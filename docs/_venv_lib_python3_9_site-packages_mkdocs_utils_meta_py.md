<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# MultiMarkdown Meta-Data Parser

## Overview

This Python module extracts, parses, and transforms MultiMarkdown style metadata from text documents. It supports two metadata formats:
- **YAML front matter** (delimited by `---` or `...`)
- **MultiMarkdown key-value pairs** (simple `key: value` format)

The module is designed to separate document content from its metadata, making it useful for static site generators, documentation processors, and other text processing applications.

## License

This code is released under a BSD 3-Clause License. Copyright (c) 2015, Waylan Limberg.

## Dependencies

- `re` (built-in regex module)
- `yaml` (PyYAML library)
- `typing` (for type hints)

The module attempts to use the faster `CSafeLoader` from PyYAML, falling back to the standard `SafeLoader` if unavailable.

## Regular Expressions

The module uses three compiled regex patterns:

- **`YAML_RE`**: Matches YAML front matter blocks delimited by `---` or `...`
- **`META_RE`**: Matches MultiMarkdown key-value pairs (e.g., `Title: My Document`)
- **`META_MORE_RE`**: Matches continuation lines for MultiMarkdown values (indented with 4 spaces or tab)

## Functions

### `get_data(doc: str) -> tuple[str, dict[str, Any]]`

The main function that extracts metadata from a document string.

**Parameters:**
- `doc` (str): The input document containing both content and metadata

**Returns:**
- `tuple[str, dict[str, Any]]`: A tuple containing:
  - The document content with metadata removed
  - A dictionary of extracted metadata

**Processing Logic:**

1. **YAML Front Matter**: First attempts to parse YAML front matter
   ```python
   # Example YAML front matter
   ---
   title: My Document
   author: John Doe
   tags: [python, markdown]
   ---
   ```

2. **MultiMarkdown Format**: Falls back to MultiMarkdown key-value format
   ```python
   # Example MultiMarkdown metadata
   Title: My Document
   Author: John Doe
   Description: This is a long description
       that continues on multiple lines
   ```

**Key Features:**
- **Duplicate key handling**: Multiple values for the same key are concatenated with spaces
- **Multi-line values**: Supports continuation lines indented with 4 spaces or tabs
- **Case normalization**: Keys are converted to lowercase
- **Error handling**: Gracefully handles YAML parsing errors

## Usage Examples

### YAML Front Matter
```python
doc = """---
title: Sample Document
author: Jane Smith
---

# Main Content
This is the document body.
"""

content, metadata = get_data(doc)
print(metadata)  # {'title': 'Sample Document', 'author': 'Jane Smith'}
print(content)   # '# Main Content\nThis is the document body.\n'
```

### MultiMarkdown Format
```python
doc = """Title: My Article
Author: John Doe
Tags: python, documentation
Description: A comprehensive guide
    to using this parser

# Article Content
Here's the main content.
"""

content, metadata = get_data(doc)
print(metadata)  # {'title': 'My Article', 'author': 'John Doe', ...}
```

## Notes and Suggestions

### ‚ö†Ô∏è Important Considerations

- **YAML Safety**: The module uses `SafeLoader` to prevent execution of arbitrary Python code
- **Encoding**: Assumes UTF-8 compatible text input
- **Line Endings**: Normalizes different line ending formats (`\r\n`, `\r`, `\n`)

### üîß Potential Improvements

- **Error Reporting**: Consider returning parsing errors instead of silently failing
- **Validation**: Add schema validation for expected metadata fields
- **Performance**: For large documents, consider lazy parsing approaches
- **Configuration**: Allow customization of regex patterns and parsing behavior

### üìù Best Practices

- Use YAML front matter for complex metadata structures
- Use MultiMarkdown format for simple key-value pairs
- Keep metadata at the document beginning
- Use consistent indentation (4 spaces) for multi-line values

This module provides a robust foundation for extracting structured metadata from plain text documents while maintaining compatibility with popular Markdown processors.