<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# MultiMarkdown Meta-Data Parser

## Overview

This Python module extracts, parses, and transforms MultiMarkdown style metadata from text documents. It supports two metadata formats:
- **YAML front matter** (delimited by `---` and `---` or `...`)
- **MultiMarkdown style** key-value pairs at the beginning of documents

## Purpose

The module is designed to separate document content from metadata, making it useful for:
- Static site generators
- Documentation processors
- Content management systems
- Markdown processors that need to handle metadata

## Dependencies

- `re` - Regular expression operations
- `typing` - Type hints
- `yaml` - YAML parsing (with optional C extension for performance)

## Core Functionality

### Main Function

#### `get_data(doc: str) -> tuple[str, dict[str, Any]]`

Extracts metadata from a text document and returns the cleaned document content along with parsed metadata.

**Parameters:**
- `doc`: Input document as a string

**Returns:**
- Tuple containing:
  - Cleaned document content (with metadata removed)
  - Dictionary of extracted metadata

**Processing Logic:**
1. First attempts to parse YAML front matter
2. Falls back to MultiMarkdown style metadata if no YAML is found
3. Returns empty metadata dict if parsing fails

### Regular Expressions

The module uses three compiled regex patterns:

```python
# YAML front matter detection
YAML_RE = re.compile(r'^-{3}[ \t]*\n(.*?\n)(?:\.{3}|-{3})[ \t]*\n', re.UNICODE | re.DOTALL)

# MultiMarkdown key-value pairs
META_RE = re.compile(r'^[ ]{0,3}(?P<key>[A-Za-z0-9_-]+):\s*(?P<value>.*)')

# Continuation lines for MultiMarkdown
META_MORE_RE = re.compile(r'^([ ]{4}|\t)(\s*)(?P<value>.*)')
```

## Supported Formats

### YAML Front Matter

```yaml
---
title: My Document
author: John Doe
tags: [python, markdown]
---

Document content starts here...
```

### MultiMarkdown Style

```
Title: My Document
Author: John Doe
Tags: python, markdown

Document content starts here...
```

## Usage Examples

```python
from meta_data_parser import get_data

# YAML front matter example
yaml_doc = """---
title: Sample Document
author: John Doe
---

# Main Content
This is the document body."""

content, metadata = get_data(yaml_doc)
print(metadata)  # {'title': 'Sample Document', 'author': 'John Doe'}

# MultiMarkdown style example
mmd_doc = """Title: Sample Document
Author: John Doe

# Main Content
This is the document body."""

content, metadata = get_data(mmd_doc)
print(metadata)  # {'title': 'Sample Document', 'author': 'John Doe'}
```

## Technical Notes

### Performance Optimization
- Uses `CSafeLoader` from PyYAML's C extension when available
- Falls back to pure Python `SafeLoader` if C extension is unavailable

### Error Handling
- YAML parsing errors are caught and ignored, falling back to MultiMarkdown parsing
- Invalid metadata doesn't crash the parser; it returns empty metadata instead

### Key Processing
- MultiMarkdown keys are converted to lowercase
- Keys can contain letters, numbers, underscores, and hyphens
- Duplicate keys have their values concatenated with spaces

## Suggestions and Considerations

### Potential Improvements
- Add support for custom metadata delimiters
- Implement validation for metadata schemas
- Add option to preserve original key casing
- Consider adding support for nested metadata structures in MultiMarkdown format

### Usage Tips
- Always check if metadata dict is empty before processing
- Be aware that MultiMarkdown values are concatenated as strings
- YAML front matter provides more flexible data types than MultiMarkdown style
- The function modifies line endings to ensure consistent parsing across platforms

### License
This code is licensed under a BSD 3-Clause License. See the copyright notice at the top of the file for full license terms.