<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# Python Handler Documentation

## Overview

This module implements a Python language handler for the `mkdocstrings` documentation generation tool. It provides automatic documentation generation for Python code by analyzing source files and generating formatted documentation pages.

## Purpose

The Python handler serves as a bridge between Python source code and documentation generation. It:

- **Analyzes Python modules** using the Griffe library to extract code structure and docstrings
- **Generates HTML documentation** from Python code using Jinja2 templates
- **Handles cross-references** between different parts of the documentation
- **Manages inventories** for linking to external documentation
- **Supports multiple docstring formats** (Google, NumPy, Sphinx, etc.)

## Main Classes

### `PythonHandler`

The core handler class that extends `BaseHandler` and manages the entire documentation generation process.

#### Key Attributes

```python
name: ClassVar[str] = "python"           # Handler identifier
domain: ClassVar[str] = "py"             # Cross-documentation domain
enable_inventory: ClassVar[bool] = True   # Enables Sphinx inventory creation
fallback_theme: ClassVar[str] = "material" # Default theme
```

#### Constructor

```python
def __init__(self, config: PythonConfig, base_dir: Path, **kwargs: Any) -> None:
```

**Parameters:**
- `config`: Handler configuration containing paths, options, and inventories
- `base_dir`: Base directory of the documentation project
- `**kwargs`: Additional arguments passed to parent constructor

## Important Methods

### Collection Methods

#### `collect(identifier: str, options: PythonOptions) -> CollectorItem`

Collects documentation data for a specific Python object.

**Process:**
1. Determines the module name from the identifier
2. Loads the module using Griffe if not already loaded
3. Resolves aliases and cross-references
4. Returns the collected documentation object

**Parameters:**
- `identifier`: Python object path (e.g., `"mymodule.MyClass.method"`)
- `options`: Collection options including docstring style and parsing options

### Rendering Methods

#### `render(data: CollectorItem, options: PythonOptions) -> str`

Renders collected data into HTML documentation.

**Process:**
1. Selects appropriate Jinja2 template based on object type
2. Renders template with configuration and data
3. Returns formatted HTML string

#### `update_env(config: Any) -> None`

Configures the Jinja2 environment with custom filters and functions:

- `split_path`: Splits object paths for navigation
- `crossref`: Creates cross-references between objects  
- `format_code`: Formats code snippets with syntax highlighting
- `format_signature`: Formats function/method signatures
- `order_members`: Orders class members by type and name

### Inventory Methods

#### `get_inventory_urls() -> list[tuple[str, dict[str, Any]]]`

Returns URLs of external inventory files to download for cross-referencing.

#### `load_inventory(in_file: BinaryIO, url: str, ...) -> Iterator[tuple[str, str]]`

Parses Sphinx inventory files and yields item identifiers with their URLs.

### Utility Methods

#### `get_aliases(identifier: str) -> tuple[str, ...]`

Returns all possible aliases for a given identifier, useful for cross-referencing.

#### `normalize_extension_paths(extensions: Sequence) -> Sequence`

Resolves extension file paths relative to the configuration file location.

## Configuration

The handler uses `PythonConfig` and `PythonOptions` for configuration:

### Key Configuration Options

- **`paths`**: List of directories to search for Python modules
- **`docstring_style`**: Docstring parsing style (google, numpy, sphinx, etc.)
- **`allow_inspection`**: Whether to allow runtime inspection of modules
- **`extensions`**: List of Griffe extensions to load
- **`inventories`**: External documentation inventories to link to

## Usage Example

```python
# In mkdocs.yml
plugins:
  - mkdocstrings:
      handlers:
        python:
          paths: [src]
          options:
            docstring_style: google
            show_source: true
            show_root_heading: true
```

## Key Dependencies

- **Griffe**: Core library for Python code analysis and AST processing
- **Jinja2**: Template engine for rendering HTML documentation
- **MkDocs**: Static site generator integration

## Notes and Considerations

### Deprecation Warnings

- The module includes compatibility code for Python 3.10 and older
- Some configuration options are deprecated and will be removed in future versions
- The `import` configuration key has been renamed to `inventories`

### Path Resolution

The handler automatically:
- Expands glob patterns in path configurations
- Resolves relative paths against the base directory
- Manages Python module search paths

### Error Handling

- **`CollectionError`**: Raised when objects cannot be found or imported
- **`PluginError`**: Raised for invalid configuration options
- **`AliasResolutionError`**: Raised when cross-references cannot be resolved

### Performance Considerations

- Modules are loaded only once and cached for subsequent requests
- Alias resolution is performed globally to optimize cross-references
- Template selection is optimized based on object types

## Entry Point

The `get_handler()` function serves as the main entry point for creating handler instances:

```python
def get_handler(
    handler_config: MutableMapping[str, Any],
    tool_config: MkDocsConfig,
    **kwargs: Any,
) -> PythonHandler:
```

This function processes configuration, handles backwards compatibility, and returns a configured `PythonHandler` instance.