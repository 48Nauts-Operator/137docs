<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# Packaging Tags Module Documentation

This module provides functionality for generating and parsing platform compatibility tags for Python packages, particularly for wheel distributions. It determines which Python implementations, ABIs, and platforms a package is compatible with.

## Purpose

The module serves as a core component for Python packaging systems to:
- Generate appropriate tags for wheel files based on the current system
- Parse existing tags to determine package compatibility
- Support multiple Python implementations (CPython, PyPy, etc.)
- Handle platform-specific compatibility across different operating systems

## Key Classes

### `Tag`

A representation of a wheel's tag triple consisting of interpreter-abi-platform.

```python
tag = Tag("cp39", "cp39", "linux_x86_64")
print(tag)  # cp39-cp39-linux_x86_64
```

**Properties:**
- `interpreter`: The Python interpreter (e.g., "cp39", "pp38")
- `abi`: Application Binary Interface (e.g., "cp39", "abi3", "none")
- `platform`: Target platform (e.g., "linux_x86_64", "win_amd64")

**Features:**
- Immutable and hashable for use in sets
- Pre-computed hash values for performance optimization
- String representation in standard format

## Important Functions

### Tag Generation Functions

#### `sys_tags(*, warn: bool = False) -> Iterator[Tag]`

Returns all compatible tags for the current Python interpreter in priority order.

```python
for tag in sys_tags():
    print(tag)
# Output: cp39-cp39-linux_x86_64, cp39-abi3-linux_x86_64, etc.
```

#### `cpython_tags(python_version, abis, platforms, *, warn: bool = False) -> Iterator[Tag]`

Generates tags specifically for CPython interpreters, including:
- Standard CPython tags (`cp<version>-<abi>-<platform>`)
- ABI3 stable ABI tags for Python 3.2+
- Generic compatibility tags

#### `generic_tags(interpreter, abis, platforms, *, warn: bool = False) -> Iterator[Tag]`

Generates tags for non-CPython interpreters (PyPy, Jython, etc.).

#### `compatible_tags(python_version, interpreter, platforms) -> Iterator[Tag]`

Generates backward-compatible tags using the `py*-none-*` format.

### Platform Detection Functions

#### `platform_tags() -> Iterator[str]`

Auto-detects the current platform and returns appropriate platform tags.

```python
for platform in platform_tags():
    print(platform)
# On Linux: linux_x86_64, manylinux1_x86_64, etc.
```

#### Platform-Specific Functions

- **`mac_platforms(version, arch) -> Iterator[str]`**: macOS platform tags
- **`ios_platforms(version, multiarch) -> Iterator[str]`**: iOS platform tags  
- **`android_platforms(api_level, abi) -> Iterator[str]`**: Android platform tags
- **`_linux_platforms(is_32bit) -> Iterator[str]`**: Linux platform tags including manylinux/musllinux

### Utility Functions

#### `parse_tag(tag: str) -> frozenset[Tag]`

Parses a tag string into Tag objects, handling compressed tag sets.

```python
tags = parse_tag("py2.py3-none-any")
# Returns multiple Tag objects for py2 and py3
```

#### `interpreter_name() -> str`

Returns the current interpreter's short name (e.g., "cp" for CPython, "pp" for PyPy).

#### `interpreter_version(*, warn: bool = False) -> str`

Returns the interpreter version without dots (e.g., "39" for Python 3.9).

## Important Constants

```python
INTERPRETER_SHORT_NAMES = {
    "python": "py",
    "cpython": "cp", 
    "pypy": "pp",
    "ironpython": "ip",
    "jython": "jy",
}
```

## Usage Examples

### Basic Tag Generation

```python
# Get all compatible tags for current system
tags = list(sys_tags())
print(f"Primary tag: {tags[0]}")

# Generate tags for specific CPython version
cpython_tags_list = list(cpython_tags(
    python_version=(3, 9),
    platforms=["linux_x86_64"]
))
```

### Platform Detection

```python
# Get current platform tags
current_platforms = list(platform_tags())

# Get macOS tags for specific version
macos_tags = list(mac_platforms(version=(10, 15), arch="x86_64"))
```

## Notes and Considerations

### Performance Optimizations
- The `Tag` class pre-computes hash values to optimize set operations
- Platform detection functions are cached where appropriate

### Threading Support
- Supports detection of threaded CPython builds (`--disable-gil`)
- Threading affects ABI3 compatibility determination

### Compatibility
- Handles ABI3 stable ABI for Python 3.2+
- Supports legacy Python versions and their specific ABI requirements
- Includes manylinux and musllinux compatibility for Linux systems

### Error Handling
- Uses logging for debugging configuration issues
- Graceful fallbacks when system information is unavailable
- Validation for required parameters on non-native platforms

### Dependencies
- Imports `_manylinux` and `_musllinux` modules for Linux platform detection
- Relies on `sysconfig` and `platform` modules for system information

This module is essential for Python packaging tools and should be used whenever you need to determine package compatibility across different Python environments and platforms.