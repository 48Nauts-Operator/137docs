<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# Python Packaging Tags Module

This module provides functionality for generating and parsing Python packaging tags used in wheel files and package distribution. It determines compatibility between packages and Python interpreters by analyzing interpreter versions, ABIs, and platform specifications.

## Purpose

The module serves as a core component for Python package management tools, helping to:
- Generate appropriate tags for wheel files
- Determine package compatibility across different Python implementations
- Handle platform-specific packaging requirements
- Support multiple Python interpreters (CPython, PyPy, etc.)

## Key Classes

### `Tag`

Represents a tag triple for a wheel package consisting of interpreter, ABI, and platform components.

```python
class Tag:
    def __init__(self, interpreter: str, abi: str, platform: str) -> None:
        # Creates a tag with normalized lowercase values
```

**Key Features:**
- Immutable and hashable for use in sets
- Pre-computed hash for performance optimization
- String representation: `{interpreter}-{abi}-{platform}`

**Properties:**
- `interpreter`: Python interpreter identifier (e.g., "cp39", "pp38")
- `abi`: Application Binary Interface tag (e.g., "cp39m", "abi3", "none")
- `platform`: Platform identifier (e.g., "linux_x86_64", "win_amd64")

## Important Functions

### Tag Generation Functions

#### `cpython_tags(python_version, abis, platforms, *, warn=False)`

Generates tags specifically for CPython interpreter.

```python
# Example usage
tags = list(cpython_tags(python_version=(3, 9)))
# Yields tags like: cp39-cp39-linux_x86_64, cp39-abi3-linux_x86_64, etc.
```

**Tag Priority Order:**
1. `cp<version>-<specific_abi>-<platform>`
2. `cp<version>-abi3-<platform>` (if applicable)
3. `cp<version>-none-<platform>`
4. Backward compatible abi3 tags for older versions

#### `generic_tags(interpreter, abis, platforms, *, warn=False)`

Generates tags for non-CPython interpreters (PyPy, Jython, etc.).

#### `compatible_tags(python_version, interpreter, platforms)`

Generates compatibility tags using the generic "py" interpreter.

```python
# Example output
# py39-none-linux_x86_64, py3-none-linux_x86_64, py39-none-any
```

### Platform-Specific Functions

#### `mac_platforms(version, arch)`

Generates macOS platform tags with version compatibility.

```python
# Example: macOS 11.0 on ARM64
list(mac_platforms((11, 0), "arm64"))
# Returns: ['macosx_11_0_arm64', 'macosx_11_0_universal2', ...]
```

#### `ios_platforms(version, multiarch)`

Generates iOS platform tags (Python 3.13+).

#### `android_platforms(api_level, abi)`

Generates Android platform tags.

#### `platform_tags()`

Auto-detects current platform and returns appropriate tags.

### Utility Functions

#### `parse_tag(tag)`

Parses compressed tag strings into Tag objects.

```python
tags = parse_tag("cp39.cp310-cp39.cp310-linux_x86_64.macosx_10_9_x86_64")
# Returns frozenset of all combinations
```

#### `sys_tags(*, warn=False)`

**Most Important Function** - Returns all compatible tags for the current Python installation in priority order.

```python
current_tags = list(sys_tags())
# Returns comprehensive list starting with most specific tags
```

## Configuration and Detection

### Interpreter Detection

```python
INTERPRETER_SHORT_NAMES = {
    "python": "py",
    "cpython": "cp", 
    "pypy": "pp",
    "ironpython": "ip",
    "jython": "jy",
}
```

### ABI Detection

The module automatically detects:
- Debug builds (`d` flag)
- Threading/GIL-disabled builds (`t` flag) 
- PyMalloc usage (`m` flag)
- UCS-4 Unicode (`u` flag)

## Usage Examples

### Basic Tag Generation

```python
from packaging import tags

# Get all compatible tags for current system
all_tags = list(tags.sys_tags())

# Get CPython-specific tags
cpython_tags = list(tags.cpython_tags())

# Parse a tag string
parsed = tags.parse_tag("cp39-cp39-linux_x86_64")
```

### Platform-Specific Usage

```python
# macOS tags
mac_tags = list(tags.mac_platforms((10, 15), "x86_64"))

# Current platform tags
platform_tags = list(tags.platform_tags())
```

## Notes and Considerations

### Performance Optimizations
- `Tag` class pre-computes hash values for faster set operations
- Extensive use of generators to avoid memory overhead

### Compatibility Handling
- Supports abi3 stable ABI for forward compatibility
- Handles platform-specific binary format compatibility (e.g., macOS universal binaries)
- Manages version-specific feature detection

### Platform Support
- **Linux**: Includes manylinux and musllinux compatibility
- **macOS**: Handles version transitions (10.x â†’ 11.x) and universal binaries
- **Windows**: Supports architecture-specific tags
- **Mobile**: iOS and Android support (newer Python versions)

### Warnings
- Set `warn=True` in functions to get debug logging for missing configuration variables
- Some features require specific Python versions (e.g., iOS support needs 3.13+)

This module is essential for any tool that needs to determine Python package compatibility and is used extensively by pip, build tools, and package indexes.