<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# Package Name and Filename Utilities

This module provides utilities for working with Python package names and distribution filenames. It handles canonicalization, validation, and parsing of package names, versions, and distribution files (wheels and source distributions).

## Purpose

The module serves several key functions:
- **Name normalization**: Convert package names to their canonical form according to PEP 503
- **Version canonicalization**: Standardize version strings per PEP 625
- **Filename parsing**: Extract metadata from wheel and source distribution filenames
- **Validation**: Ensure names and filenames conform to Python packaging standards

## Type Definitions

```python
BuildTag = Union[Tuple[()], Tuple[int, str]]
NormalizedName = NewType("NormalizedName", str)
```

- `BuildTag`: Represents wheel build tags - either empty or containing build number and string
- `NormalizedName`: Type-safe wrapper for normalized package names

## Exception Classes

### `InvalidName`
Raised when a distribution name doesn't conform to the packaging standards.

### `InvalidWheelFilename` 
Raised when a wheel filename violates PEP 427 specifications.

### `InvalidSdistFilename`
Raised when a source distribution filename is malformed.

## Core Functions

### `canonicalize_name(name: str, *, validate: bool = False) -> NormalizedName`

Converts a package name to its canonical form according to PEP 503.

**Parameters:**
- `name`: The package name to canonicalize
- `validate`: If True, validates the name format before canonicalizing

**Returns:** Normalized package name with standardized separators and lowercase

**Example:**
```python
canonicalize_name("My_Package.Name")  # Returns: "my-package-name"
```

### `is_normalized_name(name: str) -> bool`

Checks if a package name is already in normalized form.

**Parameters:**
- `name`: Package name to check

**Returns:** True if the name is normalized, False otherwise

### `canonicalize_version(version: Version | str, *, strip_trailing_zero: bool = True) -> str`

Returns the canonical form of a version string per PEP 625.

**Parameters:**
- `version`: Version object or string to canonicalize
- `strip_trailing_zero`: Whether to remove trailing zeros (default: True)

**Returns:** Canonical version string

**Examples:**
```python
canonicalize_version('1.0.1')  # Returns: '1.0.1'
canonicalize_version('1.0.0')  # Returns: '1'
canonicalize_version('1.0.0', strip_trailing_zero=False)  # Returns: '1.0.0'
```

### `parse_wheel_filename(filename: str) -> tuple[NormalizedName, Version, BuildTag, frozenset[Tag]]`

Parses a wheel filename and extracts its components according to PEP 427.

**Parameters:**
- `filename`: Wheel filename to parse (must end with `.whl`)

**Returns:** Tuple containing:
- Normalized package name
- Version object
- Build tag (empty tuple if no build number)
- Set of compatibility tags

**Raises:** `InvalidWheelFilename` if the filename format is invalid

### `parse_sdist_filename(filename: str) -> tuple[NormalizedName, Version]`

Parses a source distribution filename and extracts package name and version.

**Parameters:**
- `filename`: Source distribution filename (`.tar.gz` or `.zip`)

**Returns:** Tuple containing normalized package name and version object

**Raises:** `InvalidSdistFilename` if the filename format is invalid

## Implementation Notes

### Regular Expressions
The module uses several compiled regex patterns for efficiency:
- `_validate_regex`: Validates package name format
- `_canonicalize_regex`: Finds characters to replace during canonicalization
- `_normalized_regex`: Checks if a name is already normalized
- `_build_tag_regex`: Parses build numbers from wheel filenames

### Wheel Filename Format
Wheel filenames must follow this structure:
```
{distribution}-{version}(-{build tag})?-{python tag}-{abi tag}-{platform tag}.whl
```

### Source Distribution Format
Source distribution filenames follow:
```
{distribution}-{version}.tar.gz
{distribution}-{version}.zip
```

## Usage Recommendations

- Always use `canonicalize_name()` when comparing package names
- Use `validate=True` parameter when processing user input
- Handle `InvalidVersion` exceptions when parsing filenames from untrusted sources
- Consider using `strip_trailing_zero=False` when exact version preservation is required

## Dependencies

This module depends on:
- `.tags` module for tag parsing functionality
- `.version` module for version handling classes