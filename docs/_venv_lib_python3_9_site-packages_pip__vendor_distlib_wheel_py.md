<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# Wheel Module Documentation

## Overview

This module provides comprehensive support for building, installing, mounting, and verifying Python Wheel files according to PEP 427. It's part of the `distlib` package and handles the complete lifecycle of wheel files.

## Purpose

The module enables:
- **Building** wheel files from source distributions
- **Installing** wheel files to target directories
- **Mounting** wheels directly on sys.path for import
- **Verifying** wheel integrity and compatibility
- **Updating** existing wheel contents

## Key Components

### Constants and Configuration

```python
# Python implementation prefixes
IMP_PREFIX = 'cp'  # CPython, 'pp' for PyPy, 'jy' for Jython, 'ip' for IronPython
PYVER = 'py39'     # Python version string
IMPVER = 'cp39'    # Implementation + version
ARCH = 'win_amd64' # Platform architecture
ABI = 'cp39'       # Application Binary Interface
```

### Regular Expressions

- **`FILENAME_RE`**: Parses wheel filename components (name, version, build, python version, ABI, architecture)
- **`NAME_VERSION_RE`**: Extracts name and version from simple filenames
- **`SHEBANG_RE`**: Handles script shebang processing

## Main Classes

### `Wheel` Class

The primary class for wheel operations.

#### Constructor

```python
def __init__(self, filename=None, sign=False, verify=False):
```

- **`filename`**: Path to wheel file or None for new wheel
- **`sign`**: Enable digital signing (not fully implemented)
- **`verify`**: Enable verification during operations

#### Key Properties

- **`filename`**: Auto-generated wheel filename based on components
- **`exists`**: Boolean indicating if wheel file exists
- **`tags`**: Generator yielding (python_version, abi, architecture) tuples
- **`metadata`**: Cached wheel metadata object
- **`info`**: Cached wheel info dictionary

#### Important Methods

##### `build(paths, tags=None, wheel_version=None)`

Builds a wheel from files in specified paths.

```python
paths = {
    'purelib': '/path/to/site-packages',
    'scripts': '/path/to/scripts',
    'data': '/path/to/data'
}
wheel_path = wheel.build(paths)
```

**Parameters:**
- `paths`: Dictionary mapping path types to directories
- `tags`: Optional dictionary specifying python version, ABI, architecture
- `wheel_version`: Wheel format version tuple

**Returns:** Path to created wheel file

##### `install(paths, maker, **kwargs)`

Installs wheel contents to specified paths.

```python
installed_dist = wheel.install(paths, script_maker, lib_only=False)
```

**Parameters:**
- `paths`: Dictionary of installation paths (purelib, platlib, scripts, etc.)
- `maker`: Script maker instance for generating entry point scripts
- `lib_only`: If True, only install library files
- `warner`: Callable for version warnings
- `bytecode_hashed_invalidation`: Enable PEP-552 bytecode invalidation

**Returns:** `InstalledDistribution` instance or None if `lib_only=True`

##### `mount(append=False)` / `unmount()`

Mount/unmount wheel on sys.path for direct importing.

```python
wheel.mount()        # Add to beginning of sys.path
wheel.mount(True)    # Append to sys.path
wheel.unmount()      # Remove from sys.path
```

##### `verify()`

Verifies wheel integrity by checking file sizes and hashes.

```python
try:
    wheel.verify()
    print("Wheel is valid")
except DistlibException as e:
    print(f"Wheel verification failed: {e}")
```

##### `is_compatible()`

Checks if wheel is compatible with current Python environment.

```python
if wheel.is_compatible():
    wheel.install(paths, maker)
```

### `Mounter` Class

Handles mounting of wheels with binary extensions.

```python
class Mounter(object):
    def add(self, pathname, extensions)     # Add wheel with extensions
    def remove(self, pathname)             # Remove mounted wheel
    def find_module(self, fullname, path)  # Module finder interface
    def load_module(self, fullname)        # Module loader interface
```

## Utility Functions

### `compatible_tags()`

Returns set of (python_version, abi, architecture) tuples compatible with current Python.

```python
tags = compatible_tags()
# Returns: {('cp39', 'cp39', 'win_amd64'), ('py3', 'none', 'any'), ...}
```

### `is_compatible(wheel, tags=None)`

Checks wheel compatibility against provided or system tags.

```python
if is_compatible('my_package-1.0-py3-none-any.whl'):
    print("Compatible with this Python")
```

## Usage Examples

### Building a Wheel

```python
from distlib.wheel import Wheel

wheel = Wheel()
wheel.name = 'mypackage'
wheel.version = '1.0.0'

paths = {
    'purelib': 'build/lib',
    'scripts': 'build/scripts'
}

wheel_file = wheel.build(paths)
print(f"Built wheel: {wheel_file}")
```

### Installing a Wheel

```python
from distlib.wheel import Wheel
from distlib.scripts import ScriptMaker

wheel = Wheel('mypackage-1.0.0-py3-none-any.whl')
maker = ScriptMaker(None, None)

paths = {
    'purelib': '/usr/local/lib/python3.9/site-packages',
    'scripts': '/usr/local/bin'
}

dist = wheel.install(paths, maker)
print(f"Installed: {dist}")
```

### Mounting a Wheel

```python
wheel = Wheel('mypackage-1.0.0-py3-none-any.whl')
if wheel.is_compatible():
    wheel.mount()