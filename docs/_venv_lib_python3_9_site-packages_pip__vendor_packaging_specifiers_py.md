<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# packaging.specifiers Module Documentation

## Overview

This module provides classes and utilities for handling version specifiers in Python packaging. It implements PEP 440 version specifier semantics, allowing you to define version constraints (like `>=1.2.3`, `!=2.0.*`) and check if versions satisfy those constraints.

## Purpose

The module enables:
- Parsing and validating version specifiers
- Checking if versions match given specifiers
- Filtering collections of versions based on specifier constraints
- Handling prerelease version logic according to PEP 440

## Key Classes

### `InvalidSpecifier`

```python
class InvalidSpecifier(ValueError)
```

**Purpose**: Exception raised when attempting to create a specifier with invalid syntax.

**Example**:
```python
try:
    Specifier("invalid_spec")
except InvalidSpecifier as e:
    print(f"Invalid specifier: {e}")
```

### `BaseSpecifier`

```python
class BaseSpecifier(metaclass=abc.ABCMeta)
```

**Purpose**: Abstract base class defining the interface for all specifier classes.

**Key Methods**:
- `contains(item, prereleases=None)` - Check if a version satisfies the specifier
- `filter(iterable, prereleases=None)` - Filter versions that match the specifier
- `prereleases` property - Control prerelease version handling

### `Specifier`

```python
class Specifier(BaseSpecifier)
```

**Purpose**: Represents a single version specifier (e.g., `>=1.2.3`, `!=2.0.*`).

#### Constructor

```python
def __init__(self, spec: str = "", prereleases: bool | None = None)
```

**Parameters**:
- `spec`: Version specifier string
- `prereleases`: Whether to accept prerelease versions

#### Supported Operators

| Operator | Name | Description |
|----------|------|-------------|
| `~=` | Compatible release | `~=1.4.2` matches `>=1.4.2, ==1.4.*` |
| `==` | Equal | Exact version match (supports wildcards) |
| `!=` | Not equal | Exclude specific versions |
| `<=` | Less than or equal | |
| `>=` | Greater than or equal | |
| `<` | Less than | |
| `>` | Greater than | |
| `===` | Arbitrary equality | Exact string match |

#### Key Properties

```python
@property
def operator(self) -> str:
    """The operator of this specifier ('>=', '==', etc.)"""

@property  
def version(self) -> str:
    """The version string of this specifier"""

@property
def prereleases(self) -> bool:
    """Whether prereleases are allowed"""
```

#### Usage Examples

```python
# Basic usage
spec = Specifier(">=1.2.3")
print("1.3.0" in spec)  # True
print("1.1.0" in spec)  # False

# With prereleases
spec = Specifier(">=1.2.3", prereleases=True)
print("1.3.0a1" in spec)  # True

# Wildcard matching
spec = Specifier("==1.2.*")
print("1.2.5" in spec)  # True
print("1.3.0" in spec)  # False
```

### `SpecifierSet`

```python
class SpecifierSet(BaseSpecifier)
```

**Purpose**: Represents a set of version specifiers combined with logical AND (e.g., `>=1.0.0,!=1.0.1`).

#### Constructor

```python
def __init__(self, specifiers: str | Iterable[Specifier] = "", prereleases: bool | None = None)
```

**Parameters**:
- `specifiers`: Comma-separated specifier string or iterable of `Specifier` objects
- `prereleases`: Whether to accept prerelease versions

#### Key Methods

```python
def contains(self, item: UnparsedVersion, prereleases: bool | None = None, installed: bool | None = None) -> bool:
    """Check if a version satisfies ALL specifiers in the set"""

def filter(self, iterable: Iterable[UnparsedVersionVar], prereleases: bool | None = None) -> Iterator[UnparsedVersionVar]:
    """Filter versions that match ALL specifiers in the set"""

def __and__(self, other: SpecifierSet | str) -> SpecifierSet:
    """Combine two specifier sets"""
```

#### Usage Examples

```python
# Multiple constraints
spec_set = SpecifierSet(">=1.0.0,!=1.0.1,<2.0.0")
print("1.5.0" in spec_set)  # True
print("1.0.1" in spec_set)  # False

# Combining specifier sets
spec1 = SpecifierSet(">=1.0.0")
spec2 = SpecifierSet("!=1.0.1")
combined = spec1 & spec2  # >=1.0.0,!=1.0.1

# Filtering versions
versions = ["0.9.0", "1.0.0", "1.0.1", "1.5.0", "2.0.0"]
matching = list(spec_set.filter(versions))
# Returns: ["1.0.0", "1.5.0"]
```

## Utility Functions

### `_coerce_version(version: UnparsedVersion) -> Version`
Converts string versions to `Version` objects.

### Version String Utilities
- `_version_split(version: str) -> list[str]` - Split version into components
- `_version_join(components: list[str]) -> str` - Join components back into version string
- `_pad_version(left, right)` - Pad versions for comparison

## Important Notes

### Prerelease Handling
- By default, prereleases are only included if no stable versions match
- Can be explicitly controlled via the `prereleases` parameter
- Follows PEP 440 semantics for prerelease inclusion

### Performance Considerations