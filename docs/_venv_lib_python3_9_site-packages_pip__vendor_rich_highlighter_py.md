<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# Highlighter Module Documentation

## Overview

This module provides a collection of text highlighter classes for applying syntax highlighting and visual formatting to various types of text content. It's part of a rich text rendering system that uses regular expressions to identify and style different text patterns.

## Purpose

The module enables automatic highlighting of:
- Python `repr()` output with colors for different data types
- JSON strings with proper syntax coloring
- ISO8601 date/time formats
- General text patterns using regular expressions

## Core Classes

### `Highlighter` (Abstract Base Class)

The base class for all highlighters that defines the common interface.

```python
class Highlighter(ABC):
    def __call__(self, text: Union[str, Text]) -> Text
    def highlight(self, text: Text) -> None  # Abstract method
```

**Key Features:**
- Can be called directly with string or Text objects
- Returns a new Text instance with highlighting applied
- Automatically handles type conversion from strings to Text objects

### `NullHighlighter`

A no-op highlighter that applies no formatting.

```python
class NullHighlighter(Highlighter):
    def highlight(self, text: Text) -> None
```

**Use Case:** Disable highlighting entirely while maintaining the same interface.

### `RegexHighlighter`

Base class for regex-based highlighting with configurable patterns.

```python
class RegexHighlighter(Highlighter):
    highlights: List[str] = []  # List of regex patterns
    base_style: str = ""        # Base style prefix
```

**Features:**
- Uses regular expressions with named groups for pattern matching
- Applies styles based on the `base_style` prefix
- Extensible through subclassing

### `ReprHighlighter`

Specialized highlighter for Python `repr()` output.

```python
class ReprHighlighter(RegexHighlighter):
    base_style = "repr."
```

**Highlights:**
- **HTML-like tags:** `<tag_name>content</tag_name>`
- **Attributes:** `name="value"` patterns
- **Brackets and braces:** `[]`, `{}`, `()`
- **Network addresses:** IPv4, IPv6, MAC addresses (EUI-48/EUI-64)
- **UUIDs:** Standard UUID format
- **Python literals:**
  - Booleans: `True`, `False`
  - None: `None`
  - Numbers: integers, floats, complex, hex
  - Strings: various quote styles including multiline
- **File paths:** Unix-style paths with filenames
- **URLs:** HTTP, HTTPS, WebSocket protocols
- **Function calls:** `function_name(` patterns
- **Ellipsis:** `...`

### `JSONHighlighter`

Specialized highlighter for JSON content.

```python
class JSONHighlighter(RegexHighlighter):
    base_style = "json."
```

**Highlights:**
- **Structural elements:** `{}`, `[]`, `()`
- **Boolean values:** `true`, `false`
- **Null values:** `null`
- **Numbers:** integers, floats, scientific notation
- **Strings:** JSON string format with escape handling
- **Keys:** Special highlighting for JSON object keys

**Special Feature:** Implements custom logic to distinguish between JSON keys and values by detecting the `:` separator.

### `ISO8601Highlighter`

Specialized highlighter for ISO8601 date/time formats.

```python
class ISO8601Highlighter(RegexHighlighter):
    base_style = "iso8601."
```

**Supported Formats:**
- **Calendar dates:** `2008-08-30`, `20080830`
- **Calendar months:** `2008-08`
- **Ordinal dates:** `2008-243`
- **Week dates:** `2008-W35`, `2008-W35-6`
- **Times:** `17:21`, `17:21:59`, `172159`
- **Time zones:** `Z`, `+07:00`, `+0700`
- **Combined date/time:** `2008-08-30T17:21:59Z`
- **XML Schema variants:** With optional fractional seconds

## Utility Functions

### `_combine_regex(*regexes: str) -> str`

Combines multiple regex patterns using the OR operator (`|`).

```python
combined = _combine_regex(r"\d+", r"[a-z]+", r"[A-Z]+")
# Returns: r"\d+|[a-z]+|[A-Z]+"
```

## Usage Examples

```python
from highlighter import ReprHighlighter, JSONHighlighter

# Highlight Python repr output
repr_highlighter = ReprHighlighter()
highlighted_text = repr_highlighter("{'name': 'John', 'age': 30}")

# Highlight JSON
json_highlighter = JSONHighlighter()
highlighted_json = json_highlighter('{"name": "John", "age": 30}')

# Disable highlighting
from highlighter import NullHighlighter
no_highlight = NullHighlighter()
plain_text = no_highlight("This text won't be highlighted")
```

## Notes and Suggestions

### Performance Considerations
- Regular expressions are compiled and cached for efficiency
- Complex patterns (especially in `ReprHighlighter`) may impact performance on large texts
- Consider using `NullHighlighter` in performance-critical scenarios where highlighting isn't needed

### Extensibility
- Create custom highlighters by subclassing `RegexHighlighter`
- Define your own `highlights` list and `base_style`
- Use named groups in regex patterns for specific styling

### Style Configuration
- The actual colors/styles are determined by the style system (not shown in this module)
- Style names follow a hierarchical pattern: `{base_style}.{group_name}`
- Examples: `repr.number`, `json.key`, `iso8601.date`

### Regex Pattern Guidelines
- Use named groups `(?P<name>pattern)` for styling specific matches
- Avoid overly greedy patterns that might match unintended content
- Test complex patterns thoroughly with edge cases

## Dependencies

- `re`: Python's regular expression module
- `abc`: Abstract base classes
- `typing`: Type hints
- `.text`: Local module providing `Span` and `Text`