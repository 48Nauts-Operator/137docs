<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# LiveRender Module Documentation

## Overview

This module implements the `LiveRender` class, which provides functionality for creating and updating renderable content in real-time within a terminal or console application. It's designed to work with the Rich library's rendering system and allows for dynamic content updates with proper cursor positioning and screen clearing.

## Purpose

The primary purpose of this module is to:
- Create renderable objects that can be updated dynamically
- Handle cursor positioning for live updates
- Manage vertical overflow when content exceeds available space
- Provide clean restoration of the terminal state

## Key Components

### Type Definitions

```python
VerticalOverflowMethod = Literal["crop", "ellipsis", "visible"]
```

Defines the three methods for handling content that exceeds the vertical space:
- **`crop`**: Truncates content at the height limit
- **`ellipsis`**: Shows "..." to indicate truncated content
- **`visible`**: Allows content to overflow (default behavior)

### LiveRender Class

The main class that encapsulates live rendering functionality.

#### Constructor

```python
def __init__(
    self,
    renderable: RenderableType,
    style: StyleType = "",
    vertical_overflow: VerticalOverflowMethod = "ellipsis",
) -> None:
```

**Parameters:**
- `renderable`: Any object that can be rendered (text, widgets, etc.)
- `style`: Optional styling to apply to the renderable
- `vertical_overflow`: How to handle content that exceeds vertical space

#### Key Methods

##### `set_renderable(renderable: RenderableType)`
Updates the renderable content with a new object.

##### `position_cursor() -> Control`
Returns control codes to move the cursor to the beginning of the live render area. This is essential for updating content in place.

##### `restore_cursor() -> Control`
Returns control codes to clear the rendered content and restore the cursor to its original position, effectively "cleaning up" the live render.

##### `__rich_console__(console: Console, options: ConsoleOptions) -> RenderResult`
The core rendering method that:
- Renders the current content
- Handles vertical overflow according to the specified method
- Tracks the shape (width, height) of the rendered content
- Yields segments for display

## Usage Example

```python
from rich.live_render import LiveRender
from rich.text import Text

# Create a live render with some initial content
live = LiveRender(Text("Initial content"))

# Update the content
live.set_renderable(Text("Updated content"))

# Position cursor for in-place update
print(live.position_cursor(), end="")

# Restore cursor when done
print(live.restore_cursor(), end="")
```

## Important Notes

### Compatibility
- Uses `typing.Literal` for Python 3.8+ or falls back to `typing_extensions` for older versions
- Handles version compatibility gracefully with pragma coverage exclusion

### Vertical Overflow Handling
- **Crop mode**: Simply cuts off content at the height limit
- **Ellipsis mode**: Reserves one line for "..." indicator and uses `live.ellipsis` style
- **Visible mode**: Allows content to exceed bounds (may cause display issues)

### Shape Tracking
The `_shape` attribute stores the dimensions of the last rendered content, which is crucial for:
- Proper cursor positioning
- Accurate screen clearing
- Overflow calculations

## Dependencies

This module depends on several Rich library components:
- `Console` and `ConsoleOptions` for rendering context
- `Control` and `ControlType` for terminal control sequences
- `Segment` for render output management
- `Text` for overflow text rendering
- `loop_last` utility for iteration

## Suggestions for Use

1. **Always restore cursor**: When using `LiveRender` in applications, ensure you call `restore_cursor()` to clean up the terminal state
2. **Handle exceptions**: Wrap live rendering in try-finally blocks to ensure cleanup
3. **Consider performance**: Frequent updates may cause flickering; consider update throttling for smooth animations
4. **Test overflow behavior**: Different overflow methods may work better depending on your content type and use case