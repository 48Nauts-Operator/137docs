<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# AppDirs - Application Directory Utilities

## Overview

This module provides utilities for determining application-specific directories across different operating systems (Windows, macOS, and Unix-like systems). It follows platform-specific conventions and standards to help applications store data, configuration files, cache, logs, and other files in appropriate locations.

## Purpose

The primary purpose of this module is to:
- Provide cross-platform directory path resolution for applications
- Follow OS-specific standards (XDG spec for Unix, Apple guidelines for macOS, MSDN recommendations for Windows)
- Handle different types of application data (user data, system data, config, cache, logs, state)
- Support both user-specific and system-wide directory locations

## Version Information

- **Version**: 1.4.3
- **Copyright**: ActiveState Software Inc. (2005-2010), Eddy Petrișor (2013)

## Core Functions

### User-Specific Directory Functions

#### `user_data_dir(appname=None, appauthor=None, version=None, roaming=False)`

Returns the full path to user-specific data directory for the application.

**Parameters:**
- `appname`: Application name
- `appauthor`: Application author/company (Windows only)
- `version`: Optional version string to append
- `roaming`: Use roaming profile on Windows (default: False)

**Example paths:**
- **macOS**: `~/Library/Application Support/<AppName>`
- **Unix**: `~/.local/share/<AppName>`
- **Windows**: `C:\Users\<username>\AppData\Local\<AppAuthor>\<AppName>`

#### `user_config_dir(appname=None, appauthor=None, version=None, roaming=False)`

Returns the user-specific configuration directory.

**Example paths:**
- **macOS**: Same as `user_data_dir`
- **Unix**: `~/.config/<AppName>`
- **Windows**: Same as `user_data_dir`

#### `user_cache_dir(appname=None, appauthor=None, version=None, opinion=True)`

Returns the user-specific cache directory.

**Parameters:**
- `opinion`: Whether to append "Cache" to Windows paths (default: True)

**Example paths:**
- **macOS**: `~/Library/Caches/<AppName>`
- **Unix**: `~/.cache/<AppName>`
- **Windows**: `...\<AppAuthor>\<AppName>\Cache`

#### `user_state_dir(appname=None, appauthor=None, version=None, roaming=False)`

Returns the user-specific state directory (for runtime state data).

**Example paths:**
- **macOS**: Same as `user_data_dir`
- **Unix**: `~/.local/state/<AppName>`
- **Windows**: Same as `user_data_dir`

#### `user_log_dir(appname=None, appauthor=None, version=None, opinion=True)`

Returns the user-specific log directory.

**Example paths:**
- **macOS**: `~/Library/Logs/<AppName>`
- **Unix**: `~/.cache/<AppName>/log`
- **Windows**: `...\<AppAuthor>\<AppName>\Logs`

### System-Wide Directory Functions

#### `site_data_dir(appname=None, appauthor=None, version=None, multipath=False)`

Returns system-wide data directory.

**Parameters:**
- `multipath`: Return all XDG data directories on Unix (default: False)

**Example paths:**
- **macOS**: `/Library/Application Support/<AppName>`
- **Unix**: `/usr/local/share/<AppName>` or `/usr/share/<AppName>`
- **Windows**: `C:\ProgramData\<AppAuthor>\<AppName>`

#### `site_config_dir(appname=None, appauthor=None, version=None, multipath=False)`

Returns system-wide configuration directory.

**Example paths:**
- **macOS**: Same as `site_data_dir`
- **Unix**: `/etc/xdg/<AppName>`
- **Windows**: Same as `site_data_dir`

## Classes

### `AppDirs`

A convenience wrapper class that provides property-based access to all directory functions.

```python
class AppDirs(object):
    def __init__(self, appname=None, appauthor=None, version=None,
                 roaming=False, multipath=False):
        # Initialize with application parameters
```

**Properties:**
- `user_data_dir`
- `user_config_dir`
- `user_cache_dir`
- `user_state_dir`
- `user_log_dir`
- `site_data_dir`
- `site_config_dir`

**Example Usage:**
```python
dirs = AppDirs("MyApp", "MyCompany", version="1.0")
print(dirs.user_data_dir)
print(dirs.user_config_dir)
```

## Platform Support

### Cross-Platform Detection
- Handles standard Python platforms (`win32`, `darwin`, Unix-like)
- Special handling for Jython environments
- Graceful fallbacks for different Windows API access methods

### Windows Folder Access Methods
The module attempts multiple methods to access Windows system folders:
1. **pywin32** (`_get_win_folder_with_pywin32`)
2. **ctypes** (`_get_win_folder_with_ctypes`)
3. **JNA** (for Jython) (`_get_win_folder_with_jna`)
4. **Registry fallback** (`_get_win_folder_from_registry`)

## Important Notes and Warnings

### ⚠️ Windows Vista/7+ Warning
**Do not use `site_data_dir` or `site_config_dir` on Windows Vista and later.** The `C:\ProgramData` directory is hidden and may cause issues.

### XDG Compliance
On Unix-like systems, the module follows the [XDG Base Directory Specification](http://standards.freedesktop.org/basedir-spec/basedir-spec-latest.html) and respects environment variables:
- `XDG_DATA_HOME`
- `XDG_CONFIG_HOME`
- `XDG_CACHE_HOME`
- `XDG_STATE_