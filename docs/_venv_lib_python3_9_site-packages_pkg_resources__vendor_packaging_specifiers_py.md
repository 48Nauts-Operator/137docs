<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# Python Package Version Specifiers Documentation

This module provides functionality for parsing, validating, and working with version specifiers according to PEP 440 (Python's versioning standard). It allows you to define version constraints like `>=1.2.0,<2.0.0` and check whether specific versions satisfy those constraints.

## Purpose

The module enables:
- Parsing version specifiers (e.g., `>=1.2.0`, `~=2.1`, `==1.0.*`)
- Checking if a version satisfies given constraints
- Filtering collections of versions based on specifiers
- Handling both modern PEP 440 compliant versions and legacy versions
- Managing prerelease version inclusion/exclusion

## Core Classes

### `BaseSpecifier`

Abstract base class that defines the interface for all specifier types.

**Key Methods:**
- `contains(item, prereleases=None)` - Check if a version satisfies the specifier
- `filter(iterable, prereleases=None)` - Filter versions from an iterable
- `prereleases` - Property controlling prerelease handling

### `Specifier`

Main class for PEP 440 compliant version specifiers.

**Supported Operators:**
- `~=` - Compatible release (e.g., `~=1.4.2` matches `>=1.4.2, ==1.4.*`)
- `==` - Exact match (supports wildcards like `1.4.*`)
- `!=` - Not equal
- `<=`, `>=`, `<`, `>` - Comparison operators
- `===` - Arbitrary equality (exact string match)

**Example Usage:**
```python
# Create a specifier
spec = Specifier(">=1.2.0")

# Check if a version satisfies it
spec.contains("1.3.0")  # True
spec.contains("1.1.0")  # False

# Filter a list of versions
versions = ["1.0.0", "1.2.0", "1.3.0", "2.0.0"]
list(spec.filter(versions))  # ["1.2.0", "1.3.0", "2.0.0"]
```

### `LegacySpecifier`

Handles older, non-PEP 440 compliant version formats for backward compatibility.

**Supported Operators:**
- `==`, `!=`, `<=`, `>=`, `<`, `>`

### `SpecifierSet`

Container for multiple specifiers that must all be satisfied (logical AND).

**Example Usage:**
```python
# Create a set of specifiers
spec_set = SpecifierSet(">=1.2.0,<2.0.0,!=1.5.0")

# Check if a version satisfies all specifiers
spec_set.contains("1.3.0")  # True
spec_set.contains("1.5.0")  # False (excluded)
spec_set.contains("2.0.0")  # False (too high)

# Combine specifier sets
other_set = SpecifierSet("!=1.4.0")
combined = spec_set & other_set  # Logical AND
```

## Key Features

### Prerelease Handling

The module provides sophisticated prerelease handling:

```python
spec = Specifier(">=1.0.0")

# By default, prereleases are excluded
spec.contains("1.1.0a1")  # False

# Enable prerelease inclusion
spec.prereleases = True
spec.contains("1.1.0a1")  # True

# Or specify per-call
spec.contains("1.1.0a1", prereleases=True)  # True
```

### Wildcard Matching

Supports prefix matching with wildcards:

```python
spec = Specifier("==1.4.*")
spec.contains("1.4.0")   # True
spec.contains("1.4.2")   # True
spec.contains("1.5.0")   # False
```

### Compatible Release Operator

The `~=` operator provides semantic "compatible release" matching:

```python
spec = Specifier("~=1.4.2")
# Equivalent to: >=1.4.2, ==1.4.*
spec.contains("1.4.2")   # True
spec.contains("1.4.10")  # True
spec.contains("1.5.0")   # False
```

## Utility Functions

### `_version_split(version)`

Splits version strings for comparison, handling pre-release segments.

### `_pad_version(left, right)`

Normalizes version segment lists to the same length for comparison.

## Exception Classes

### `InvalidSpecifier`

Raised when a specifier string cannot be parsed:

```python
try:
    spec = Specifier("invalid>>1.0")
except InvalidSpecifier as e:
    print(f"Invalid specifier: {e}")
```

## Important Notes

- **PEP 440 Compliance**: The `Specifier` class follows PEP 440 standards strictly
- **Legacy Support**: `LegacySpecifier` handles older version formats
- **Performance**: Uses compiled regex patterns for efficient parsing
- **Immutability**: Specifier objects are designed to be immutable after creation
- **Local Versions**: Local version identifiers (e.g., `1.0+local`) are handled according to PEP 440 rules

## Best Practices

1. **Use SpecifierSet for multiple constraints:**
   ```python
   # Good
   spec_set = SpecifierSet(">=1.0.0,<2.0.0")
   
   # Less efficient
   spec1 = Specifier(">=1.0.0")
   spec2 = Specifier("<2.0.0")
   ```

2. **Be explicit about prerelease handling:**
   ```python
   spec = Specifier(">=1.0.0", prereleases=True)
   ```

3. **Handle InvalidSpecifier exceptions:**
   ```python
   try:
       spec = Specifier(user_input)
   except InvalidSpecifier:
       # Handle invalid input gracefully
       pass
   ```

4. **Use contains() for single version checks, filter() for collections:**