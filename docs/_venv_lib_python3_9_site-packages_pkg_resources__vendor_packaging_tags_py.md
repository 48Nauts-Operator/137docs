<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# Python Wheel Tags Module Documentation

## Overview

This module provides functionality for generating and parsing wheel compatibility tags for Python packages. It determines which Python wheel files are compatible with the current system by analyzing interpreter type, ABI (Application Binary Interface), and platform information.

## Purpose

The primary purpose of this module is to:
- Generate compatibility tags for Python wheels based on the current system
- Parse existing wheel tags to determine compatibility
- Support multiple Python interpreters (CPython, PyPy, Jython, etc.)
- Handle platform-specific compatibility (Linux, macOS, Windows)
- Manage ABI compatibility across different Python versions

## Key Classes

### `Tag`

Represents a wheel compatibility tag triple consisting of interpreter, ABI, and platform.

```python
tag = Tag("cp39", "cp39", "linux_x86_64")
print(tag)  # cp39-cp39-linux_x86_64
```

**Properties:**
- `interpreter`: The Python interpreter identifier
- `abi`: The Application Binary Interface identifier  
- `platform`: The platform identifier

**Features:**
- Immutable and hashable
- Supports equality comparison
- String representation in format: `{interpreter}-{abi}-{platform}`

## Important Functions

### Tag Generation Functions

#### `cpython_tags(python_version=None, abis=None, platforms=None, **kwargs)`

Generates tags specifically for CPython interpreter.

```python
# Generate CPython tags for current system
for tag in cpython_tags():
    print(tag)
```

**Yields tags in priority order:**
- `cp<version>-<abi>-<platform>`
- `cp<version>-abi3-<platform>` (for stable ABI)
- `cp<version>-none-<platform>`
- Backward compatible abi3 tags for older versions

#### `generic_tags(interpreter=None, abis=None, platforms=None, **kwargs)`

Generates tags for non-CPython interpreters (PyPy, Jython, etc.).

#### `compatible_tags(python_version=None, interpreter=None, platforms=None)`

Generates broadly compatible tags using the `py*` interpreter prefix.

```python
# Generate compatible tags
for tag in compatible_tags():
    print(tag)  # py39-none-linux_x86_64, py3-none-any, etc.
```

#### `sys_tags(**kwargs)`

**Primary function** - Returns all tags for the current system in priority order.

```python
# Get all compatible tags for current system
for tag in sys_tags():
    print(tag)
```

### Parsing Functions

#### `parse_tag(tag)`

Parses a tag string into a frozenset of Tag instances.

```python
tags = parse_tag("cp39.cp38-none-linux_x86_64.win32")
# Returns frozenset of all combinations
```

### Platform Detection Functions

#### `mac_platforms(version=None, arch=None)`

Generates macOS platform tags with version compatibility.

#### `interpreter_name()`

Returns the short name of the current Python interpreter.

```python
name = interpreter_name()  # "cp" for CPython, "pp" for PyPy
```

#### `interpreter_version(**kwargs)`

Returns the version string for the current interpreter.

## Platform-Specific Features

### Linux Support
- **manylinux compatibility**: Supports manylinux1, manylinux2010, manylinux2014
- **Architecture detection**: Uses ELF header parsing for accurate architecture detection
- **glibc version checking**: Determines glibc compatibility for manylinux tags

### macOS Support
- **Universal binaries**: Supports fat32, fat64, intel, universal formats
- **Version compatibility**: Generates tags for compatible macOS versions
- **Architecture handling**: Supports x86_64, i386, ppc, ppc64 architectures

### Windows Support
- **32/64-bit detection**: Automatically handles architecture differences
- **Debug builds**: Detects debug Python installations

## Usage Examples

### Basic Usage

```python
# Get all tags for current system
tags = list(sys_tags())
print(f"Found {len(tags)} compatible tags")

# Parse a wheel filename tag
wheel_tags = parse_tag("cp39-cp39-linux_x86_64")
print(f"Parsed {len(wheel_tags)} tag combinations")
```

### Custom Tag Generation

```python
# Generate tags for specific Python version
custom_tags = list(cpython_tags(
    python_version=(3, 9),
    platforms=["linux_x86_64", "win_amd64"]
))
```

## Important Notes

### Compatibility Considerations
- Tags are generated in **priority order** (most specific to most general)
- The module handles backward compatibility for older Python versions
- ABI3 (stable ABI) tags are supported for Python 3.2+

### Performance Notes
- ELF header parsing is only performed on Linux systems when needed
- Platform detection is cached where possible
- Tag generation is lazy (uses generators)

### Warnings
- Some functions accept a `warn` parameter for debugging configuration issues
- Missing system configuration variables will trigger debug warnings
- Invalid glibc version strings will raise RuntimeWarnings

## Dependencies

The module relies on several standard library modules:
- `platform`: For system information
- `sysconfig`: For Python configuration variables
- `distutils.util`: For platform detection
- `struct`: For ELF header parsing
- `sys`: For interpreter information

## Error Handling

The module includes robust error handling for:
- Missing or invalid system configuration
- Unsupported platforms or architectures  
- Malformed ELF headers on Linux systems
- Import errors for optional dependencies

This module is essential for Python package management tools like pip and build systems that need to determine wheel compatibility.