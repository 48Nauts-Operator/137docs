<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# Version Parsing Module

This Python module provides comprehensive version parsing and comparison functionality, supporting both **PEP 440 compliant versions** and **legacy version formats**. It's designed to handle Python package versioning with full compatibility for different version string formats.

## Purpose

The module serves as a robust version parsing library that can:
- Parse and validate version strings according to PEP 440 specification
- Handle legacy version formats for backward compatibility
- Provide proper version comparison and sorting capabilities
- Extract individual version components (major, minor, patch, pre-release, etc.)

## Key Functions

### `parse(version)`

```python
def parse(version):
    # type: (str) -> Union[LegacyVersion, Version]
```

**Main entry point** for parsing version strings.

- **Input**: Version string (e.g., "1.2.3", "2.0.0a1", "1.0.dev0")
- **Output**: Returns either a `Version` object (PEP 440 compliant) or `LegacyVersion` object
- **Behavior**: Attempts to parse as PEP 440 first, falls back to legacy format if parsing fails

**Example Usage:**
```python
v1 = parse("1.2.3")        # Returns Version object
v2 = parse("1.0-beta")     # Returns LegacyVersion object
```

## Main Classes

### `Version` Class

Handles **PEP 440 compliant** version strings with full feature support.

#### Key Properties:
- `epoch`: Version epoch (default: 0)
- `release`: Release numbers tuple (e.g., (1, 2, 3))
- `pre`: Pre-release identifier and number
- `post`: Post-release number
- `dev`: Development release number
- `local`: Local version identifier
- `major`, `minor`, `micro`: Individual release components
- `public`: Version without local component
- `base_version`: Core version without pre/post/dev/local
- `is_prerelease`, `is_postrelease`, `is_devrelease`: Boolean flags

#### Example:
```python
v = Version("1.2.3a1.post1.dev1+local.1")
print(v.major)          # 1
print(v.minor)          # 2  
print(v.pre)            # ('a', 1)
print(v.is_prerelease)  # True
```

### `LegacyVersion` Class

Handles **non-PEP 440** version strings for backward compatibility.

#### Key Features:
- Accepts any string as version
- Limited property support (most return `None`)
- Uses legacy comparison algorithm
- Always has epoch = -1 (sorts before PEP 440 versions)

#### Example:
```python
v = LegacyVersion("1.0-beta-2")
print(v.public)         # "1.0-beta-2"
print(v.epoch)          # -1
print(v.release)        # None
```

### `InvalidVersion` Exception

```python
class InvalidVersion(ValueError):
```

Raised when a version string cannot be parsed as a valid PEP 440 version.

## Important Constants

### `VERSION_PATTERN`

A comprehensive regex pattern that defines the PEP 440 version format:

```python
VERSION_PATTERN = r"""
    v?                                                    # optional 'v' prefix
    (?:
        (?:(?P<epoch>[0-9]+)!)?                          # epoch
        (?P<release>[0-9]+(?:\.[0-9]+)*)                 # release segment  
        (?P<pre>[-_\.]?(?P<pre_l>(a|b|c|rc|alpha|beta|pre|preview))[-_\.]?(?P<pre_n>[0-9]+)?)?  # pre-release
        (?P<post>(?:-(?P<post_n1>[0-9]+))|(?:[-_\.]?(?P<post_l>post|rev|r)[-_\.]?(?P<post_n2>[0-9]+)?))?  # post release
        (?P<dev>[-_\.]?(?P<dev_l>dev)[-_\.]?(?P<dev_n>[0-9]+)?)?  # dev release
    )
    (?:\+(?P<local>[a-z0-9]+(?:[-_\.][a-z0-9]+)*))?     # local version
"""
```

## Key Internal Functions

### `_parse_letter_version(letter, number)`
Normalizes pre-release, post-release, and dev-release identifiers.

### `_parse_local_version(local)`  
Parses local version components into a tuple of strings and integers.

### `_cmpkey(...)`
Generates comparison keys for proper version sorting according to PEP 440 rules.

### `_legacy_cmpkey(version)`
Generates comparison keys for legacy version formats.

## Usage Examples

```python
from packaging.version import parse, Version, InvalidVersion

# Basic parsing
v1 = parse("1.2.3")
v2 = parse("2.0.0a1") 
v3 = parse("1.0-legacy-format")

# Version comparison
print(v1 < v2)  # True
print(v2 > v1)  # True

# Access version components  
version = Version("2.1.0rc1.post1.dev1+ubuntu.1")
print(f"Major: {version.major}")           # Major: 2
print(f"Minor: {version.minor}")           # Minor: 1
print(f"Pre-release: {version.pre}")       # Pre-release: ('rc', 1)
print(f"Public: {version.public}")         # Public: 2.1.0rc1.post1.dev1
print(f"Base: {version.base_version}")     # Base: 2.1.0

# Error handling
try:
    invalid = Version("not.a.valid.version!")
except InvalidVersion as e:
    print(f"Invalid version: {e}")
```

## Notes and Suggestions

### ⚠️ Important Considerations