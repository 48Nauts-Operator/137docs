<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# Android Platform Directories Module

## Overview

This module provides Android-specific implementation for platform directories in Python applications. It implements directory path resolution for Android applications, following Android's file system conventions and storage guidelines.

## Purpose

The module serves as part of a cross-platform directory resolution system, specifically handling Android's unique file system structure and storage locations. It provides standardized access to various directory types (data, config, cache, etc.) for Android applications.

## Main Class

### `Android(PlatformDirsABC)`

The main class that implements platform-specific directory resolution for Android systems.

#### Key Features:
- Inherits from `PlatformDirsABC` to provide consistent API across platforms
- Uses Android-specific path patterns and conventions
- Supports both internal app storage and external storage directories
- Handles fallbacks when Android-specific libraries are unavailable

#### Directory Properties

##### Application Directories
- **`user_data_dir`**: Returns app data directory
  - Pattern: `/data/user/<userid>/<packagename>/files/<AppName>`
- **`user_config_dir`**: Returns app configuration directory  
  - Pattern: `/data/user/<userid>/<packagename>/shared_prefs/<AppName>`
- **`user_cache_dir`**: Returns app cache directory
  - Pattern: `/data/user/<userid>/<packagename>/cache/<AppName>`
- **`user_state_dir`**: Returns state directory (same as data dir on Android)
- **`user_log_dir`**: Returns log directory
  - Uses cache dir, with optional `/log` subdirectory if opinionated
- **`user_runtime_dir`**: Returns runtime directory
  - Uses cache dir, with optional `/tmp` subdirectory if opinionated

##### System Directories
- **`user_documents_dir`**: Documents folder (`/storage/emulated/0/Documents`)
- **`user_downloads_dir`**: Downloads folder (`/storage/emulated/0/Downloads`) 
- **`user_pictures_dir`**: Pictures folder (`/storage/emulated/0/Pictures`)
- **`user_videos_dir`**: Videos folder (`/storage/emulated/0/DCIM/Camera`)
- **`user_music_dir`**: Music folder (`/storage/emulated/0/Music`)
- **`user_desktop_dir`**: Desktop folder (`/storage/emulated/0/Desktop`)

##### Site Directories
All site directories return the same paths as their user counterparts, as Android doesn't distinguish between user and system-wide app data.

## Helper Functions

### `_android_folder()`
**Purpose**: Determines the base Android application folder path

**Implementation Strategy** (with fallbacks):
1. **python4android**: Uses `android.mActivity` to get application context
2. **pyjnius**: Uses `jnius.autoclass` to access Android Context
3. **sys.path parsing**: Searches for Android patterns in Python path
4. **Adopted storage**: Handles expanded storage mount points

**Returns**: Base app directory path or `None` if detection fails

### Media Directory Functions
The following functions retrieve Android system directories using similar fallback strategies:

- `_android_documents_folder()`
- `_android_downloads_folder()` 
- `_android_pictures_folder()`
- `_android_videos_folder()`
- `_android_music_folder()`

All use `@lru_cache(maxsize=1)` for performance optimization.

## Implementation Notes

### Key Features:
- **Robust Fallback System**: Multiple detection methods ensure compatibility across different Android Python environments
- **Caching**: Uses `@lru_cache` to avoid repeated expensive operations
- **Type Safety**: Includes proper type hints and TYPE_CHECKING guards
- **Error Handling**: Graceful degradation when Android libraries are unavailable

### Dependencies:
- **Optional**: `python4android` (android module)
- **Optional**: `pyjnius` (jnius module)
- **Fallback**: Pure Python regex-based path detection

### Compatibility:
- Works with different Android Python frameworks
- Handles both standard and adopted storage configurations
- Supports various Android application deployment scenarios

## Usage Example

```python
from platformdirs import Android

android_dirs = Android("MyApp", "1.0")

# Get application directories
data_dir = android_dirs.user_data_dir
cache_dir = android_dirs.user_cache_dir
config_dir = android_dirs.user_config_dir

# Get system directories  
documents_dir = android_dirs.user_documents_dir
downloads_dir = android_dirs.user_downloads_dir
```

## Notes and Considerations

- **Permissions**: Some directories may require specific Android permissions
- **Storage Access**: External storage directories may not be accessible without proper permissions
- **Fallback Reliability**: Path detection fallbacks work best for standard app installations
- **Performance**: Directory resolution is cached for efficiency