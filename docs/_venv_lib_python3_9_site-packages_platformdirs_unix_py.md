<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# Unix Platform Directories Implementation

## Overview

This file implements the `Unix` class, which provides platform-specific directory paths for Unix/Linux systems following the [XDG Base Directory Specification](https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html). It's part of a larger platform directories library that helps applications find appropriate locations for storing data, configuration files, cache, and other application-specific directories.

## Purpose

The `Unix` class provides a standardized way to:
- Locate user-specific and system-wide directories for data, configuration, cache, and runtime files
- Follow XDG Base Directory Specification standards
- Support environment variable overrides for custom directory locations
- Handle both single-path and multi-path directory scenarios

## Main Class

### `Unix(PlatformDirsABC)`

Inherits from `PlatformDirsABC` and implements Unix/Linux-specific directory resolution logic.

#### Key Properties

**User-Specific Directories:**
- `user_data_dir` - User data directory (`~/.local/share/$appname/$version` or `$XDG_DATA_HOME/$appname/$version`)
- `user_config_dir` - User configuration directory (`~/.config/$appname/$version` or `$XDG_CONFIG_HOME/$appname/$version`) 
- `user_cache_dir` - User cache directory (`~/.cache/$appname/$version` or `$XDG_CACHE_HOME/$appname/$version`)
- `user_state_dir` - User state directory (`~/.local/state/$appname/$version` or `$XDG_STATE_HOME/$appname/$version`)
- `user_log_dir` - User log directory (same as `user_state_dir` or `user_state_dir/log` if opinionated)
- `user_runtime_dir` - User runtime directory (`/run/user/$(id -u)/$appname/$version` or `$XDG_RUNTIME_DIR/$appname/$version`)

**System-Wide Directories:**
- `site_data_dir` - System data directories (`/usr/local/share/$appname/$version` or `/usr/share/$appname/$version`)
- `site_config_dir` - System configuration directories (`/etc/xdg/$appname/$version`)
- `site_cache_dir` - System cache directory (`/var/cache/$appname/$version`)
- `site_runtime_dir` - System runtime directory (`/run/$appname/$version`)

**User Media Directories:**
- `user_documents_dir` - Documents directory (`~/Documents`)
- `user_downloads_dir` - Downloads directory (`~/Downloads`)
- `user_pictures_dir` - Pictures directory (`~/Pictures`)
- `user_videos_dir` - Videos directory (`~/Videos`)
- `user_music_dir` - Music directory (`~/Music`)
- `user_desktop_dir` - Desktop directory (`~/Desktop`)

**Path Objects:**
- `site_data_path` - Returns first site data directory as `Path` object
- `site_config_path` - Returns first site config directory as `Path` object  
- `site_cache_path` - Returns first site cache directory as `Path` object

#### Iterator Methods

```python
def iter_config_dirs(self) -> Iterator[str]:
    """Yields all user and site configuration directories."""

def iter_data_dirs(self) -> Iterator[str]:
    """Yields all user and site data directories."""
```

## Utility Functions

### `_get_user_media_dir(env_var: str, fallback_tilde_path: str) -> str`

Retrieves user media directories by:
1. Checking user-dirs.dirs configuration file
2. Falling back to environment variable
3. Using default tilde path as final fallback

### `_get_user_dirs_folder(key: str) -> str | None`

Parses the XDG user-dirs.dirs configuration file to get custom user directory locations.

### `getuid() -> NoReturn`

Platform-specific function that raises an error on Windows systems, since Unix user ID functionality should only be used on Unix systems.

## Platform-Specific Behavior

### BSD Systems (FreeBSD/OpenBSD/NetBSD)
- Runtime directories use `/var/run/user/$(id -u)` or fallback to `/tmp/runtime-$(id -u)`
- Site runtime directory uses `/var/run` instead of `/run`

### Environment Variable Support

The implementation respects XDG environment variables:
- `XDG_DATA_HOME` / `XDG_DATA_DIRS`
- `XDG_CONFIG_HOME` / `XDG_CONFIG_DIRS` 
- `XDG_CACHE_HOME`
- `XDG_STATE_HOME`
- `XDG_RUNTIME_DIR`
- Media directories: `XDG_DOCUMENTS_DIR`, `XDG_DOWNLOAD_DIR`, etc.

## Notes and Considerations

- **Multi-path Support**: When `multipath` is enabled, site directories can return multiple paths separated by `os.pathsep`
- **Auto-creation**: Directories can be automatically created if `ensure_exists` is enabled
- **User-dirs.dirs**: Supports reading custom user directory locations from the XDG user-dirs configuration file
- **Security**: Uses appropriate permissions and follows XDG security guidelines for runtime directories
- **Fallback Logic**: Provides sensible defaults when environment variables are not set

## Usage Example

```python
from platformdirs import Unix

dirs = Unix("myapp", "1.0")
print(dirs.user_data_dir)    # ~/.local/share/myapp/1.0
print(dirs.user_config_dir)  # ~/.config/myapp/1.0
print(dirs.site_data_dir)    # /usr/local/share/myapp/1.0

# Iterate through all config directories
for config_dir in dirs.iter_config_dirs():
    print(config_dir)
```