<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# Arithmatex Extension Documentation

## Overview

The **Arithmatex** extension is a Python Markdown extension that preserves mathematical equations for use with MathJax or other math rendering libraries. It processes both inline and block mathematical expressions, converting them into appropriate HTML structures.

## Purpose

This extension enables the use of mathematical notation in Markdown documents by:
- Preserving LaTeX-style math expressions
- Converting equations to script tags for MathJax compatibility
- Supporting both inline and display equations
- Optionally generating math previews
- Providing configurable output formats

## Supported Math Syntax

### Inline Math
- `$Equation$` - Dollar-wrapped inline math
- `\(Equation\)` - Parentheses-wrapped inline math

### Block Math
- `$$Display Equations$$` - Dollar-wrapped display math
- `\[Display Equations\]` - Bracket-wrapped display math
- `\begin{align}Display Equations\end{align}` - Environment-based math

## Key Classes and Functions

### Core Classes

#### `ArithmatexExtension`
The main extension class that extends Python Markdown functionality.

**Configuration Options:**
- `tex_inline_wrap`: Wrapping text for inline content (default: `["\\(", "\\)"]`)
- `tex_block_wrap`: Wrapping text for block content (default: `["\\[", "\\]"]`)
- `smart_dollar`: Enable smart dollar processing (default: `True`)
- `block_syntax`: Enabled block syntaxes (default: `['dollar', 'square', 'begin']`)
- `inline_syntax`: Enabled inline syntaxes (default: `['dollar', 'round']`)
- `generic`: Output in generic format for non-MathJax libraries (default: `False`)
- `preview`: Insert previews for scripts (default: `True`)
- `block_tag`: Wrapper tag for blocks (default: `'div'`)
- `inline_tag`: Wrapper tag for inline (default: `'span'`)

#### `InlineArithmatexPattern`
Handles inline mathematical expressions within text.

```python
class InlineArithmatexPattern(InlineProcessor):
    def handleMatch(self, m, data):
        # Processes inline math patterns and converts to HTML elements
```

#### `BlockArithmatexProcessor`
Processes block-level mathematical expressions.

```python
class BlockArithmatexProcessor(BlockProcessor):
    def run(self, parent, blocks):
        # Finds and handles block math content
```

### Formatter Functions

#### Current Formatters
- `arithmatex_inline_format(**kwargs)`: Configurable inline formatter
- `arithmatex_fenced_format(**kwargs)`: Configurable fenced/block formatter

#### Deprecated Formatters
⚠️ **Note**: The following functions are deprecated and will be removed in future versions:
- `inline_mathjax_preview_format()`
- `inline_mathjax_format()`
- `inline_generic_format()`
- `fence_mathjax_preview_format()`
- `fence_mathjax_format()`
- `fence_generic_format()`

### Internal Helper Functions

#### `_escape(txt)`
Performs basic HTML escaping for mathematical content.

```python
def _escape(txt):
    """Basic html escaping."""
    txt = txt.replace('&', '&amp;')
    txt = txt.replace('<', '&lt;')
    txt = txt.replace('>', '&gt;')
    txt = txt.replace('"', '&quot;')
    return txt
```

## Usage Example

```python
import markdown
from pymdownx import arithmatex

# Basic usage
md = markdown.Markdown(extensions=['pymdownx.arithmatex'])

# With configuration
md = markdown.Markdown(
    extensions=['pymdownx.arithmatex'],
    extension_configs={
        'pymdownx.arithmatex': {
            'generic': True,
            'preview': False,
            'smart_dollar': True
        }
    }
)
```

## Regular Expressions

The extension uses several regex patterns to identify mathematical expressions:

- `RE_SMART_DOLLAR_INLINE`: Smart dollar inline patterns
- `RE_DOLLAR_INLINE`: Basic dollar inline patterns  
- `RE_BRACKET_INLINE`: Bracket inline patterns
- `RE_DOLLAR_BLOCK`: Dollar block patterns
- `RE_TEX_BLOCK`: TeX environment block patterns
- `RE_BRACKET_BLOCK`: Bracket block patterns

## Important Notes

### Migration from Deprecated Functions
- Replace deprecated formatter functions with the configurable `arithmatex_inline_format()` and `arithmatex_fenced_format()` functions
- Update extension configurations to use the new parameter system

### Smart Dollar Processing
When `smart_dollar` is enabled, the extension uses more sophisticated pattern matching to avoid conflicts with regular dollar signs in text.

### Output Modes
- **MathJax Mode**: Generates `<script>` tags with `type="math/tex"`
- **Generic Mode**: Wraps math in configurable delimiters for other math libraries

## License

This extension is released under the MIT License. See the file header for full license text.

## Dependencies

- `markdown`: Core Markdown library
- `xml.etree.ElementTree`: XML processing
- `re`: Regular expression support
- Internal `util` module for utility functions