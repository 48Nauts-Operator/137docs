<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# Emoji Extension Documentation

## Overview

The `pymdownx.emoji` module is a Markdown extension that adds emoji support for popular emoji libraries including EmojiOne, Gemoji (GitHub), and Twemoji. This extension converts emoji shortcodes (like `:smile:`) into HTML elements with configurable output formats.

## Purpose

- Convert emoji shortcodes to HTML elements (images, sprites, or Unicode characters)
- Support multiple emoji libraries and CDNs
- Provide flexible configuration options for different rendering styles
- Enable strict mode validation for emoji names

## Key Features

- **Multiple Emoji Libraries**: Support for EmojiOne, Gemoji, and Twemoji
- **Flexible Output**: PNG images, SVG images, sprites, or Unicode characters
- **CDN Integration**: Built-in CDN URLs for popular emoji services
- **Customizable Attributes**: Add custom CSS classes and HTML attributes
- **Strict Mode**: Validation to catch invalid emoji names

## Important Constants

```python
# Supported emoji libraries
SUPPORTED_INDEXES = ('emojione', 'gemoji', 'twemoji')

# CDN URLs for different emoji services
EMOJIONE_SVG_CDN = 'https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/'
TWEMOJI_SVG_CDN = 'https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/'
GITHUB_UNICODE_CDN = 'https://github.githubassets.com/images/icons/emoji/unicode/'
```

## Main Classes

### EmojiExtension

The main extension class that integrates with Python-Markdown.

**Configuration Options:**
- `emoji_index`: Function returning desired emoji index (default: `emojione`)
- `emoji_generator`: Method for generating emoji HTML (default: `to_png`)
- `title`: Title attribute style - 'long', 'short', or 'none'
- `alt`: Alt text format - 'unicode', 'short', or 'html_entity'
- `remove_variation_selector`: Remove Unicode variation selector 16
- `strict`: Enable strict mode validation
- `options`: Additional options dictionary

### EmojiPattern

Inline processor that handles emoji pattern matching and conversion.

**Key Methods:**
- `handleMatch()`: Processes matched emoji patterns
- `_get_unicode()`: Extracts Unicode values from emoji data
- `_get_title()`: Generates title attributes
- `_get_alt()`: Creates alt text

### EmojiAlertPostprocessor

Post-processor for strict mode validation that raises exceptions for invalid emoji names.

## Emoji Index Functions

### emojione(options, md)
Returns EmojiOne emoji database with names, emoji data, and aliases.

### gemoji(options, md)  
Returns GitHub's Gemoji database with names, emoji data, and aliases.

### twemoji(options, md)
Returns Twitter's Twemoji database with names, emoji data, and aliases.

## Generator Functions

### to_png()
Generates `<img>` elements pointing to PNG emoji images.

```python
# Example output
<img class="emojione" alt="ðŸ˜„" src="https://cdn.../1f604.png" title=":smile:">
```

### to_svg()
Generates `<img>` elements pointing to SVG emoji images.

### to_png_sprite()
Generates `<span>` elements with CSS classes for PNG sprites.

### to_svg_sprite()
Generates `<svg>` elements with sprite references.

### to_alt()
Returns raw Unicode characters or HTML entities.

## Usage Examples

### Basic Usage

```python
import markdown
from pymdownx import emoji

md = markdown.Markdown(extensions=['pymdownx.emoji'])
result = md.convert("Hello :smile: world!")
```

### Custom Configuration

```python
md = markdown.Markdown(
    extensions=['pymdownx.emoji'],
    extension_configs={
        'pymdownx.emoji': {
            'emoji_index': emoji.twemoji,
            'emoji_generator': emoji.to_svg,
            'title': 'long',
            'alt': 'unicode'
        }
    }
)
```

### With Custom Options

```python
extension_configs = {
    'pymdownx.emoji': {
        'options': {
            'classes': 'custom-emoji',
            'image_path': 'https://custom-cdn.com/emoji/',
            'attributes': {'loading': 'lazy'}
        }
    }
}
```

## Notes and Suggestions

### Performance Considerations
- Emoji databases are deep-copied for each index to prevent mutation
- Consider caching if processing large volumes of text

### Strict Mode
- Enable `strict: True` to catch typos in emoji names during development
- Raises `RuntimeError` with detailed error messages for invalid emoji

### Backwards Compatibility
- `add_attriubtes` function exists for backwards compatibility (note the typo)
- Legacy emoji index functions without arguments are deprecated

### CDN Considerations
- Built-in CDN URLs may become outdated
- Consider hosting emoji assets locally for production use
- Custom `image_path` option allows for flexible CDN configuration

### Unicode Handling
- `remove_variation_selector` option helps with Unicode compatibility
- Different emoji libraries may have varying Unicode support
- HTML entity encoding available for maximum compatibility

## Dependencies

- `markdown`: Core Markdown library
- `xml.etree.ElementTree`: For HTML element creation
- Local emoji database modules (`emoji1_db`, `gemoji_db`, `twemoji_db`)