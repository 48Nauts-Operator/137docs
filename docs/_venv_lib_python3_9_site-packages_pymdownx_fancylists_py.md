<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# Fancy Lists Extension for Python Markdown

## Overview

This module provides an extension for Python Markdown that implements "fancy" ordered lists in the style of Pandoc. It enhances the standard Markdown list functionality by adding support for various numbering systems including Roman numerals, alphabetical ordering, and custom styling options.

## Purpose

The extension allows users to create ordered lists with:
- Roman numerals (both upper and lowercase)
- Alphabetical ordering (both upper and lowercase) 
- Generic placeholders (`#`)
- Custom start values and styling
- Enhanced formatting control through CSS classes and inline styles

## Key Components

### Utility Functions

#### `roman2int(s)`
```python
def roman2int(s):
    """Convert Roman numeral to integer."""
```
- Converts Roman numeral strings to their integer equivalents
- **Note**: Values should be validated before conversion as no validation is performed during conversion
- Supports standard Roman numeral patterns

### Core Classes

#### `FancyOListProcessor(BlockProcessor)`
The main processor for fancy ordered lists.

**Key Features:**
- Supports multiple list numbering formats (decimal, Roman, alphabetical)
- Handles nested lists and proper indentation
- Maintains list continuity across blocks
- Configurable start values and styling injection

**Important Methods:**
- `test(parent, block)` - Tests if a block starts with a list
- `run(parent, blocks)` - Processes list items and creates the HTML structure
- `get_fancy_type(m, first, fancy_type)` - Determines the list type based on the marker
- `get_items(sibling, block, blocks)` - Breaks a block into individual list items

#### `FancyUListProcessor(FancyOListProcessor)`
Handles unordered lists, inheriting from the ordered list processor.

#### `FancyListBlock(Block)`
Provides block-level syntax for creating fancy lists with explicit configuration.

**Usage Example:**
```markdown
/// fancylists | type=I start=5
1. First item
2. Second item
///
```

**Supported Options:**
- `type`: List marker type (`1`, `a`, `A`, `i`, `I`)
- `start`: Starting number for the list

#### `FancyListTreeprocessor(Treeprocessor)`
Post-processes the document tree to clean up intermediate metadata.

### Extension Class

#### `FancyListExtension(BlocksExtension)`
Main extension class that registers all processors and handles configuration.

**Configuration Options:**
- `additional_ordered_styles`: List of additional formats to support (`['roman', 'alpha', 'generic']`)
- `inject_style`: Whether to inject CSS `style` attributes (`False`)
- `inject_class`: Whether to inject CSS classes for styling (`False`)

## Configuration

### Supported List Styles

| Type | Description | Example |
|------|-------------|---------|
| `decimal` | Standard numbers | 1, 2, 3... |
| `lower-alpha` | Lowercase letters | a, b, c... |
| `upper-alpha` | Uppercase letters | A, B, C... |
| `lower-roman` | Lowercase Roman | i, ii, iii... |
| `upper-roman` | Uppercase Roman | I, II, III... |

### CSS Integration

When enabled, the extension can inject:
- **Style attributes**: `style="list-style-type: lower-roman;"`
- **CSS classes**: `class="fancylists-lower-roman"`

## Usage Notes

### Important Considerations

⚠️ **Work in Progress**: The documentation notes this is "not fully tested" - use with caution in production environments.

### Roman Numeral Rules

The extension follows relaxed Roman numeral rules similar to Project Euler's conventions:
- Does not strictly enforce the "rule of 3" for repeated characters
- Allows some flexibility to prevent conflicts with alphabetical lists
- Supports complex Roman numeral patterns

### List Detection

The extension uses sophisticated regex patterns to detect and differentiate between:
- Different numbering systems
- Nested lists
- Mixed list types within the same document

## Example Usage

```python
import markdown
from fancy_lists import FancyListExtension

md = markdown.Markdown(
    extensions=[
        FancyListExtension(
            additional_ordered_styles=['roman', 'alpha'],
            inject_class=True
        )
    ]
)

# Convert Markdown with fancy lists
html = md.convert(markdown_text)
```

## Dependencies

- `markdown` - Python Markdown library
- `xml.etree.ElementTree` - XML processing
- `re` - Regular expressions for pattern matching

## Notes for Developers

- The extension heavily relies on regex patterns for list detection
- Roman numeral validation is minimal - consider adding more robust validation for production use
- The force mechanism allows continuation of existing list types
- Tree processing cleanup ensures no metadata leaks into final HTML output