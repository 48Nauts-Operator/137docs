<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# PathConverter Extension for Python Markdown

## Overview

The `pymdownx.pathconverter` module is a Python Markdown extension that automatically converts file paths in HTML tags to either relative or absolute paths. This is particularly useful for processing Markdown documents that need to have their asset references (images, scripts, stylesheets, etc.) converted to work properly in different deployment contexts.

## Purpose

This extension serves two main purposes:

1. **Convert relative paths to different relative paths**: Given a base path and a target relative path, convert file references to be relative to the new base
2. **Convert relative paths to absolute paths**: Given a base path, convert relative file references to absolute paths (optionally with `file://` scheme)

## Key Components

### Classes

#### `PathConverterExtension`

The main extension class that integrates with Python Markdown.

**Configuration Options:**
- `base_path` (str): Base path used to find files (default: "")
- `relative_path` (str): Target path for relative conversion (default: "")
- `absolute` (bool): Enable absolute path conversion (default: False)
- `tags` (str): Space-separated list of HTML tags to process (default: "img script a link")
- `file_scheme` (bool): Use `file://` scheme for absolute paths (default: False)

#### `PathConverterPostprocessor`

The post-processor that performs the actual path conversion by scanning the generated HTML.

### Key Functions

#### `repl_relative(m, base_path, relative_path)`

Converts paths to be relative to a specified target path.

```python
# Converts absolute or relative paths to be relative to relative_path
path = os.path.relpath(
    os.path.normpath(os.path.join(base_path, path)),
    os.path.normpath(relative_path)
)
```

#### `repl_absolute(m, base_path, file_scheme)`

Converts relative paths to absolute paths.

```python
# Converts relative paths to absolute
path = os.path.normpath(os.path.join(base_path, path))
```

#### `repl(m, base_path, rel_path=None, file_scheme=None)`

Main replacement function that delegates to either relative or absolute conversion based on parameters.

## Usage Examples

### Basic Usage

```python
import markdown

# For relative path conversion
md = markdown.Markdown(extensions=[
    'pymdownx.pathconverter'
], extension_configs={
    'pymdownx.pathconverter': {
        'base_path': '/path/to/source',
        'relative_path': '/path/to/target',
        'absolute': False
    }
})

# For absolute path conversion
md = markdown.Markdown(extensions=[
    'pymdownx.pathconverter'
], extension_configs={
    'pymdownx.pathconverter': {
        'base_path': '/path/to/source',
        'absolute': True,
        'file_scheme': True  # Optional: adds file:// prefix
    }
})
```

### Processed HTML Tags

The extension processes the following attributes in HTML tags:
- `href` attributes (in `<a>` and `<link>` tags)
- `src` attributes (in `<img>` and `<script>` tags)

## Important Notes

### Security Considerations
- The extension uses `os.path.join()` and `os.path.normpath()` for path manipulation
- URL parsing is handled safely with error handling to prevent crashes
- Script and style tag contents are avoided to prevent processing inline code

### Limitations
- Only processes relative paths that aren't already URLs (no scheme/netloc)
- Requires proper base path configuration to work correctly
- Path conversion failures are silently ignored (by design)

### Regular Expressions
The extension uses complex regex patterns to:
- Identify HTML tags while avoiding `<script>` and `<style>` content
- Extract and process `href` and `src` attributes specifically
- Handle various quote styles and whitespace patterns

## Error Handling

The extension includes robust error handling:
- Failed path parsing/conversion is silently ignored
- Invalid URLs or paths don't break the processing
- Malformed HTML attributes are left unchanged

## Dependencies

- `markdown`: Core Python Markdown library
- `urllib.parse`: For URL manipulation
- `os`: For path operations  
- `re`: For regular expression processing
- Local `util` module: For URL/path conversion utilities