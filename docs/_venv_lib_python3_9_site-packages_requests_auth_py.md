<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# requests.auth Module Documentation

## Overview

The `requests.auth` module provides authentication handlers for the Python Requests library. This module implements various HTTP authentication schemes that can be attached to HTTP requests to handle server authentication challenges.

## Purpose

This module enables automatic handling of HTTP authentication protocols, including:
- Basic Authentication (RFC 7617)
- Proxy Authentication 
- Digest Authentication (RFC 7616)

## Constants

```python
CONTENT_TYPE_FORM_URLENCODED = "application/x-www-form-urlencoded"
CONTENT_TYPE_MULTI_PART = "multipart/form-data"
```

Standard MIME type constants used for form data submissions.

## Functions

### `_basic_auth_str(username, password)`

**Purpose**: Creates a properly formatted Basic Authentication header string.

**Parameters**:
- `username`: Username for authentication
- `password`: Password for authentication

**Returns**: Base64-encoded Basic Auth header string

**Important Notes**:
- ‚ö†Ô∏è **Deprecation Warning**: Non-string username/password parameters will be removed in Requests 3.0.0
- Automatically handles string encoding to Latin-1
- Returns format: `"Basic <base64-encoded-credentials>"`

```python
# Example usage
auth_header = _basic_auth_str("user", "pass")
# Returns: "Basic dXNlcjpwYXNz"
```

## Classes

### `AuthBase`

**Purpose**: Abstract base class for all authentication implementations.

**Key Features**:
- Defines the interface that all auth handlers must implement
- Must be callable and accept a request object
- Raises `NotImplementedError` if `__call__` method is not overridden

### `HTTPBasicAuth(AuthBase)`

**Purpose**: Implements HTTP Basic Authentication (RFC 7617).

**Constructor**:
```python
HTTPBasicAuth(username, password)
```

**Key Methods**:
- `__call__(r)`: Adds `Authorization` header to the request
- `__eq__(other)`: Compares two auth objects for equality
- `__ne__(other)`: Inequality comparison

**Usage Example**:
```python
auth = HTTPBasicAuth('username', 'password')
# When applied to a request, adds header:
# Authorization: Basic <encoded-credentials>
```

### `HTTPProxyAuth(HTTPBasicAuth)`

**Purpose**: Implements HTTP Proxy Authentication using Basic Auth credentials.

**Key Differences from HTTPBasicAuth**:
- Uses `Proxy-Authorization` header instead of `Authorization`
- Inherits all other functionality from `HTTPBasicAuth`

**Usage Example**:
```python
proxy_auth = HTTPProxyAuth('proxy_user', 'proxy_pass')
# Adds header: Proxy-Authorization: Basic <encoded-credentials>
```

### `HTTPDigestAuth(AuthBase)`

**Purpose**: Implements HTTP Digest Authentication (RFC 7616) with advanced security features.

**Constructor**:
```python
HTTPDigestAuth(username, password)
```

**Key Features**:
- Thread-safe implementation using `threading.local()`
- Supports multiple hash algorithms: MD5, MD5-SESS, SHA, SHA-256, SHA-512
- Handles nonce counting and client nonce generation
- Automatic retry on 401 responses
- State management for authentication challenges

**Important Methods**:

#### `init_per_thread_state()`
Initializes thread-local storage for authentication state:
- `last_nonce`: Previous nonce value
- `nonce_count`: Counter for nonce reuse
- `chal`: Challenge parameters from server
- `pos`: File position for request body rewinding
- `num_401_calls`: Counter for authentication attempts

#### `build_digest_header(method, url)`
**Purpose**: Constructs the digest authentication header.

**Parameters**:
- `method`: HTTP method (GET, POST, etc.)
- `url`: Request URL

**Returns**: Formatted digest authentication header string

**Supported Algorithms**:
- MD5 (default)
- MD5-SESS
- SHA-1
- SHA-256  
- SHA-512

#### `handle_401(r, **kwargs)`
**Purpose**: Processes 401 Unauthorized responses and retries with authentication.

**Behavior**:
- Only processes 4xx status codes
- Limits retry attempts to prevent infinite loops
- Rewinds request body if needed for retransmission
- Extracts and parses authentication challenge from `www-authenticate` header

#### `handle_redirect(r, **kwargs)`
**Purpose**: Resets authentication attempt counter on redirects.

## Usage Examples

### Basic Authentication
```python
import requests
from requests.auth import HTTPBasicAuth

response = requests.get('https://api.example.com/data', 
                       auth=HTTPBasicAuth('username', 'password'))
```

### Digest Authentication
```python
import requests
from requests.auth import HTTPDigestAuth

response = requests.get('https://api.example.com/secure', 
                       auth=HTTPDigestAuth('username', 'password'))
```

### Proxy Authentication
```python
import requests
from requests.auth import HTTPProxyAuth

proxies = {'http': 'http://proxy.example.com:8080'}
response = requests.get('https://api.example.com/data',
                       auth=HTTPProxyAuth('proxy_user', 'proxy_pass'),
                       proxies=proxies)
```

## Security Notes

- ‚ö†Ô∏è **Basic Auth**: Credentials are only base64-encoded, not encrypted. Always use HTTPS.
- ‚úÖ **Digest Auth**: More secure as passwords are hashed, but still recommend HTTPS.
- üîí **Thread Safety**: `HTTPDigestAuth` uses thread-local storage for safe concurrent usage.

## Dependencies

- `hashlib`: For digest authentication hashing
- `threading`: For thread-local state management
- `base64`: For Basic Auth encoding
- `time`, `os`: For nonce generation in Digest Auth