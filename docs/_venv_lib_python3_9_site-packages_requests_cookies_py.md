<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# requests.cookies

## Overview

This module provides compatibility code to use `http.cookiejar.CookieJar` with the requests library. It contains wrapper classes and utility functions that bridge the gap between the standard library's cookie handling and requests' interface requirements.

## Purpose

- Enable seamless integration between `http.cookiejar.CookieJar` and requests
- Provide a dictionary-like interface for cookie operations
- Handle cookie extraction from HTTP responses
- Support cookie serialization and deserialization

## Important Classes

### MockRequest

Wraps a `requests.Request` object to mimic a `urllib2.Request` interface that `http.cookiejar.CookieJar` expects.

**Key Methods:**
- `get_type()` - Returns URL scheme
- `get_host()` - Returns URL netloc
- `get_full_url()` - Returns full URL with Host header handling
- `add_unredirected_header(name, value)` - Adds headers for cookie management

### MockResponse

Wraps HTTP headers to mimic a `urllib.addinfourl` interface for `http.cookiejar` compatibility.

**Key Methods:**
- `info()` - Returns headers object
- `getheaders(name)` - Gets headers by name

### RequestsCookieJar

The main cookie jar class that extends `http.cookiejar.CookieJar` with dictionary-like operations.

**Key Features:**
- Dictionary-style access (`jar['cookie_name']`)
- Domain and path-specific cookie operations
- Pickleable (unlike standard CookieJar)
- Multiple domain support

**Important Methods:**

```python
# Dictionary-like operations
jar.get(name, default=None, domain=None, path=None)
jar.set(name, value, **kwargs)
jar.keys()
jar.values()
jar.items()

# Utility methods
jar.list_domains()
jar.list_paths()
jar.get_dict(domain=None, path=None)
jar.multiple_domains()
```

### CookieConflictError

Exception raised when multiple cookies match the same criteria.

## Important Functions

### extract_cookies_to_jar(jar, request, response)

Extracts cookies from an HTTP response into a CookieJar.

```python
extract_cookies_to_jar(jar, request, response)
```

### get_cookie_header(jar, request)

Generates the appropriate `Cookie` header string for a request.

```python
cookie_header = get_cookie_header(jar, request)
```

### create_cookie(name, value, **kwargs)

Creates a cookie object from basic parameters.

```python
cookie = create_cookie('session_id', 'abc123', domain='example.com', path='/')
```

### cookiejar_from_dict(cookie_dict, cookiejar=None, overwrite=True)

Creates a CookieJar from a dictionary of key-value pairs.

```python
jar = cookiejar_from_dict({'session': 'value', 'user': 'john'})
```

### merge_cookies(cookiejar, cookies)

Merges cookies from a dictionary or another CookieJar into an existing CookieJar.

```python
merged_jar = merge_cookies(existing_jar, new_cookies)
```

## Usage Examples

### Basic Cookie Operations

```python
# Create a cookie jar
jar = RequestsCookieJar()

# Set cookies
jar.set('session_id', 'abc123')
jar['user_pref'] = 'dark_mode'

# Get cookies
session = jar.get('session_id')
user_pref = jar['user_pref']

# List all cookies
for name, value in jar.items():
    print(f"{name}: {value}")
```

### Domain-Specific Operations

```python
# Set cookies for specific domains
jar.set('token', 'xyz789', domain='api.example.com')
jar.set('theme', 'blue', domain='www.example.com')

# Get cookies by domain
api_dict = jar.get_dict(domain='api.example.com')
```

## Performance Notes

⚠️ **Warning**: Dictionary operations that are normally O(1) may be O(n) due to the underlying iteration through all cookies.

- `get()`, `__getitem__()` - O(n) operations
- Operations with domain/path filtering require full iteration

## Thread Safety

The module includes threading support with fallback to `dummy_threading` if the threading module is unavailable.

## Serialization Support

Unlike standard `CookieJar`, `RequestsCookieJar` is pickleable through custom `__getstate__()` and `__setstate__()` methods.

```python
import pickle

# Serialize
pickled_jar = pickle.dumps(jar)

# Deserialize  
restored_jar = pickle.loads(pickled_jar)
```

## Import Considerations

⚠️ **Note**: This module is imported by `requests.utils`, so be careful with circular imports when modifying.