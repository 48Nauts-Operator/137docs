<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# requests.models Documentation

## Overview

The `requests.models` module contains the primary objects that power the Requests library. This module defines the core classes for HTTP requests and responses, including data encoding, hook management, and response handling.

## Purpose

This module provides:
- **Request objects**: For creating and preparing HTTP requests
- **Response objects**: For handling HTTP responses 
- **Encoding utilities**: For handling parameter and file encoding
- **Hook system**: For registering callbacks during request processing

## Constants

### Redirect Configuration
```python
REDIRECT_STATI = (301, 302, 303, 307, 308)  # HTTP status codes for automatic redirects
DEFAULT_REDIRECT_LIMIT = 30                  # Maximum number of redirects to follow
```

### Chunk Sizes
```python
CONTENT_CHUNK_SIZE = 10 * 1024  # 10KB - Default chunk size for content reading
ITER_CHUNK_SIZE = 512           # 512 bytes - Default chunk size for line iteration
```

## Core Classes

### RequestEncodingMixin

A mixin class that provides encoding functionality for HTTP requests.

#### Key Methods

- **`path_url`** (property): Builds the path URL from the full URL
- **`_encode_params(data)`**: Encodes URL parameters from dict or list of tuples
- **`_encode_files(files, data)`**: Builds multipart/form-data body for file uploads

**Usage Notes:**
- Handles both dictionary and list-of-tuples parameter formats
- Supports 2-tuple (filename, fileobj), 3-tuple (with content-type), and 4-tuple (with custom headers) file formats
- Automatically handles UTF-8 encoding for string parameters

### RequestHooksMixin

A mixin class for managing request hooks (callbacks).

#### Key Methods

- **`register_hook(event, hook)`**: Register a callback for a specific event
- **`deregister_hook(event, hook)`**: Remove a previously registered hook

**Usage:**
```python
request.register_hook('response', my_callback_function)
```

### Request

A user-created request object used to prepare requests for transmission.

#### Constructor Parameters

- `method`: HTTP method (GET, POST, etc.)
- `url`: Target URL
- `headers`: Dictionary of HTTP headers
- `files`: Dictionary of files for multipart upload
- `data`: Request body data
- `json`: JSON data for request body
- `params`: URL parameters
- `auth`: Authentication handler or (user, pass) tuple
- `cookies`: Cookie dictionary or CookieJar
- `hooks`: Dictionary of callback hooks

#### Key Methods

- **`prepare()`**: Returns a `PreparedRequest` ready for transmission

**Example:**
```python
req = Request('GET', 'https://httpbin.org/get')
prepared = req.prepare()
```

### PreparedRequest

The fully prepared request object containing the exact bytes to be sent to the server.

#### Key Attributes

- `method`: HTTP verb
- `url`: Complete URL
- `headers`: HTTP headers dictionary
- `body`: Request body content
- `hooks`: Registered callback hooks

#### Key Methods

- **`prepare()`**: Prepares the entire request with given parameters
- **`copy()`**: Creates a copy of the prepared request
- **`prepare_method(method)`**: Prepares the HTTP method
- **`prepare_url(url, params)`**: Prepares and validates the URL
- **`prepare_headers(headers)`**: Prepares HTTP headers
- **`prepare_body(data, files, json)`**: Prepares the request body
- **`prepare_auth(auth, url)`**: Prepares authentication
- **`prepare_cookies(cookies)`**: Prepares cookie headers

**Important Notes:**
- Should not be instantiated manually - use `Request.prepare()` instead
- Handles IDNA encoding for international domain names
- Validates URLs and raises appropriate exceptions for invalid formats

### Response

The response object containing the server's response to an HTTP request.

#### Key Attributes

- `status_code`: HTTP status code (e.g., 200, 404)
- `headers`: Case-insensitive response headers
- `url`: Final URL after redirects
- `content`: Response content as bytes
- `text`: Response content as unicode string
- `encoding`: Character encoding for text decoding
- `cookies`: Response cookies
- `elapsed`: Time taken for the request
- `history`: List of redirect responses

#### Key Properties

- **`ok`**: Returns `True` if status code < 400
- **`is_redirect`**: Returns `True` if response is a redirect
- **`apparent_encoding`**: Detected encoding using chardet/charset_normalizer

#### Key Methods

- **`json(**kwargs)`**: Decodes JSON response content
- **`iter_content(chunk_size=1, decode_unicode=False)`**: Iterates over response data in chunks
- **`iter_lines(chunk_size=512, decode_unicode=False)`**: Iterates over response data line by line
- **`raise_for_status()`**: Raises HTTPError for 4xx/5xx status codes
- **`close()`**: Releases the connection back to the pool

**Usage Examples:**
```python
# Basic usage
response.json()  # Parse JSON
response.text    # Get text content
response.content # Get raw bytes

# Streaming large responses
for chunk in response.iter_content(chunk_size=1024):
    process_chunk(chunk)

# Check for errors
response.raise_for_status()
```

## Important Features

### Context Manager Support
The `Response` class supports context manager protocol:
```python
with requests.get('https://example.com') as response:
    data = response.content
# Connection automatically closed
```

### Streaming Support
Both `iter_content()` and `iter_lines()` support streaming for memory-efficient processing of large responses.

### Error Handling
- Validates URLs and raises `InvalidURL` or `MissingSchema` exceptions
- Handles encoding errors gracefully
- Provides detailed HTTP error messages through `raise_for_status()`

### Encoding Detection
- Automatic encoding detection using chardet or charset_normalizer
- Proper handling of UTF-8, UTF-16, and UTF-32 JSON content
- IDNA encoding support for international domain names

## Best Practices

1