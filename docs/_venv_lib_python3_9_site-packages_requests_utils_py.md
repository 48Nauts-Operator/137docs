<!-- Auto-generated by Claude on 2025-06-08 06:13 -->

# requests.utils Module Documentation

## Overview

The `requests.utils` module provides utility functions that are used internally within the Requests library and are also available for external use. This module contains various helper functions for handling URLs, headers, encoding, proxies, authentication, and other HTTP-related operations.

## Purpose

This module serves as a collection of utility functions that support the core functionality of the Requests library, including:

- URL parsing and manipulation
- Header validation and parsing
- Proxy configuration and detection
- Authentication handling
- File and content processing
- Encoding detection and conversion

## Constants

### Default Values
```python
NETRC_FILES = (".netrc", "_netrc")
DEFAULT_CA_BUNDLE_PATH = certs.where()
DEFAULT_PORTS = {"http": 80, "https": 443}
DEFAULT_ACCEPT_ENCODING = ", ".join(re.split(r",\s*", make_headers(accept_encoding=True)["accept-encoding"]))
```

### Character Sets
```python
UNRESERVED_SET = frozenset("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~")
```

## Important Functions

### URL and URI Utilities

#### `requote_uri(uri)`
Re-quotes a given URI to ensure it is fully and consistently quoted.
- **Parameters**: `uri` (str) - The URI to re-quote
- **Returns**: str - The properly quoted URI

#### `unquote_unreserved(uri)`
Un-escapes percent-escape sequences for unreserved characters only.
- **Parameters**: `uri` (str) - The URI to process
- **Returns**: str - URI with unreserved characters unquoted

#### `urldefragauth(url)`
Removes the fragment and authentication parts from a URL.
- **Parameters**: `url` (str) - The URL to process
- **Returns**: str - Clean URL without fragment and auth

### File and Content Utilities

#### `super_len(o)`
Determines the length of various objects (strings, files, file-like objects).
- **Parameters**: `o` - Object to measure
- **Returns**: int - Length of the object
- **Note**: Handles special cases like file objects and warns about text mode files

#### `guess_filename(obj)`
Attempts to guess the filename from an object's `name` attribute.
- **Parameters**: `obj` - Object with potential filename
- **Returns**: str or None - Guessed filename

#### `extract_zipped_paths(path)`
Extracts files from zip archives when a path refers to a zip member.
- **Parameters**: `path` (str) - Path that may reference zip archive member
- **Returns**: str - Path to extracted file or original path

### Authentication and Network Configuration

#### `get_netrc_auth(url, raise_errors=False)`
Retrieves authentication credentials from netrc files.
- **Parameters**: 
  - `url` (str) - URL to get credentials for
  - `raise_errors` (bool) - Whether to raise parsing errors
- **Returns**: tuple or None - (username, password) or None

#### `should_bypass_proxies(url, no_proxy)`
Determines if proxies should be bypassed for a given URL.
- **Parameters**:
  - `url` (str) - Target URL
  - `no_proxy` (str) - Comma-separated list of hosts to bypass
- **Returns**: bool - True if proxies should be bypassed

#### `resolve_proxies(request, proxies, trust_env=True)`
Resolves proxy configuration considering environment variables and NO_PROXY settings.
- **Parameters**:
  - `request` - Request object
  - `proxies` (dict) - Proxy configuration
  - `trust_env` (bool) - Whether to trust environment variables
- **Returns**: dict - Resolved proxy configuration

### Header Processing

#### `parse_dict_header(value)`
Parses HTTP header values into a dictionary of key-value pairs.
- **Parameters**: `value` (str) - Header value to parse
- **Returns**: dict - Parsed key-value pairs

#### `parse_list_header(value)`
Parses comma-separated header values into a list.
- **Parameters**: `value` (str) - Header value to parse
- **Returns**: list - List of header values

#### `check_header_validity(header)`
Validates header names and values for invalid characters.
- **Parameters**: `header` (tuple) - (name, value) tuple
- **Raises**: `InvalidHeader` - If header contains invalid characters

### Data Conversion Utilities

#### `from_key_val_list(value)` / `to_key_val_list(value)`
Convert between different representations of key-value data.
- **Parameters**: `value` - Data to convert
- **Returns**: OrderedDict or list - Converted data structure

#### `dict_from_cookiejar(cj)` / `add_dict_to_cookiejar(cj, cookie_dict)`
Convert between CookieJar objects and dictionaries.

### Encoding and Content Processing

#### `get_encoding_from_headers(headers)`
Extracts character encoding from HTTP headers.
- **Parameters**: `headers` (dict) - HTTP headers
- **Returns**: str or None - Character encoding

#### `guess_json_utf(data)`
Detects UTF encoding of JSON data by analyzing byte patterns.
- **Parameters**: `data` (bytes) - JSON data
- **Returns**: str or None - Detected encoding

### Network Utilities

#### `address_in_network(ip, net)`
Checks if an IP address belongs to a network subnet.
- **Parameters**:
  - `ip` (str) - IP address to check
  - `net` (str) - Network in CIDR notation
- **Returns**: bool - True if IP is in network

#### `is_ipv4_address(string_ip)` / `is_valid_cidr(string_network)`
Validate IP addresses and CIDR notation.

## Context Managers

### `atomic_open(filename)`
Provides atomic file writing by using temporary files.
```python
with atomic_open('/path/to/file') as f:
    f.write(data)  # File is atomically replaced
```

### `set_