<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# EmscriptenHTTPConnection Documentation

## Overview

This module provides HTTP and HTTPS connection classes specifically designed for Emscripten environments (WebAssembly running in browsers). These classes implement the standard HTTP connection interface while delegating the actual network operations to browser APIs through the fetch mechanism.

## Purpose

The primary purpose of this module is to provide a urllib3-compatible HTTP connection interface that works in browser environments where traditional socket-based connections are not available. Instead of using Python sockets, these classes use browser-native fetch APIs for making HTTP requests.

## Key Classes

### EmscriptenHTTPConnection

The main HTTP connection class for Emscripten environments.

#### Key Features
- **Browser-based networking**: Uses fetch API instead of sockets
- **Standard interface compatibility**: Implements the same interface as standard HTTPConnection
- **Simplified configuration**: Many socket-level configurations are ignored since the browser handles them

#### Important Methods

```python
def __init__(self, host: str, port: int = 0, *, timeout: _TYPE_TIMEOUT = _DEFAULT_TIMEOUT, ...)
```
- Initializes the connection with host and port
- Most network-level parameters (proxy, socket_options, source_address) are ignored

```python
def request(self, method: str, url: str, body: _TYPE_BODY | None = None, headers: typing.Mapping[str, str] | None = None, ...)
```
- Makes an HTTP request using the browser's fetch API
- Supports both regular and streaming requests based on `preload_content` parameter
- Handles URL construction for relative paths

```python
def getresponse(self) -> BaseHTTPResponse
```
- Returns the response wrapped in an `EmscriptenHttpResponseWrapper`
- Raises `ResponseNotReady` if no request has been made

#### Properties
- `is_closed`: Whether the connection is closed
- `is_connected`: Always returns `True` (browser handles connection state)
- `has_connected_to_proxy`: Always returns `False` (proxy handled by browser)

### EmscriptenHTTPSConnection

HTTPS connection class that extends `EmscriptenHTTPConnection`.

#### Key Features
- **Automatic SSL verification**: Browser automatically handles SSL/TLS verification
- **Ignored SSL parameters**: All SSL configuration parameters are accepted but ignored
- **Default HTTPS port**: Uses port 443 by default

#### SSL Configuration
All SSL-related parameters are accepted but ignored since the browser handles SSL/TLS:
- `cert_reqs`, `ca_certs`, `ssl_context`
- `cert_file`, `key_file`, `ssl_version`
- `assert_hostname`, `assert_fingerprint`

```python
def set_cert(self, ...):
```
- No-op method for SSL certificate configuration
- Browser handles all certificate validation automatically

## Error Handling

The module handles Emscripten-specific errors and converts them to standard HTTP exceptions:

- `_TimeoutError` → `TimeoutError`
- `_RequestError` → `HTTPException`

## Usage Notes

### Browser Environment Limitations
- **No socket control**: Low-level socket operations are handled by the browser
- **No proxy configuration**: Proxy settings must be configured at the browser level
- **Automatic SSL**: SSL/TLS configuration is managed entirely by the browser
- **CORS restrictions**: Subject to browser's Cross-Origin Resource Sharing policies

### Compatibility
- Maintains interface compatibility with standard urllib3 connections
- Type checking ensures protocol compliance with `BaseHTTPConnection` and `BaseHTTPSConnection`

## Example Usage

```python
# HTTP connection
conn = EmscriptenHTTPConnection('httpbin.org', 80)
conn.request('GET', '/get')
response = conn.getresponse()

# HTTPS connection  
secure_conn = EmscriptenHTTPSConnection('httpbin.org', 443)
secure_conn.request('GET', '/get')
response = secure_conn.getresponse()
```

## Implementation Details

### Dependencies
- Uses `EmscriptenRequest` for request representation
- Uses `send_request` and `send_streaming_request` for actual network operations
- Returns responses wrapped in `EmscriptenHttpResponseWrapper`

### Connection State Management
- `_closed`: Tracks connection state
- `_response`: Stores the last response object
- Connection state is simplified compared to socket-based implementations

## Notes and Limitations

⚠️ **Important Considerations:**
- This implementation is specifically for browser/WebAssembly environments
- Many configuration options are ignored due to browser API limitations
- SSL certificate validation cannot be customized
- Proxy configuration must be done at the browser level
- Subject to browser security policies (CORS, mixed content, etc.)