<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# EmscriptenRequest Module Documentation

## Overview

This module defines the `EmscriptenRequest` class, which represents an HTTP request specifically designed for use with Emscripten (WebAssembly) environments. The class serves as a data container for all the necessary components of an HTTP request, including method, URL, headers, body, and various configuration options.

## Purpose

The `EmscriptenRequest` class is part of a connection handling system, likely used to facilitate HTTP requests in WebAssembly/Emscripten environments where traditional HTTP libraries may not be directly available or need special handling.

## Classes

### `EmscriptenRequest`

A dataclass that encapsulates all the necessary information for making an HTTP request in an Emscripten environment.

#### Attributes

| Attribute | Type | Default | Description |
|-----------|------|---------|-------------|
| `method` | `str` | Required | HTTP method (GET, POST, PUT, etc.) |
| `url` | `str` | Required | Target URL for the request |
| `params` | `dict[str, str] \| None` | `None` | Query parameters to append to URL |
| `body` | `_TYPE_BODY \| None` | `None` | Request body content |
| `headers` | `dict[str, str]` | `{}` | HTTP headers as key-value pairs |
| `timeout` | `float` | `0` | Request timeout in seconds (0 = no timeout) |
| `decode_content` | `bool` | `True` | Whether to automatically decode response content |

#### Methods

##### `set_header(name: str, value: str) -> None`

Sets an HTTP header for the request.

**Parameters:**
- `name`: Header name (will be capitalized automatically)
- `value`: Header value

**Example:**
```python
request = EmscriptenRequest(method="GET", url="https://api.example.com")
request.set_header("content-type", "application/json")
# Results in headers: {"Content-Type": "application/json"}
```

##### `set_body(body: _TYPE_BODY | None) -> None`

Sets the request body content.

**Parameters:**
- `body`: The body content (type depends on `_TYPE_BODY` definition)

**Example:**
```python
request = EmscriptenRequest(method="POST", url="https://api.example.com")
request.set_body('{"key": "value"}')
```

## Usage Example

```python
# Create a basic GET request
request = EmscriptenRequest(
    method="GET",
    url="https://api.example.com/data",
    params={"limit": "10", "offset": "0"}
)

# Add headers
request.set_header("authorization", "Bearer token123")
request.set_header("accept", "application/json")

# Create a POST request with body
post_request = EmscriptenRequest(
    method="POST",
    url="https://api.example.com/submit",
    timeout=30.0
)
post_request.set_body('{"name": "John", "age": 30}')
post_request.set_header("content-type", "application/json")
```

## Notes and Suggestions

### Important Notes

- **Header Capitalization**: The `set_header` method automatically capitalizes header names (e.g., "content-type" becomes "Content-Type")
- **Timeout Behavior**: A timeout value of `0` indicates no timeout limit
- **Type Dependencies**: The class depends on `_TYPE_BODY` from `_base_connection`, which defines the acceptable body types

### Suggestions for Improvement

1. **Input Validation**: Consider adding validation for:
   - Valid HTTP methods
   - URL format validation
   - Timeout value constraints (negative values)

2. **Method Enhancement**:
   ```python
   def add_param(self, key: str, value: str) -> None:
       """Add a query parameter to the request."""
       if self.params is None:
           self.params = {}
       self.params[key] = value
   ```

3. **Documentation**: Consider adding docstrings to methods for better IDE support

4. **Type Hints**: The `_TYPE_BODY` type should be clearly documented or defined within this module for better type checking

## Dependencies

- `dataclasses`: For the `@dataclass` decorator and `field` function
- `..._base_connection`: Provides the `_TYPE_BODY` type definition