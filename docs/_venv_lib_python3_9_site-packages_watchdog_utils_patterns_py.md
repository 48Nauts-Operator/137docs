<!-- Auto-generated by Claude on 2025-06-02 06:15 -->

# watchdog.utils.patterns

**Module for wildcard searching and filtering functionality for files**

## Overview

This module provides utilities for filtering file paths using wildcard patterns. It supports both inclusion and exclusion patterns with configurable case sensitivity. The module is part of the Watchdog library and is designed to work cross-platform by leveraging Python's `pathlib` pure path objects.

## Key Features

- **Wildcard pattern matching** using glob-style patterns
- **Case-sensitive and case-insensitive** matching options
- **Inclusion and exclusion patterns** support
- **Cross-platform compatibility** using pure path objects
- **Conflict detection** for overlapping include/exclude patterns

## Core Functions

### `filter_paths()`

```python
def filter_paths(
    paths: list[str],
    *,
    included_patterns: list[str] | None = None,
    excluded_patterns: list[str] | None = None,
    case_sensitive: bool = True,
) -> Iterator[str]:
```

**Purpose**: Filters a list of file paths based on inclusion and exclusion patterns.

**Parameters**:
- `paths`: List of file paths to filter
- `included_patterns`: Wildcard patterns for files to include (defaults to `["*"]` - all files)
- `excluded_patterns`: Wildcard patterns for files to exclude (defaults to empty list)
- `case_sensitive`: Whether matching should be case-sensitive (default: `True`)

**Returns**: Iterator of file paths that match the criteria

**Example Usage**:
```python
# Filter Python files, excluding test files
paths = ["main.py", "test_main.py", "config.json", "utils.py"]
filtered = list(filter_paths(
    paths,
    included_patterns=["*.py"],
    excluded_patterns=["test_*"],
    case_sensitive=True
))
# Result: ["main.py", "utils.py"]
```

### `match_any_paths()`

```python
def match_any_paths(
    paths: list[str],
    *,
    included_patterns: list[str] | None = None,
    excluded_patterns: list[str] | None = None,
    case_sensitive: bool = True,
) -> bool:
```

**Purpose**: Checks if any paths in the list match the given patterns.

**Parameters**: Same as `filter_paths()`

**Returns**: `True` if at least one path matches the criteria, `False` otherwise

**Example Usage**:
```python
# Check if any Python files exist
has_python_files = match_any_paths(
    ["main.py", "config.json", "readme.txt"],
    included_patterns=["*.py"]
)
# Result: True
```

### `_match_path()` (Internal)

```python
def _match_path(
    raw_path: str,
    included_patterns: set[str],
    excluded_patterns: set[str],
    *,
    case_sensitive: bool,
) -> bool:
```

**Purpose**: Internal function that performs the actual pattern matching for a single path.

**Key Features**:
- Uses `PurePosixPath` for case-sensitive matching
- Uses `PureWindowsPath` for case-insensitive matching
- Detects and raises `ValueError` for conflicting patterns

## Implementation Details

### Cross-Platform Path Handling

The module uses Python's `pathlib` pure path objects to handle cross-platform compatibility:

```python
# Case-sensitive matching (Unix-like behavior)
path = PurePosixPath(raw_path)

# Case-insensitive matching (Windows-like behavior)  
path = PureWindowsPath(raw_path)
```

### Pattern Conflict Detection

The module automatically detects when the same pattern appears in both inclusion and exclusion lists:

```python
common_patterns = included_patterns & excluded_patterns
if common_patterns:
    error = f"conflicting patterns `{common_patterns}` included and excluded"
    raise ValueError(error)
```

## Usage Notes

- **Default behavior**: If no inclusion patterns are specified, all files are included (`["*"]`)
- **Pattern syntax**: Uses standard glob patterns (e.g., `*.py`, `test_*`, `**/*.txt`)
- **Case sensitivity**: For case-insensitive matching, all patterns are converted to lowercase
- **Performance**: Uses generators/iterators for memory efficiency with large file lists

## Error Handling

- **ValueError**: Raised when the same pattern exists in both inclusion and exclusion lists
- **Type checking**: Full type hints provided for better IDE support and static analysis

## Dependencies

- `pathlib`: For cross-platform path handling
- `typing`: For type annotations
- `collections.abc`: For Iterator type (import only during type checking)