<!--
This documentation was auto-generated by Claude on 2025-05-31T15-58-48.
Source file: ./src/backend/app/config.py
-->

# Configuration Management Module

## Overview

The configuration management module provides centralized settings management for the Document Management System. It handles database connections, folder monitoring, LLM integration, authentication, and various feature flags through environment variables and configuration files.

## Dependencies

- **pydantic**: For settings validation and management
- **pydantic_settings**: For Pydantic v2 compatibility (fallback)
- **os**: For environment variable access and file path operations

## Classes

### `Settings`

A Pydantic-based settings class that manages all application configuration parameters.

**Inheritance**: `BaseSettings`

#### Configuration Categories

##### Database Settings

| Field | Type | Default | Description |
|-------|------|---------|-------------|
| `DATABASE_URL` | `str \| None` | `$DATABASE_URL` | Database connection URL from environment |
| `DATABASE_PATH` | `str` | `{cwd}/documents.db` | SQLite database file path |

##### Folder Monitoring

| Field | Type | Default | Description |
|-------|------|---------|-------------|
| `WATCH_FOLDER` | `str` | `~/Documents/Inbox` | Directory path for monitoring new documents |

##### LLM (Large Language Model) Settings

| Field | Type | Default | Description |
|-------|------|---------|-------------|
| `LLM_MODEL` | `str` | `"gwen2.5"` | Default LLM model identifier |
| `LLM_API_KEY` | `str` | `$LLM_API_KEY` | API key for LLM service authentication |
| `LLM_API_URL` | `str` | `"http://localhost:11434/api/generate"` | LLM service endpoint URL |

##### Authentication Settings

| Field | Type | Default | Description |
|-------|------|---------|-------------|
| `SECRET_KEY` | `str` | `$SECRET_KEY` or default hash | JWT token signing secret |
| `ALGORITHM` | `str` | `"HS256"` | JWT signing algorithm |
| `ACCESS_TOKEN_EXPIRE_MINUTES` | `int` | `30` | Token expiration time in minutes |

##### Feature Flags

| Field | Type | Default | Description |
|-------|------|---------|-------------|
| `NOTIFICATION_ENABLED` | `bool` | `True` | Enable/disable system notifications |
| `AUTO_OCR` | `bool` | `True` | Enable automatic OCR processing |
| `AUTO_TAGGING` | `bool` | `True` | Enable automatic document tagging |

##### Application Settings

| Field | Type | Default | Description |
|-------|------|---------|-------------|
| `DEFAULT_CURRENCY` | `str` | `$DEFAULT_CURRENCY` or `"USD"` | Default currency for financial documents |
| `HOSTFS_ROOT` | `str` | `$HOSTFS_ROOT` or `"/hostfs"` | Host filesystem mount point in containers |

##### Optional Integration Settings

| Field | Type | Default | Description |
|-------|------|---------|-------------|
| `hostfs_mount` | `str \| None` | `None` | Alternative host filesystem mount path |
| `archive_folder` | `str \| None` | `None` | Document archive directory |
| `ollama_base_url` | `str \| None` | `None` | Ollama service base URL |
| `litellm_url` | `str \| None` | `None` | LiteLLM service URL |
| `litellm_api` | `str \| None` | `None` | LiteLLM API endpoint |

#### Configuration Class

The inner `Config` class defines Pydantic behavior:

- **`env_file`**: `".env"` - Loads environment variables from `.env` file
- **`env_file_encoding`**: `"utf-8"` - File encoding for environment file
- **`extra`**: `"ignore"` - Ignores unknown fields without raising errors

## Module Variables

### `settings`

**Type**: `Settings`

Global settings instance providing access to all configuration parameters throughout the application.

**Usage**:
```python
from config import settings

# Access database URL
db_url = settings.DATABASE_URL

# Check if OCR is enabled
if settings.AUTO_OCR:
    # Perform OCR processing
    pass
```

## Compatibility Notes

The module includes a compatibility layer for Pydantic versions:

- **Pydantic < 2.0**: Uses `pydantic.BaseSettings`
- **Pydantic â‰¥ 2.0**: Uses `pydantic_settings.BaseSettings`

This ensures the module works across different Pydantic versions without modification.

## Environment Variables

The following environment variables can be used to configure the application:

| Variable | Purpose | Required |
|----------|---------|----------|
| `DATABASE_URL` | Database connection string | No |
| `LLM_API_KEY` | LLM service authentication | No |
| `LLM_API_URL` | Custom LLM endpoint | No |
| `SECRET_KEY` | JWT signing secret | Recommended |
| `DEFAULT_CURRENCY` | Default currency code | No |
| `HOSTFS_ROOT` | Container filesystem root | No |

## Usage Examples

### Basic Configuration Access

```python
from config import settings

# Database configuration
if settings.DATABASE_URL:
    # Use provided database URL
    db_connection = create_engine(settings.DATABASE_URL)
else:
    # Use local SQLite database
    db_connection = create_engine(f"sqlite:///{settings.DATABASE_PATH}")
```

### Feature Flag Usage

```python
from config import settings

def process_document(document):
    if settings.AUTO_OCR:
        text = perform_ocr(document)
    
    if settings.AUTO_TAGGING:
        tags = generate_tags(document)
    
    if settings.NOTIFICATION_ENABLED:
        send_notification("Document processed")
```

### Environment File Configuration

Create a `.env` file in your project root:

```env
DATABASE_URL=postgresql://user:pass@localhost/docms
LLM_API_KEY=your-api-key-here
SECRET_KEY=your-secret-key-here
DEFAULT_CURRENCY=EUR