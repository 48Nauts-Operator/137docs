<!--
This documentation was auto-generated by Claude on 2025-06-01T06-27-18.
Source file: ./src/backend/app/main.py
-->

# Document Management System API Documentation

## Overview

This is the main application module for a comprehensive Document Management System built with FastAPI. The system provides document processing, OCR capabilities, LLM-powered metadata extraction, analytics, and user management features.

## Features

- **Document Management**: Upload, process, and manage documents with OCR and metadata extraction
- **Authentication & Authorization**: JWT-based authentication with role-based access control
- **LLM Integration**: AI-powered document analysis and metadata extraction
- **Search Capabilities**: Text, semantic, and vision-based search functionality
- **Analytics**: Document statistics and business intelligence features
- **Tenant Management**: Multi-tenant support for document organization
- **Address Book**: Contact and vendor management
- **Notification System**: Automated alerts and reminders
- **Processing Rules**: Configurable automation rules for document processing

## API Endpoints

### Authentication

#### `POST /api/auth/login`
Authenticate user and receive access token.

**Parameters:**
- `username` (form): User's username
- `password` (form): User's password

**Returns:**
```json
{
  "access_token": "string",
  "token_type": "bearer"
}
```

#### `GET /api/auth/me`
Get current user information.

**Returns:**
```json
{
  "id": 1,
  "username": "string",
  "email": "string",
  "disabled": false
}
```

#### `POST /api/auth/change-password`
Change current user's password.

**Parameters:**
- `old_password` (form): Current password
- `new_password` (form): New password

#### `POST /api/auth/register`
Register initial admin user (only when no users exist).

**Parameters:**
- `username` (form): Admin username
- `email` (form): Admin email
- `password` (form): Admin password

### Document Management

#### `GET /api/documents`
Retrieve all documents with optional filtering.

**Query Parameters:**
- `status` (optional): Filter by document status
- `document_type` (optional): Filter by document type
- `search` (optional): Search term for content

#### `GET /api/documents/{document_id}`
Get specific document by ID.

#### `PUT /api/documents/{document_id}`
Update document information.

**Parameters:**
- `title` (form, optional): Document title
- `document_type` (form, optional): Document type
- `sender` (form, optional): Document sender
- `recipient` (form, optional): Document recipient
- `document_date` (form, optional): Document date (YYYY-MM-DD)
- `due_date` (form, optional): Due date (YYYY-MM-DD)
- `amount` (form, optional): Document amount
- `currency` (form, optional): Currency code
- `status` (form, optional): Document status

#### `DELETE /api/documents/{document_id}`
Delete a document.

#### `POST /api/documents/upload`
Upload and process a new document.

**Parameters:**
- `file` (file): Document file to upload

#### `GET /api/documents/{document_id}/file`
Download the original document file.

**Query Parameters:**
- `api_key` (optional): API key for authentication

### Document Tags

#### `GET /api/documents/{document_id}/tags`
Get all tags for a specific document.

#### `POST /api/documents/{document_id}/tags`
Add a tag to a document.

**Parameters:**
- `tag` (form): Tag name to add

#### `DELETE /api/documents/{document_id}/tags/{tag_name}`
Remove a tag from a document.

### Search

#### `GET /api/search`
Basic text search across documents.

**Query Parameters:**
- `query`: Search query string

#### `POST /api/search/advanced`
Advanced search with complex criteria.

**Body:**
```json
{
  "filters": {},
  "search_terms": "string",
  "date_range": {}
}
```

#### `GET /api/search/semantic`
Semantic search using embeddings.

**Query Parameters:**
- `query`: Search query string

#### `GET /api/search/vision`
Vision-based search using document images.

**Query Parameters:**
- `query`: Search query string

#### `GET /api/search/related/{document_id}`
Find documents related to a specific document.

### Analytics

#### `GET /api/analytics/document-types`
Get distribution of document types.

#### `GET /api/analytics/payment-status`
Get payment status distribution.

#### `GET /api/analytics/monthly-documents`
Get monthly document counts.

**Query Parameters:**
- `year`: Year for analysis

#### `GET /api/analytics/monthly-invoices`
Get monthly invoice amounts.

**Query Parameters:**
- `year`: Year for analysis

#### `GET /api/analytics/summary`
Get summary metrics dashboard.

### User Management (Admin Only)

#### `GET /api/users`
List all users.

#### `POST /api/users`
Create a new user.

**Parameters:**
- `username` (form): Username
- `email` (form): Email address
- `password` (form): Password
- `full_name` (form, optional): Full name
- `role` (form): User role (admin/viewer)
- `disabled` (form): Whether user is disabled

#### `PUT /api/users/{user_id}`
Update user information.

#### `DELETE /api/users/{user_id}`
Delete a user.

#### `POST /api/users/{user_id}/reset-password`
Reset user's password.

### Tenant Management

#### `GET /api/tenants`
Get all tenants for current user.

#### `GET /api/tenants/default`
Get default tenant for current user.

#### `POST /api/tenants`
Create a new tenant.

**Parameters:**
- `name` (form): Tenant name
- `alias` (form): Tenant alias
- `type` (form): Tenant type
- `street` (form, optional): Street address
- `house_number` (form, optional): House number
- `apartment` (form, optional): Apartment number
- `area_code` (form, optional): Area code
- `county` (form, optional): County
- `country` (form