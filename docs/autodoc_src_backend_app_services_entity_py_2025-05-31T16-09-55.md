<!--
This documentation was auto-generated by Claude on 2025-05-31T16-09-55.
Source file: ./src/backend/app/services/entity.py
-->

# EntityService Documentation

## Overview

The `EntityService` class provides an asynchronous service layer for managing `Entity` objects in a database using SQLAlchemy's async ORM capabilities. This service implements common CRUD operations with proper database session management.

## Dependencies

```python
from typing import List, Optional
from sqlalchemy.ext.asyncio import AsyncSession
from sqlalchemy import select
from app.models import Entity
```

## Class Definition

### EntityService

A service class that encapsulates database operations for Entity objects.

#### Constructor

```python
def __init__(self, db: AsyncSession)
```

**Parameters:**
- `db` (AsyncSession): An active SQLAlchemy async database session

**Description:**
Initializes the service with a database session that will be used for all database operations.

---

## Methods

### list()

```python
async def list() -> List[Entity]
```

**Returns:**
- `List[Entity]`: A list of all Entity objects in the database

**Description:**
Retrieves all Entity records from the database asynchronously.

**Example:**
```python
entities = await entity_service.list()
```

---

### create()

```python
async def create(**kwargs) -> Entity
```

**Parameters:**
- `**kwargs`: Keyword arguments representing the Entity attributes to set

**Returns:**
- `Entity`: The newly created Entity object with database-generated fields populated

**Description:**
Creates a new Entity record in the database with the provided attributes. The method automatically commits the transaction and refreshes the object to include any database-generated values.

**Example:**
```python
new_entity = await entity_service.create(name="Example", status="active")
```

---

### update()

```python
async def update(entity_id: int, **kwargs) -> Optional[Entity]
```

**Parameters:**
- `entity_id` (int): The unique identifier of the Entity to update
- `**kwargs`: Keyword arguments representing the Entity attributes to update

**Returns:**
- `Optional[Entity]`: The updated Entity object, or `None` if the entity was not found

**Description:**
Updates an existing Entity record with the provided attributes. If the entity with the specified ID doesn't exist, returns `None`. The method automatically commits the transaction and refreshes the object.

**Example:**
```python
updated_entity = await entity_service.update(1, name="Updated Name", status="inactive")
if updated_entity:
    print(f"Updated entity: {updated_entity.name}")
else:
    print("Entity not found")
```

---

## Usage Example

```python
from sqlalchemy.ext.asyncio import AsyncSession

async def example_usage(db_session: AsyncSession):
    # Initialize the service
    entity_service = EntityService(db_session)
    
    # Create a new entity
    new_entity = await entity_service.create(
        name="Sample Entity",
        description="This is a sample entity"
    )
    
    # List all entities
    all_entities = await entity_service.list()
    
    # Update an entity
    updated_entity = await entity_service.update(
        new_entity.id,
        description="Updated description"
    )
```

## Notes

- All methods are asynchronous and should be called with `await`
- The service assumes that the provided `AsyncSession` is properly configured and active
- Database transactions are automatically committed for create and update operations
- The service relies on the `Entity` model being properly defined with SQLAlchemy ORM mappings