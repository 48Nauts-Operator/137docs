<!--
This documentation was auto-generated by Claude on 2025-06-01T06-30-19.
Source file: ./src/backend/app/services/entity.py
-->

# EntityService Documentation

## Overview

The `EntityService` class provides asynchronous database operations for managing `Entity` objects using SQLAlchemy with async sessions. This service implements basic CRUD (Create, Read, Update) operations with a clean, async/await interface.

## Dependencies

```python
from typing import List, Optional
from sqlalchemy.ext.asyncio import AsyncSession
from sqlalchemy import select
from app.models import Entity
```

## Class Definition

### EntityService

A service class that encapsulates database operations for Entity objects.

#### Constructor

```python
def __init__(self, db: AsyncSession)
```

**Parameters:**
- `db` (`AsyncSession`): An active SQLAlchemy async database session

**Description:**
Initializes the EntityService with a database session that will be used for all database operations.

---

## Methods

### list()

```python
async def list() -> List[Entity]
```

**Returns:** `List[Entity]` - A list of all Entity objects in the database

**Description:**
Retrieves all Entity records from the database asynchronously.

**Example:**
```python
entities = await entity_service.list()
```

---

### create()

```python
async def create(**kwargs) -> Entity
```

**Parameters:**
- `**kwargs`: Keyword arguments representing the Entity attributes to set

**Returns:** `Entity` - The newly created Entity object with populated database fields

**Description:**
Creates a new Entity record in the database. The entity is automatically committed to the database and refreshed to include any server-generated values (such as auto-increment IDs).

**Example:**
```python
new_entity = await entity_service.create(name="Example", status="active")
```

---

### update()

```python
async def update(entity_id: int, **kwargs) -> Optional[Entity]
```

**Parameters:**
- `entity_id` (`int`): The primary key ID of the entity to update
- `**kwargs`: Keyword arguments representing the Entity attributes to update

**Returns:** `Optional[Entity]` - The updated Entity object, or `None` if the entity was not found

**Description:**
Updates an existing Entity record in the database. If the entity with the specified ID doesn't exist, returns `None`. The updated entity is automatically committed and refreshed.

**Example:**
```python
updated_entity = await entity_service.update(1, name="Updated Name", status="inactive")
if updated_entity is None:
    print("Entity not found")
```

---

## Usage Example

```python
from sqlalchemy.ext.asyncio import AsyncSession

# Assuming you have an async database session
async def example_usage(db_session: AsyncSession):
    service = EntityService(db_session)
    
    # Create a new entity
    new_entity = await service.create(name="Test Entity", description="A test entity")
    
    # List all entities
    all_entities = await service.list()
    
    # Update an entity
    updated_entity = await service.update(new_entity.id, name="Updated Test Entity")
    
    return updated_entity
```

## Notes

- All methods are asynchronous and must be awaited
- Database transactions are automatically committed after create and update operations
- The service assumes that the provided `AsyncSession` is properly configured and connected
- Error handling for database operations should be implemented at the application level
- The `update` method uses dynamic attribute setting, so ensure that the provided kwargs correspond to valid Entity attributes