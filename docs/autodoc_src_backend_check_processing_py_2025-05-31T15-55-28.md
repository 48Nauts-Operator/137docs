<!--
This documentation was auto-generated by Claude on 2025-05-31T15-55-28.
Source file: ./src/backend/check_processing.py
-->

# Document Processing Status Checker

A diagnostic utility script for monitoring document processing status in the application database.

## Overview

This script provides a command-line interface to check the current status of document processing operations. It connects to the application database and displays information about documents currently being processed and recently created documents.

## Prerequisites

- Python 3.7+ (required for asyncio support)
- SQLAlchemy with async support
- Access to the application database
- Application models and database configuration

## Dependencies

```python
import asyncio
import sys
import os
from sqlalchemy.ext.asyncio import AsyncSession
from sqlalchemy import select, text
from app.database import engine
from app.models import Document
```

## Usage

Run the script directly from the command line:

```bash
python check_processing.py
```

## Functions

### `check_processing()`

**Description:** Asynchronously queries the database to retrieve and display document processing information.

**Parameters:** None

**Returns:** None (prints output to console)

**Behavior:**
1. Establishes an async database session
2. Queries for documents with 'processing' status
3. Displays count and details of processing documents
4. Retrieves the 5 most recently created documents
5. Displays recent document information with metadata

## Output Format

The script produces two sections of output:

### Processing Documents Section
```
Documents with processing status: <count>
  - <document_title> (ID: <document_id>)
  - ...
```

### Recent Documents Section
```
Recent documents:
  - <document_title> (ID: <document_id>, Status: <status>, Created: <timestamp>)
  - ...
```

## Database Queries

The script executes two main database operations:

1. **Processing Status Query:** Uses SQLAlchemy ORM to filter documents by status
   ```sql
   SELECT * FROM documents WHERE status = 'processing'
   ```

2. **Recent Documents Query:** Uses raw SQL to get recent documents with metadata
   ```sql
   SELECT id, title, status, created_at FROM documents ORDER BY created_at DESC LIMIT 5
   ```

## Configuration

### Path Configuration
The script adds `/app` to the Python path to access application modules:
```python
sys.path.append('/app')
```

### Database Connection
Uses the application's configured database engine from `app.database.engine`.

## Error Handling

- Database connection errors will propagate and terminate the script
- Async session management is handled with context managers for proper cleanup
- No explicit error handling for missing documents or empty results

## Use Cases

- **Development:** Quick status check during development and testing
- **Debugging:** Identify stuck or long-running document processing operations
- **Monitoring:** Regular checks of recent document creation and processing flow
- **Troubleshooting:** Investigate document processing bottlenecks

## Limitations

- Limited to 5 most recent documents
- No filtering options for date ranges or specific statuses
- Output is console-only (no logging or file output)
- Requires direct database access

## Example Output

```
Documents with processing status: 2
  - User Manual v2.1 (ID: 1001)
  - API Documentation (ID: 1005)

Recent documents:
  - Installation Guide (ID: 1010, Status: completed, Created: 2024-01-15 14:30:22)
  - API Documentation (ID: 1005, Status: processing, Created: 2024-01-15 14:25:18)
  - User Manual v2.1 (ID: 1001, Status: processing, Created: 2024-01-15 14:20:45)
  - Release Notes (ID: 998, Status: completed, Created: 2024-01-15 14:15:30)
  - Quick Start Guide (ID: 995, Status: failed, Created: 2024-01-15 14:10:12)
```