<!--
This documentation was auto-generated by Claude on 2025-06-01T06-16-03.
Source file: ./src/backend/check_processing.py
-->

# Document Processing Status Checker

A utility script for monitoring document processing status and displaying recent document activity in the system.

## Overview

This script provides administrators with a quick way to check the current state of document processing operations and view recently created documents. It connects to the application database and queries document status information asynchronously.

## Dependencies

- `asyncio` - For asynchronous execution
- `sqlalchemy` - Database ORM and async session management
- `app.database` - Application database engine configuration
- `app.models` - Document model definitions

## Functions

### `check_processing()`

An asynchronous function that performs two main operations:

1. **Processing Status Check**: Queries and displays all documents currently in 'processing' status
2. **Recent Documents Review**: Shows the 5 most recently created documents with their metadata

#### Behavior

- Creates an async database session using the application's configured engine
- Executes two separate queries:
  - ORM query to find documents with `status = 'processing'`
  - Raw SQL query to retrieve the 5 most recent documents ordered by creation date
- Outputs results to console with formatted display

#### Output Format

```
Documents with processing status: X
  - Document Title (ID: 123)
  - Another Document (ID: 456)

Recent documents:
  - Recent Doc Title (ID: 789, Status: completed, Created: 2024-01-15 10:30:00)
  - Previous Doc (ID: 788, Status: processing, Created: 2024-01-15 09:15:00)
```

## Usage

### Command Line Execution

```bash
python check_processing.py
```

### Programmatic Usage

```python
import asyncio
from check_processing import check_processing

# Run the status check
await check_processing()

# Or use asyncio.run() if not in an async context
asyncio.run(check_processing())
```

## Requirements

- Python 3.7+ (for asyncio support)
- SQLAlchemy with async support
- Access to the application's database configuration
- Proper database connection credentials

## Database Schema Assumptions

The script assumes the following database structure:

**documents table:**
- `id` - Primary key identifier
- `title` - Document title/name
- `status` - Processing status (expects 'processing' as a valid value)
- `created_at` - Timestamp of document creation

## Error Handling

The script uses SQLAlchemy's async session context manager, which automatically handles:
- Database connection cleanup
- Transaction rollback on errors
- Resource disposal

## Security Considerations

- Ensure database credentials are properly secured
- Consider implementing query limits for large datasets
- Validate database connection permissions before deployment

## Maintenance Notes

- Monitor performance with large document collections
- Consider adding pagination for processing document lists
- Raw SQL query may need adjustment if database schema changes