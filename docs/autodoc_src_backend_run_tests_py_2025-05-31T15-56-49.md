<!--
This documentation was auto-generated by Claude on 2025-05-31T15-56-49.
Source file: ./src/backend/run_tests.py
-->

# Test Runner Documentation

## Overview

This module provides a test runner specifically designed for executing 137Docs LLM integration tests. It configures the testing environment and runs pytest with appropriate parameters for asynchronous LLM testing.

## Module Information

- **File**: `test_runner.py`
- **Purpose**: Execute LLM integration tests with proper environment configuration
- **Dependencies**: `pytest`, `pytest-asyncio`, `pytest-mock`

## Functions

### `run_tests()`

Executes the LLM integration tests with proper environment setup and configuration.

**Returns:**
- `int`: Exit code (0 for success, non-zero for failure)

**Behavior:**
1. Sets up testing environment variables
2. Configures in-memory SQLite database for testing
3. Runs pytest with specific parameters for LLM tests
4. Provides user-friendly output with status indicators

**Environment Variables Set:**
- `TESTING`: Set to `'true'` to indicate test mode
- `DATABASE_URL`: Set to `'sqlite+aiosqlite:///:memory:'` for in-memory testing database

**Pytest Configuration:**
- Target file: `tests/test_llm_simple.py`
- Verbose output (`-v`)
- Short traceback format (`--tb=short`)
- Auto asyncio mode (`--asyncio-mode=auto`)
- Show print statements (`-s`)

**Exception Handling:**
- `subprocess.CalledProcessError`: Captures test failures and returns appropriate exit code
- `FileNotFoundError`: Handles missing pytest installation with helpful error message

## Usage

### Command Line

```bash
python test_runner.py
```

### As a Module

```python
from test_runner import run_tests

exit_code = run_tests()
if exit_code == 0:
    print("Tests passed successfully")
else:
    print(f"Tests failed with code {exit_code}")
```

## Prerequisites

Ensure the following packages are installed:

```bash
pip install pytest pytest-asyncio pytest-mock
```

## Output Examples

### Successful Test Run

```
🧪 Running 137Docs LLM Integration Tests
==================================================
[pytest output...]
✅ All LLM integration tests passed!
```

### Failed Test Run

```
🧪 Running 137Docs LLM Integration Tests
==================================================
[pytest output...]
❌ Tests failed with exit code 1
```

### Missing Dependencies

```
🧪 Running 137Docs LLM Integration Tests
==================================================
❌ pytest not found. Please install test dependencies:
pip install pytest pytest-asyncio pytest-mock
```

## Integration Notes

- Uses in-memory SQLite database to avoid test data persistence
- Configured for async/await testing patterns common in LLM integrations
- Designed to run as part of CI/CD pipelines with proper exit codes
- Environment isolation ensures tests don't interfere with production settings

## Exit Codes

| Code | Description |
|------|-------------|
| 0    | All tests passed successfully |
| 1    | Missing pytest dependencies |
| >1   | Test failures (code matches pytest exit code) |