<!-- Auto-generated by Claude on 2025-06-01 10:12 -->

# Hetzner Invoice Force Processing Script

## Overview

This Python script is designed to manually force the processing of Hetzner invoices in a document processing system. It bypasses normal duplicate detection mechanisms and directly adds Hetzner invoice files to the processing queue.

## Purpose

- **Manual Processing**: Provides a way to manually trigger processing of Hetzner invoices
- **Bypass Duplicate Detection**: Circumvents the system's normal duplicate detection logic
- **Batch Processing**: Processes all Hetzner invoice files found in the inbox folder at once
- **Container Environment**: Designed to run within a containerized application environment

## Key Functions

### `force_process_hetzner_invoices()`

The main asynchronous function that handles the bulk processing of Hetzner invoices.

**Functionality:**
- Scans the inbox directory for Hetzner invoice PDF files
- Lists all found files for user confirmation
- Processes each file individually using the main application's processing function
- Provides detailed progress reporting and error handling

**File Pattern Matching:**
```python
hetzner_files = glob.glob(os.path.join(inbox_path, "*Hetzner*.pdf"))
```

## Configuration

### File Paths

| Path | Description |
|------|-------------|
| `/app` | Backend application root directory |
| `/hostfs/Inbox` | Container inbox folder for document files |

### Dependencies

- **External Module**: `app.main.process_new_document` - Main document processing function
- **Standard Libraries**: `asyncio`, `sys`, `os`, `glob`

## Usage

### Running the Script

```bash
python3 hetzner_force_process.py
```

### Expected Output

```
Found 3 Hetzner invoice files:
  - Invoice_Hetzner_2024_01.pdf
  - Invoice_Hetzner_2024_02.pdf
  - Invoice_Hetzner_2024_03.pdf

Starting manual processing of Hetzner invoices...

Processing 1/3: Invoice_Hetzner_2024_01.pdf
‚úÖ Successfully processed: Invoice_Hetzner_2024_01.pdf

Processing 2/3: Invoice_Hetzner_2024_02.pdf
‚úÖ Successfully processed: Invoice_Hetzner_2024_02.pdf

Processing 3/3: Invoice_Hetzner_2024_03.pdf
‚ùå Error processing Invoice_Hetzner_2024_03.pdf: File format not supported

Completed processing 3 Hetzner invoices.
```

## Important Notes

### ‚ö†Ô∏è Cautions

- **Duplicate Processing**: This script bypasses duplicate detection, which may result in documents being processed multiple times
- **Container Dependency**: The script assumes it's running in a container environment with specific path mappings
- **File Pattern**: Only processes PDF files with "Hetzner" in the filename

### üí° Recommendations

1. **Backup Files**: Consider backing up the inbox folder before running the script
2. **Test Environment**: Run in a test environment first to verify behavior
3. **Monitor Logs**: Check application logs for any processing errors or conflicts
4. **File Verification**: Manually verify that all expected Hetzner invoices are present before running

### üîß Potential Improvements

- Add command-line arguments for custom file patterns or paths
- Implement dry-run mode to preview files without processing
- Add configuration file support for different environments
- Include more robust error handling and retry mechanisms
- Add logging integration with the main application's logging system

## Error Handling

The script includes basic error handling that:
- Catches and reports individual file processing errors
- Continues processing remaining files even if one fails
- Provides clear success/failure indicators for each file