<!-- Auto-generated by Claude on 2025-06-01 10:12 -->

# Flight Check API Endpoints Documentation

## Overview

The Flight Check API provides comprehensive platform diagnostics through REST API endpoints. This module implements health monitoring and system diagnostics functionality for a multi-tenant platform with AI services, document processing, and analytics capabilities.

## Purpose

- **System Health Monitoring**: Real-time health checks for essential platform components
- **Diagnostic Tools**: Multi-level diagnostic capabilities from quick checks to deep analysis
- **Component-Specific Monitoring**: Focused checks for individual system components
- **Administrative Oversight**: Privileged diagnostic functions for system administrators

## API Endpoints

### Health Check Endpoints

#### `GET /health`
- **Purpose**: Quick health check (30 seconds) for essential systems
- **Authentication**: None required
- **Duration**: ~30 seconds
- **Use Case**: Basic availability monitoring, load balancer health checks

```python
# Example response structure
{
    "status": "healthy",
    "timestamp": "2024-01-01T12:00:00Z",
    "checks": {...}
}
```

#### `GET /comprehensive`
- **Purpose**: Comprehensive system check (5 minutes) for all major systems
- **Authentication**: Required (any authenticated user)
- **Duration**: ~5 minutes
- **Use Case**: Regular system monitoring, troubleshooting

#### `GET /deep`
- **Purpose**: Deep diagnostic analysis (15 minutes) with complete system analysis
- **Authentication**: Admin privileges required
- **Duration**: ~15 minutes
- **Use Case**: In-depth system analysis, performance optimization

### Component-Specific Endpoints

#### `GET /database`
- **Purpose**: Focused database health assessment
- **Authentication**: Required
- **Checks**: Database connectivity, performance, integrity

#### `GET /ai-services`
- **Purpose**: AI services availability and performance check
- **Authentication**: Required
- **Checks**: ML model availability, API responsiveness, resource usage

#### `GET /multi-tenant`
- **Purpose**: Multi-tenant system isolation and performance check
- **Authentication**: Required
- **Checks**: Tenant isolation, resource allocation, access controls

#### `GET /processing`
- **Purpose**: Document processing pipeline health check
- **Authentication**: Required
- **Checks**: File system access, processing queues, pipeline status

#### `GET /analytics`
- **Purpose**: Analytics and reporting system check
- **Authentication**: Required
- **Checks**: Data pipeline status, reporting engine, metrics collection

### Administrative Endpoints

#### `GET /performance`
- **Purpose**: System performance analysis
- **Authentication**: Admin privileges required
- **Checks**: Resource utilization, response times, throughput metrics

#### `GET /security`
- **Purpose**: Security configuration and compliance check
- **Authentication**: Admin privileges required
- **Checks**: Security policies, access controls, vulnerability assessment

### Unified Status Endpoint

#### `GET /status`
- **Purpose**: Configurable system status with multiple check depths
- **Authentication**: Varies by check type
- **Parameters**:
  - `check_type`: `quick` | `comprehensive` | `deep`

## Important Classes and Enums

### `CheckType` Enum
```python
class CheckType(str, Enum):
    QUICK = "quick"           # 30-second basic check
    COMPREHENSIVE = "comprehensive"  # 5-minute full check
    DEEP = "deep"            # 15-minute deep analysis
```

## Dependencies

The module relies on several key dependencies:

- **`FlightCheckService`**: Core service handling diagnostic logic
- **`AsyncSession`**: Database session management
- **`get_current_user`**: Authentication and authorization
- **FastAPI components**: Router, dependencies, HTTP exceptions

## Authentication & Authorization

### Access Levels

1. **Public Access**: `/health` endpoint only
2. **Authenticated Users**: Most diagnostic endpoints
3. **Admin Only**: `/deep`, `/performance`, `/security` endpoints

### Security Features

- Role-based access control
- User context logging
- Secure error handling without information leakage

## Error Handling

All endpoints implement comprehensive error handling:

- **Logging**: Detailed error logging for debugging
- **HTTP Exceptions**: Appropriate status codes (401, 403, 500)
- **User-Friendly Messages**: Clear error descriptions
- **Security**: No sensitive information in error responses

## Usage Examples

### Basic Health Check
```bash
curl -X GET "/health"
```

### Authenticated Comprehensive Check
```bash
curl -X GET "/comprehensive" \
  -H "Authorization: Bearer <token>"
```

### Admin Deep Diagnostic
```bash
curl -X GET "/deep" \
  -H "Authorization: Bearer <admin_token>"
```

### Configurable Status Check
```bash
curl -X GET "/status?check_type=comprehensive" \
  -H "Authorization: Bearer <token>"
```

## Notes and Recommendations

### Performance Considerations
- **Quick checks** should complete within 30 seconds
- **Comprehensive checks** may take up to 5 minutes
- **Deep diagnostics** can run for 15+ minutes - use sparingly

### Monitoring Integration
- Use `/health` for load balancer health checks
- Integrate `/comprehensive` with monitoring systems
- Schedule `/deep` diagnostics during maintenance windows

### Security Best Practices
- Admin endpoints are properly protected
- User context is logged for audit trails
- Sensitive diagnostic data requires appropriate permissions

### Error Monitoring
- All failures are logged with appropriate detail levels
- HTTP status codes follow REST conventions
- Error messages are informative but don't expose system internals