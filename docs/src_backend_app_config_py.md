<!-- Auto-generated by Claude on 2025-06-01 10:12 -->

# Configuration Management Module

## Overview

This module provides centralized configuration management for the Document Management System. It handles application settings, environment variables, and provides compatibility between different versions of Pydantic.

## Purpose

- **Centralized Configuration**: Single source of truth for all application settings
- **Environment Variable Support**: Automatic loading from environment variables and `.env` files
- **Pydantic Compatibility**: Supports both Pydantic v1 and v2 through a compatibility layer
- **Type Safety**: Provides type hints for all configuration parameters

## Key Components

### Pydantic Compatibility Layer

The module includes a compatibility layer to handle differences between Pydantic versions:

```python
try:
    # Pydantic < 2.0
    from pydantic import BaseSettings
except (ImportError, AttributeError):
    # From Pydantic 2.0 onwards BaseSettings moved to separate package
    from pydantic_settings import BaseSettings
```

### Settings Class

The main `Settings` class inherits from `BaseSettings` and defines all application configuration parameters.

#### Database Configuration
- **`DATABASE_URL`**: Optional database connection string from environment
- **`DATABASE_PATH`**: Local SQLite database file path (defaults to `documents.db` in current directory)

#### File Monitoring
- **`WATCH_FOLDER`**: Directory to monitor for new documents (defaults to `~/Documents/Inbox`)

#### LLM (Large Language Model) Settings
- **`LLM_MODEL`**: Model name for document processing (default: "gwen2.5")
- **`LLM_API_KEY`**: API key for LLM service
- **`LLM_API_URL`**: LLM service endpoint (default: local Ollama instance)

#### Authentication & Security
- **`SECRET_KEY`**: JWT signing key (uses environment variable or default)
- **`ALGORITHM`**: Token signing algorithm (default: "HS256")
- **`ACCESS_TOKEN_EXPIRE_MINUTES`**: Token expiration time (default: 30 minutes)

#### Feature Flags
- **`NOTIFICATION_ENABLED`**: Enable/disable notifications
- **`AUTO_OCR`**: Automatic OCR processing for documents
- **`AUTO_TAGGING`**: Automatic document tagging

#### Additional Settings
- **`DEFAULT_CURRENCY`**: Default currency for financial documents
- **`HOSTFS_ROOT`**: Host filesystem mount point for containerized deployments

## Configuration Options

### Environment File Support

The settings automatically load from a `.env` file with UTF-8 encoding:

```python
class Config:
    env_file = ".env"
    env_file_encoding = "utf-8"
    extra = "ignore"
```

### Example `.env` File

```bash
DATABASE_URL=postgresql://user:pass@localhost/docmgmt
LLM_API_KEY=your_api_key_here
SECRET_KEY=your_secret_key_here
DEFAULT_CURRENCY=EUR
HOSTFS_ROOT=/mnt/host
```

## Usage

```python
from config import settings

# Access configuration values
db_path = settings.DATABASE_PATH
watch_dir = settings.WATCH_FOLDER
api_key = settings.LLM_API_KEY
```

## Important Notes

### Security Considerations
- ⚠️ **Change the default SECRET_KEY** in production environments
- Store sensitive values like API keys in environment variables or secure vaults
- The default secret key should never be used in production

### File Paths
- Default paths use cross-platform compatible methods (`os.path.join`, `os.path.expanduser`)
- Ensure the application has read/write permissions for specified directories

### Container Deployment
- The `HOSTFS_ROOT` setting is specifically designed for containerized deployments
- Map host filesystem paths appropriately when using Docker or similar containers

## Suggestions for Enhancement

1. **Validation**: Add field validators for critical settings (e.g., file path existence)
2. **Logging Configuration**: Consider adding logging-related settings
3. **Cache Settings**: Add configuration for caching mechanisms
4. **Rate Limiting**: Include API rate limiting configuration
5. **Backup Settings**: Add backup schedule and retention policy settings

## Dependencies

- **pydantic** (v1.x) or **pydantic-settings** (v2.x+)
- **python-dotenv** (implicit, for `.env` file support)