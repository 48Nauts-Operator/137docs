<!-- Auto-generated by Claude on 2025-06-01 10:12 -->

# Sample Data Generator for Tenant Automation Testing

## Overview

This Python script generates sample data for testing tenant automation functionality in a document management system. It creates test users, entities (tenants), LLM configurations, and various document scenarios to validate automatic tenant assignment and document processing capabilities.

## Purpose

The script is designed to:
- **Test Tenant Automation**: Create documents with problematic recipient fields that need automatic assignment
- **Validate LLM Integration**: Set up LLM configurations for document processing
- **Simulate Real-world Scenarios**: Generate realistic business documents and entities
- **Support Development Testing**: Provide consistent test data for development and QA

## Key Components

### Database Setup
- Uses **SQLAlchemy** with async SQLite database (`documents.db`)
- Implements **bcrypt** password hashing for user security
- Supports async operations for better performance

### Main Function: `create_sample_data()`

This async function orchestrates the creation of all sample data:

```python
async def create_sample_data():
    """Create sample data for testing tenant automation."""
```

#### Data Creation Process

1. **Admin User Creation**
   - Username: `admin`
   - Password: `admin123` (bcrypt hashed)
   - Role: `admin`
   - Full access permissions

2. **Entity (Tenant) Creation**
   - **Personal Entity**: Individual tenant with Swiss address
   - **Test Company Ltd.**: Business entity with VAT/IBAN details
   - **Google LLC**: External company for testing vendor scenarios

3. **LLM Configuration Setup**
   ```python
   llm_config = LLMConfig(
       provider="local",
       api_url="http://localhost:11434",
       model_tagger="phi3",
       model_enricher="llama3",
       # ... additional settings
   )
   ```

4. **Document Scenarios**
   - **Problematic Recipients**: Documents with empty, null, or generic recipient fields
   - **Proper Assignment**: Control documents with correct tenant assignment
   - **Mixed Document Types**: Invoices, bills, subscriptions

## Sample Data Categories

### üè¢ Entities (Tenants)
| Entity | Type | Purpose |
|--------|------|---------|
| Personal Entity | Individual | Personal document testing |
| Test Company Ltd. | Company | Business document scenarios |
| Google LLC | External | Vendor/supplier testing |

### üìÑ Document Test Cases
| Document | Recipient Issue | Expected Behavior |
|----------|----------------|-------------------|
| Google Cloud Invoice | "Your Company" | Auto-assign to appropriate entity |
| Medical Insurance | Empty string | Auto-assign to Personal Entity |
| Office Rent | NULL value | Auto-assign to Test Company |
| Google Workspace | "Unknown" | Auto-assign based on content |
| Proper Assignment | Correctly set | Validation control |

### ‚öôÔ∏è LLM Configuration
- **Local Provider**: Ollama integration (localhost:11434)
- **Models**: phi3 (tagging), llama3 (enrichment)
- **Auto-processing**: Enabled for tagging and enrichment
- **Confidence Thresholds**: 0.7 (tagging), 0.8 (entity detection)

## Usage

### Running the Script

```bash
python create_sample_data.py
```

### Expected Output

```
üìù Creating Sample Data for Tenant Automation Testing
============================================================
‚úÖ Sample data created successfully!
üìä Created:
  - 1 admin user
  - 3 entities (tenants)
  - 1 LLM configuration (enabled)
  - 5 sample documents
    ‚Ä¢ 4 with problematic recipients
    ‚Ä¢ 1 properly assigned
```

## Important Notes

### ‚ö†Ô∏è Prerequisites
- **Database**: SQLite database will be created automatically
- **Dependencies**: Ensure all required packages are installed:
  ```bash
  pip install sqlalchemy aiosqlite passlib bcrypt
  ```

### üîß Configuration
- **File Paths**: Update `/app` path reference if needed
- **Database Location**: Modify `documents.db` path as required
- **LLM Settings**: Adjust Ollama URL and model names for your setup

### üß™ Testing Scenarios
The script creates specific test cases for:
- **Empty Recipients**: `""` (empty string)
- **Null Recipients**: `None` (database NULL)
- **Generic Recipients**: `"Your Company"`, `"Unknown"`
- **Proper Recipients**: Correctly matched entity names

## Suggestions for Enhancement

1. **Environment Variables**: Use environment variables for sensitive data like passwords
2. **Configuration File**: Extract settings to a separate config file
3. **Data Validation**: Add validation for entity data before insertion
4. **Cleanup Function**: Add a function to clean up test data
5. **Logging**: Implement proper logging instead of print statements

## Dependencies

```python
# Core dependencies
sqlalchemy[asyncio]  # Database ORM with async support
aiosqlite           # Async SQLite driver
passlib[bcrypt]     # Password hashing
```

This script provides a comprehensive foundation for testing tenant automation features and can be extended based on specific testing requirements.